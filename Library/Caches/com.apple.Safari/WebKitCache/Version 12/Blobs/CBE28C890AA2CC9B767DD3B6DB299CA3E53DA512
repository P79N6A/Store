self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[318],{1031:function(n,e,t){"use strict";function r(n){return n&&n.recipients?n.recipients.length:0}t.d(e,"a",function(){return r})},13628:function(n,e,t){"use strict";t.r(e);var r=t(0),i=t(1799),a=t(87),o=t(351),c=t(845),u=t(1),s=t(1077),f=t(234),d=t(966),l=t(16),b=Object(u.action)("closeImmersiveReadingPane",function(n){return{source:n}});Object(u.orchestrator)(b,function(n){if(!Object(f.b)())throw new Error("closeImmersiveReadingPane should only be called with reading pane off");var e=Object(o.a)(),t=Object(s.b)(e.tableQuery);if("messageSuggestion"!==t){if("mail"===t){var u=n.source||"Unknown";Object(l.o)("Search_ReadingPaneClosed",[u])}var b=Object(d.a)();if(Object(a.A)(!0),Object(a.B)(!1),b&&1==e.selectedRowKeys.size){var v=r.__spread(e.selectedRowKeys.keys())[0];c.g.importAndExecute(v,e)}}else Object(i.a)("CommandBar")});var v=b,p=t(9),w=t(12),m=Object(p.action)("onReadingPanePositionOptionSaved")(function(){Object(a.A)(!0),Object(a.B)(!Object(f.b)()),w.O.rowInfoForVLV.clear()}),O=t(353),g=Object(p.action)("onReplyOrReplyAllOrForwardMessage")(function(){var n=Object(O.c)();!Object(f.b)()||n&&n.type!=O.a.Primary||(Object(a.B)(!0),Object(a.A)(!1))}),h=t(518),y=t(283),j=Object(p.action)("mailModuleOrchestrator.onSelectingFolder")(function(){null!==y.a.primaryComposeId?h.A.importAndExecute(null):Object(f.b)()&&v()}),C=Object(p.action)("onSelectMessageAd")(function(){Object(a.B)(!0),Object(a.A)(!Object(f.b)())}),S=t(198),A=t(327);function I(n){if(Object(f.b)())switch(n){case A.c.MailList:v();break;case A.c.ReadingPane:case A.c.ConversationAttachmentWell:}Object(S.a)()}A.E.eventManager.on(A.f.CloseEvent,I);var R=t(1337);Object(u.orchestrator)(R.b,function(n){Object(a.A)(!0),Object(a.B)(!Object(f.b)())});t.d(e,"closeImmersiveReadingPane",function(){return v}),t.d(e,"onReadingPanePositionOptionSaved",function(){return m}),t.d(e,"onReplyOrReplyAllOrForwardMessage",function(){return g}),t.d(e,"onSelectingFolder",function(){return j}),t.d(e,"onSelectMessageAd",function(){return C}),t.d(e,"onSxSPreviewPaneClose",function(){return I})},1458:function(n,e,t){"use strict";t.d(e,"a",function(){return a});var r=t(8),i=t(5);function a(){var n=Object(r.a)(),e=n&&n.SessionSettings&&n.SessionSettings.IsExplicitLogon;return(Object(i.e)("rp-3SPeopleSuggestions")||Object(i.e)("rp-linkedInPeopleSuggestions"))&&!e&&n.SessionSettings.IsSubstrateSearchServiceAvailable}},146:function(n,e,t){"use strict";var r;t.d(e,"a",function(){return r}),function(n){n[n.Primary=0]="Primary",n[n.OverflowMenu=1]="OverflowMenu",n[n.SecondaryReadingPane=2]="SecondaryReadingPane",n[n.Compose=3]="Compose",n[n.FloatingChat=4]="FloatingChat"}(r||(r={}))},1465:function(n,e,t){"use strict";t.d(e,"c",function(){return i}),t.d(e,"a",function(){return a}),t.d(e,"b",function(){return o});var r=t(1031);function i(n){return n.isDirty||n.toRecipientWell&&n.toRecipientWell.isDirty||n.ccRecipientWell&&n.ccRecipientWell.isDirty||n.bccRecipientWell&&n.bccRecipientWell.isDirty}function a(n){return Object(r.a)(n.toRecipientWell)+Object(r.a)(n.ccRecipientWell)+Object(r.a)(n.bccRecipientWell)}function o(n){return function(n){return!!n.groupId}(n)&&(2==(e=n).operation||e.toRecipientWell.recipients.some(function(n){return n.persona.EmailAddress.EmailAddress.toLowerCase()===e.groupId.toLowerCase()}));var e}},1466:function(n,e,t){"use strict";var r=t(3),i=t(0),a=t(1467),o=t(9),c=Object(o.action)("addSessionMaskedRecipient")(function(n){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){return a.a.sessionMaskedRecipients[n]=!0,[2]})})});t.d(e,"b",function(){return s}),t.d(e,"a",function(){return c});var u=new r.c(function(){return t.e(419).then(t.bind(null,13778))}),s=new r.a(u,function(n){return n.execute3SPrimeCall})},1467:function(n,e,t){"use strict";t.d(e,"b",function(){return i});var r=t(1),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),a=i();e.a=a},1469:function(n,e,t){"use strict";t.d(e,"a",function(){return i});var r=t(0);function i(n){var e,t,i=[];if(n&&n.recipients)try{for(var a=r.__values(n.recipients),o=a.next();!o.done;o=a.next()){var c=o.value,u=c.persona.EmailAddress;u&&u.ItemId&&"PrivateDL"==u.MailboxType?i.push({Name:u.Name,RoutingType:u.RoutingType,MailboxType:u.MailboxType,ItemId:{Id:u.ItemId.Id,ChangeKey:null},EmailAddressIndex:u.EmailAddressIndex,RelevanceScore:u.RelevanceScore||0}):i.push(c.persona.EmailAddress)}}catch(n){e={error:n}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return i}},1471:function(n,e,t){"use strict";var r=t(254),i=t.n(r),a=t(9);function o(n){n&&(n.isDirty=!1)}e.a=Object(a.action)("updateComposeItemId")(function(n,e,t,r){n&&(n.itemId?n.itemId.ChangeKey=t:n.itemId=i()({Id:e,ChangeKey:t}),r&&(n.lastSaveTimeStamp=r,n.isDirty=!1,o(n.toRecipientWell),o(n.ccRecipientWell),o(n.bccRecipientWell)))})},1472:function(n,e,t){"use strict";t.d(e,"a",function(){return a});var r=t(0),i=t(1505);function a(n){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,i.c.import()];case 1:return e=t.sent(),n&&e(n.referenceItemId&&n.referenceItemId.Id),[2]}})})}},1473:function(n,e,t){"use strict";var r=t(1),i=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});e.a=i},1480:function(n,e,t){"use strict";t.d(e,"a",function(){return i});var r=t(1),i=Object(r.action)("messageBeingSent")},1481:function(n,e,t){"use strict";t.d(e,"a",function(){return c});var r=t(0),i=t(353),a=t(273),o=t(283);function c(n,e){var t,c,u=Object(o.b)();try{for(var s=r.__values(Object(a.a)().tabs),f=s.next();!f.done;f=s.next()){var d=f.value;if(d.type==i.a.Compose&&!d.isShown){var l=u.viewStates.get(d.data);if(l&&l.isInlineCompose&&l.conversationId==n&&(0==l.asyncSendState||e&&6==l.asyncSendState))return l}}}catch(n){t={error:n}}finally{try{f&&!f.done&&(c=s.return)&&c.call(s)}finally{if(t)throw t.error}}return null}},1482:function(n,e,t){"use strict";var r=t(1);e.a=Object(r.action)("onInlineComposeSendStateChange",function(n,e){return{viewState:n,isSendPending:e}})},1505:function(n,e,t){"use strict";t.d(e,"c",function(){return o}),t.d(e,"b",function(){return c});var r=t(3),i=t(1473);t.d(e,"a",function(){return i.a});var a=new r.c(function(){return t.e(127).then(t.bind(null,2419))}),o=new r.b(a,function(n){return n.getAttachmentSuggestionsAction}),c=new r.b(a,function(n){return n.createCloudFileFromAttachmentData})},1506:function(n,e,t){"use strict";var r=t(582),i=t(9),a=t(273);e.a=Object(i.action)("setTabIsShown")(function(n,e){if(n.isShown!=e&&(n.isShown=e,n.blink=e,n.isActive&&!e)){var t=Object(a.a)(),i=t.tabs.indexOf(n),o=t.tabs.filter(function(e){return e.id==n.parentTabId&&e.isShown})[0]||function(n,e){e<0&&(e=0);for(var t=e;t<n.length;t++)if(n[t].isShown)return n[t];for(t=e-1;t>=0;t--)if(n[t].isShown)return n[t];return null}(t.tabs,i);o&&Object(r.a)(o)}})},1507:function(n,e,t){"use strict";var r=t(0),i=t(582),a=t(976),o=t(728),c=t(146),u=t(25),s=t(273),f=1;e.a=Object(u.b)("addTab",a.a.TabViewAddTab)(function(n,e,t,a){var u=Object(o.a)(),d=Object(s.a)(),l={id:c.a[n]+(f++).toString(),isShown:e,isActive:!1,startTime:(new Date).getTime(),parentTabId:u?u.id:null,blink:e,data:a},b=null;switch(n){case c.a.Primary:b=r.__assign({},l,{type:c.a.Primary});break;case c.a.OverflowMenu:b=r.__assign({},l,{type:c.a.OverflowMenu,data:a});break;case c.a.SecondaryReadingPane:b=r.__assign({},l,{type:c.a.SecondaryReadingPane,data:a});break;case c.a.Compose:b=r.__assign({},l,{type:c.a.Compose,data:a});break;case c.a.FloatingChat:b=r.__assign({},l,{type:c.a.FloatingChat,data:a,isChatActive:!1})}d.tabs.push(b),t&&Object(i.a)(d.tabs[d.tabs.length-1])})},1509:function(n,e,t){"use strict";var r=t(9);e.a=Object(r.action)("toggleChatTab")(function(n){n.isChatActive=!n.isChatActive,n.isActive=n.isChatActive,n.blink=!1})},1574:function(n,e,t){"use strict";t.d(e,"d",function(){return c}),t.d(e,"b",function(){return u}),t.d(e,"e",function(){return s}),t.d(e,"c",function(){return f}),t.d(e,"a",function(){return d});var r=t(3),i=t(22),a=new r.c(function(){return Promise.all([t.e(2),t.e(517),t.e(144)]).then(t.bind(null,2446))}),o=new r.a(a,function(n){return n.loadCLPUserLabels}),c=new r.b(a,function(n){return n.showJustificationModal}),u=new r.a(a,function(n){return n.loadItemCLPInfo}),s=new r.b(a,function(n){return n.updateItemCLPInfo}),f=new r.b(a,function(n){return n.logReadCLPLabel}),d=Object(r.d)(a,function(n){return n.CLPSubjectHeaderLabel});Object(i.d)(function(){o.importAndExecute()})},1577:function(n,e,t){"use strict";t.d(e,"a",function(){return o});var r=t(3),i=t(22),a=new r.c(function(){return t.e(330).then(t.bind(null,2422))}),o=new r.a(a,function(n){return n.loadSignatureInUserOptions});Object(i.d)(function(){o.importAndExecute()})},273:function(n,e,t){"use strict";t.d(e,"a",function(){return o}),t.d(e,"b",function(){return c});var r=t(146),i=t(1),a={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(i.createStore)("tab",a),c=(o(),o().tabs[0])},283:function(n,e,t){"use strict";var r=t(7),i=t(1),a={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,messageClassifications:new r.ObservableMap,newMessageCreationInProgress:!1},o=Object(i.createStore)("compose",a),c=o();t.d(e,"a",function(){return c}),t.d(e,"b",function(){return o})},353:function(n,e,t){"use strict";var r=t(860),i=t(146),a=t(0),o=t(273);function c(n){var e,t,r=Object(o.a)();try{for(var c=a.__values(r.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.type!==i.a.Primary&&s.data==n)return s}}catch(n){e={error:n}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}return null}var u=t(728),s=t(3),f=t(582),d=t(1507),l=t(841),b=t(1);Object(b.mutator)(l.a,function(n){var e,t;try{for(var r=a.__values(Object(o.a)().tabs),c=r.next();!c.done;c=r.next()){var u=c.value;if(u.type==i.a.FloatingChat&&u.data==n.chatConversationId)return void Object(f.a)(u,!0)}}catch(n){e={error:n}}finally{try{c&&!c.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}Object(d.a)(i.a.FloatingChat,!0,!0,n.chatConversationId)});var v=t(87);Object(b.orchestrator)(v.B,function(){Object(f.a)(o.b)}),t.d(e,"e",function(){return w}),t.d(e,"f",function(){return m}),t.d(e,"g",function(){return O}),t.d(e,"h",function(){return g}),t.d(e,"a",function(){return i.a}),t.d(e,"b",function(){return c}),t.d(e,"c",function(){return u.a}),t.d(e,"d",function(){return o.a}),t.d(e,"i",function(){return o.b}),t.d(e,"j",function(){return r.b});var p=new s.c(function(){return Promise.all([t.e(46),t.e(68),t.e(428)]).then(t.bind(null,13392))}),w=new s.a(p,function(n){return n.activateTab}),m=new s.a(p,function(n){return n.addTab}),O=new s.a(p,function(n){return n.closeTab}),g=new s.a(p,function(n){return n.setTabIsShown})},518:function(n,e,t){"use strict";t(1480);var r=t(3),i=(t(1577),t(1574),t(22)),a=t(1466),o=t(1458),c=new r.c(function(){return t.e(377).then(t.bind(null,13669))}),u=new r.a(c,function(n){return n.initializeCache});Object(i.c)(function(){u.importAndExecute(),Object(o.a)()&&a.b.importAndExecute(!0)});var s=t(896),f=t(1465),d=(t(1471),t(1469)),l=t(1481),b=t(1472),v=t(1),p=Object(v.action)("onComposeAddinsInitialized",function(n){return{hostItemIndex:n}}),w=t(1482),m=t(283),O=t(353);function g(){var n=Object(O.c)(),e=Object(m.b)(),t=n?function(n,e){switch(n.type){case O.a.Primary:return e.primaryComposeId;case O.a.Compose:return n.data;default:return null}}(n,e):e.primaryComposeId,r=t?e.viewStates.get(t):null;return r&&!r.isInlineCompose?r:null}t.d(e,"w",function(){return y}),t.d(e,"m",function(){return j}),t.d(e,"g",function(){return C}),t.d(e,"j",function(){return S}),t.d(e,"p",function(){return A}),t.d(e,"s",function(){return I}),t.d(e,"A",function(){return R}),t.d(e,"q",function(){return T}),t.d(e,"u",function(){return P}),t.d(e,"z",function(){return M}),t.d(e,"v",function(){return _}),t.d(e,"t",function(){return x}),t.d(e,"r",function(){return k}),t.d(e,"y",function(){return D}),t.d(e,"i",function(){return F}),t.d(e,"o",function(){return E}),t.d(e,"l",function(){return B}),t.d(e,"x",function(){return L}),t.d(e,"n",function(){return W}),t.d(e,"h",function(){return V}),t.d(e,"k",function(){return H}),t.d(e,"c",function(){return s.c}),t.d(e,"a",function(){return s.b}),t.d(e,"f",function(){return f.c}),t.d(e,"e",function(){return d.a}),t.d(e,"b",function(){return l.a}),t.d(e,"B",function(){return b.a}),t.d(e,"C",function(){return p}),t.d(e,"D",function(){return w.a}),t.d(e,"d",function(){return g});var h=new r.c(function(){return Promise.all([t.e(2),t.e(3),t.e(4),t.e(5),t.e(303)]).then(t.bind(null,13181))}),y=new r.a(h,function(n){return n.replyToMessage}),j=new r.a(h,function(n){return n.forwardMessage}),C=new r.a(h,function(n){return n.closeCompose}),S=new r.a(h,function(n){return n.discardCompose}),A=new r.a(h,function(n){return n.loadDraftToCompose}),I=new r.a(h,function(n){return n.openCompose}),R=new r.a(h,function(n){return n.trySaveAndCloseCompose}),T=new r.a(h,function(n){return n.moveComposeToTab}),P=new r.a(h,function(n){return n.recreateComposeFromViewState}),M=new r.a(h,function(n){return n.tryCreateResendDraft}),_=new r.a(h,function(n){return n.replyToApprovalMessage}),x=new r.a(h,function(n){return n.preloadComposePlugins}),k=new r.a(h,function(n){return n.onEditDraftButtonClicked}),D=new r.a(h,function(n){return n.showSubjectPickerButton}),F=(new r.b(h,function(n){return n.createComposeViewState}),new r.b(h,function(n){return n.createReply})),E=new r.b(h,function(n){return n.getToCcRecipientsForReply}),B=new r.b(h,function(n){return n.findComposePlugins}),L=new r.b(h,function(n){return n.replyToMessageAndCreateViewState}),W=(new r.b(h,function(n){return n.infoBarAddHandler}),new r.b(h,function(n){return n.infoBarRemoveHandler}),new r.b(h,function(n){return n.getNextComposeId})),V=new r.b(h,function(n){return n.createAttachments}),H=new r.b(h,function(n){return n.findComposeFromRecipientWell})},582:function(n,e,t){"use strict";var r=t(146),i=t(976),a=t(728),o=t(1506),c=t(1509),u=t(25),s=t(860);e.a=Object(u.b)("activateTab",i.a.TabViewActivateTab)(function(n,e){switch(Object(o.a)(n,!0),n.type){case r.a.FloatingChat:return void Object(c.a)(n);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!n.isActive){var t,i=Object(a.a)();if(i)i.isActive=!1,(t=Object(s.a)(i.type))&&t.onDeactivate&&t.onDeactivate(i);if(n)n.isActive=!0,n.blink=!1,(t=Object(s.a)(n.type))&&t.onActivate&&t.onActivate(n)}return}})},728:function(n,e,t){"use strict";t.d(e,"a",function(){return c});var r=t(0),i=t(146),a=t(273),o=t(11);function c(){var n,e,t=Object(a.a)();try{for(var c=r.__values(t.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.isActive&&s.type!=i.a.FloatingChat)return s}}catch(e){n={error:e}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(n)throw n.error}}return o.d.error("There is no active tab. Something went very wrong."),null}},841:function(n,e,t){"use strict";var r=t(1),i=Object(r.actionCreator)("ADD_CHAT_TAB",function(n){return{chatConversationId:n}});e.a=i},845:function(n,e,t){"use strict";t.d(e,"a",function(){return a}),t.d(e,"i",function(){return o}),t.d(e,"j",function(){return c}),t.d(e,"d",function(){return u}),t.d(e,"c",function(){return s}),t.d(e,"b",function(){return f}),t.d(e,"h",function(){return d}),t.d(e,"g",function(){return l}),t.d(e,"f",function(){return b}),t.d(e,"e",function(){return v});var r=t(3),i=new r.c(function(){return Promise.all([t.e(11),t.e(37),t.e(48),t.e(324)]).then(t.bind(null,2899))}),a=new r.a(i,function(n){return n.clearAutoMarkAsReadTimer}),o=new r.a(i,function(n){return n.setAutoMarkAsReadTimer}),c=new r.a(i,function(n){return n.toggleRowReadState}),u=new r.b(i,function(n){return n.markItemsAsReadBasedOnNodeIds}),s=new r.a(i,function(n){return n.markItemAsReadFromReadingPane}),f=new r.a(i,function(n){return n.markAsReadInTable}),d=new r.a(i,function(n){return n.onSingleSelectionChanged}),l=new r.a(i,function(n){return n.onReadingPaneClosed}),b=new r.a(i,function(n){return n.onNavigateAwayViaUpDown}),v=new r.a(i,function(n){return n.onItemPartDeselected})},860:function(n,e,t){"use strict";t.d(e,"b",function(){return a}),t.d(e,"a",function(){return o});var r=t(146),i={};function a(n,e){i[r.a[n]]=e}function o(n){return i[r.a[n]]}},896:function(n,e,t){"use strict";t.d(e,"c",function(){return c}),t.d(e,"a",function(){return i}),t.d(e,"b",function(){return a});var r=t(8),i="HTML",a="Text",o="Html";function c(){return Object(r.a)().UserOptions.ComposeMarkup==o?"HTML":"Text"}},976:function(n,e,t){"use strict";e.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(n,e,t,r){return[n,e,t]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(n,e){return[n.type,n.isShown,n.isActive,e,n.startTime?(new Date).getTime()-n.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(n,e){return[n.type,e]},options:{isVerbose:!0}}}}},0,[2,32,38,83,343,3,4,5,303,11,37,48,324,0,1,522,181,12,43,124,517,144,508,108,29,119,521,177,332,311,330,419]]);
//# sourceMappingURL=owa.MailModuleOrchestrator.js.map
self.scriptsLoaded['owa.MailModuleOrchestrator.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();