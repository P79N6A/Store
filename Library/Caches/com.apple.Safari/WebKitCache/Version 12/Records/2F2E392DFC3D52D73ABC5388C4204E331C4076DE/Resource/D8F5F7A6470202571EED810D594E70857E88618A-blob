self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[324],{10174:function(e){e.exports={a:"vDb",b:"wDb"}},10175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadRequest:#Exchange"},e)}},10176:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(10177);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("MarkAllItemsAsRead",e,t)}},10177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadJsonRequest:#Exchange"},e)}},1065:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(2140);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetFolder",e,t)}},1066:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetFolderRequest:#Exchange"},e)}},1071:function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c});var r=n(498);function i(e){return e&&0===e.indexOf(r.f)}function a(e){return e&&0===e.indexOf(r.e)&&!i(e)}function o(e){return e&&0===e.indexOf(r.e)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1238:function(e,t,n){"use strict";var r=n(9),i=n(80);t.a=Object(r.action)("removeAttachmentPreviewsForRow")(function(e){var t=i.a.rowAttachmentPreviewWellViews,n=t.get(e);if(n){var r=i.a.attachmentViewStates;n.imageViewStateIds.forEach(function(e){r.delete(e)}),n.documentViewStateIds.forEach(function(e){r.delete(e)}),t.delete(e)}})},1241:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1238);var a=n(16),o=n(246),c=n(707),u=n(80),s=n(35),d=n(9),f=n(7);var l=Object(d.action)("createAndStoreAttachmentViewState")(function(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var s,d,l,m=this;return r.__generator(this,function(v){switch(v.label){case 0:return s=function(e,t){return e+"_"+t}(e,n.AttachmentId.Id),d=u.a.attachmentViewStates.get(s),l=f.observable.object(r.__assign({},n.AttachmentId,{mailboxInfo:a})),[4,c.d.import().then(function(e){return r.__awaiter(m,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return d=d||e(l,n,!0,!0,!1,t),[4,o.i.import()];case 1:return n=r.sent()(l).model,u.a.attachmentViewStates.set(s,d),[4,o.o.import()];case 2:return r.sent()(n)?i.imageViewStateIds.push(s):i.documentViewStateIds.push(s),[2]}})})})];case 1:return v.sent(),[2]}})})});var m=Object(d.select)({listView:function(){return u.a}})(Object(d.action)("processAttachmentsForConversation")(function(e,t,n){var r=n.listView.conversationItems.get(e.ConversationId.Id);if(r)if(e.AttachmentPreviews){var o=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=i.Attachment,o=-1;if(a.IsInline)for(var c=0;c<t.length;c++){var u=t[c];if(u.Attachment.IsInline&&u.Attachment.Name==a.Name&&u.ParentItemId.Id!=i.ParentItemId.Id){o=c;break}}-1==o&&t.push(i)}return t}(e.AttachmentPreviews.Previews);b(e.ConversationId.Id,o,t);var c=e.AttachmentPreviews.Previews.length-o.length;c>0&&Object(a.p)("IP_II_DP",[c])}else r.shouldShowAttachmentPreviews=!1,Object(i.a)(e.ConversationId.Id),Object(a.p)("IP_FP")})),v=Object(d.action)("processAttachmentPreviewsForItems")(function(e,t,n){var a=e.filter(function(e){return e.AttachmentPreviews}),o=[];a.forEach(function(e){o.push.apply(o,r.__spread(e.AttachmentPreviews.Previews))});var c={};o.forEach(function(e){var n=e.ParentItemId.Id;t.indexOf(n)>-1&&(c[n]||(c[n]=[]),c[n].push(e))}),t.forEach(function(e){var t=s.H.items.get(e);t?c[e]?b(e,c[e],n):(t.shouldShowAttachmentPreviews=!1,Object(i.a)(e)):delete c[e]})}),b=Object(d.action)("processAttachmentsForRow")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,a=this;return r.__generator(this,function(o){switch(o.label){case 0:return i={documentViewStateIds:[],imageViewStateIds:[]},[4,Promise.all(t.map(function(t){return r.__awaiter(a,void 0,void 0,function(){return r.__generator(this,function(a){switch(a.label){case 0:return[4,l(e,r.__assign({},t.ParentItemId,{mailboxInfo:n}),t.Attachment,i,n)];case 1:return a.sent(),[2]}})})}))];case 1:return o.sent(),u.a.rowAttachmentPreviewWellViews.set(e,i),[2]}})})}),p=n(1823),O=n.n(p),h=n(1586),I=n.n(h);function j(e,t,n){var i=I()(r.__assign({},n,{ConversationIds:e}));return O()(i,t).then(function(e){return e})}var _=n(12),g=n(40);n.d(t,"add",function(){return y}),n.d(t,"getPreviews",function(){return A}),n.d(t,"getAttachmentsForConversationWell",function(){return P});var w=new Map,y=Object(d.select)({rowIdsToGetPreviewsMap:function(){return w}})(Object(d.action)("AttachmentPreviewsOperations.add")(function(e,t,n,r){var i=r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId];i||(i={conversationsIdsArray:[],itemIdsArray:[]},r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]=i),-1==i.conversationsIdsArray.indexOf(t)&&i.conversationsIdsArray.push(t),-1==i.itemIdsArray.indexOf(n)&&i.itemIdsArray.push(n)})),A=Object(d.select)({rowIdsToGetPreviewsMap:function(){return w}})(Object(d.action)("AttachmentPreviewsOperations.getPreviews")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,a,o,c,u;return r.__generator(this,function(r){switch(r.label){case 0:if(!(i=n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]))return[2];a=i.conversationsIdsArray,o=i.itemIdsArray,c=Object(g.a)(),delete n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,j(a,e&&e.requestOptions,{IncludeInlineAttachments:c})];case 2:return void 0!==(u=r.sent()).Conversations?1==t?v(u.Conversations,o,e):function(e,t){e.forEach(function(e){m(e,t)})}(u.Conversations,e):R(t,o,a),[3,4];case 3:return r.sent(),R(t,o,a),[3,4];case 4:return[2]}})})}));function R(e,t,n){1==e?t.forEach(function(e){var t=s.H.items.get(e);t&&(_.O.rowAttachmentPreviewWellViews.get(e)||(t.shouldShowAttachmentPreviews=!1))}):n.forEach(function(e){var t=e.Id,n=_.O.conversationItems.get(t);n&&(_.O.rowAttachmentPreviewWellViews.get(t)||(n.shouldShowAttachmentPreviews=!1))})}var P=Object(d.action)("AttachmentPreviewsOperations.getAttachmentsForConversationWell")(function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i,a,o;return r.__generator(this,function(c){switch(c.label){case 0:t=[e],n=[],i={},a={},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,j(t,e.mailboxInfo&&e.mailboxInfo.requestOptions,{FullPreviewsPerConversation:300,PreviewsPerConversation:300,MinimumAttachmentSize:0,IncludeInlineAttachments:!1})];case 2:return void 0!==(o=c.sent()).Conversations&&o.Conversations.forEach(function(t){t.ConversationId.Id==e.Id&&t.AttachmentPreviews&&t.AttachmentPreviews.Previews&&t.AttachmentPreviews.Previews.forEach(function(t){n.push(t.Attachment),i[t.Attachment.AttachmentId.Id]=r.__assign({},t.ParentItemId,{mailboxInfo:e.mailboxInfo}),a[t.Attachment.AttachmentId.Id]=t.ItemReceivedTime})}),[3,4];case 3:return c.sent(),[3,4];case 4:return[2,[n,i,a]]}})})})},1399:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(21);function i(e){return Object(r.K)(e,r.k)}},1586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentPreviewsRequest:#Exchange"},e)}},1757:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemChange:#Exchange"},e)}},1759:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetItemField:#Exchange"},e)}},1760:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",function(){return r})},1764:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",function(){return r})},1766:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(9),i="deleteMeetingMessage";t.b=Object(r.action)(i)(function(e,t){})},1767:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",function(){return r})},1769:function(e,t,n){"use strict";function r(e){return e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",function(){return r})},1823:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(1586);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAttachmentPreviews",e,t)}},2140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetFolderJsonRequest:#Exchange"},e)}},2168:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},2355:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"Message:#Exchange"},e)}},2366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(2801);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("UpdateItem",e,t)}},2370:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemRequest:#Exchange"},e)}},2441:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(2865);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("ApplyConversationAction",e,t)}},2442:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionRequest:#Exchange"},e)}},2443:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationAction:#Exchange"},e)}},2801:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemJsonRequest:#Exchange"},e)}},2865:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionJsonRequest:#Exchange"},e)}},2899:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(12),a={markConversationAsRead:{name:function(e,t,n,r,i,a,o){var c="TnS_MarkConversation";return c+=n?"Read":"Unread",r||(c+="Background"),c},options:function(e,t,n,r,i,a,o){return r?{isCore:!0}:{}},customData:function(e,t,n,r,a,o,c){return[a,e.length,Object(i.m)(t),Object(i.I)(t)]},cosmosOnlyData:function(e,t,n,a,o,c,u){var s,d,f=[],l=Object(i.B)(e,t);try{for(var m=r.__values(l),v=m.next();!v.done;v=m.next()){var b=v.value;f.push(i.b.getItemIds(b,t))}}catch(e){s={error:e}}finally{try{v&&!v.done&&(d=m.return)&&d.call(m)}finally{if(s)throw s.error}}return JSON.stringify({itemIds:f,conversationIds:e})}},markItemReadUnread:{name:function(e,t,n,r,i,a){var o="TnS_MarkItem";return o+=n?"Read":"Unread",r||(o+="Background"),o},options:function(e,t,n,r,i,a){return r?{isCore:!0}:{}},customData:function(e,t,n,r,a,o){var c=e?e.tableQuery.type:null,u=e?Object(i.m)(e):null,s=e?Object(i.I)(e):null;return[c,t.length,u,s]},cosmosOnlyData:function(e,t,n,r,i,a){return JSON.stringify({itemIds:t})},actionSource:function(e,t,n,r,i){return i}}},o=n(157);var c=n(9),u=n(1),s=Object(u.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),d=Object(c.action)("AddMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return t.store.suppressedItemIdsMap[e]=!0})})),f=Object(c.action)("RemoveMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return delete t.store.suppressedItemIdsMap[e]})})),l=Object(c.action)("ClearMarkReadSuppressedMap")(Object(c.select)({store:function(){return s}})(function(e){e.store.suppressedItemIdsMap={}}));function m(e){for(var t=0;t<e.length;t++)if(!s.suppressedItemIdsMap[e[t]])return!1;return!0}var v=n(3824),b=n(8),p=n(1757),O=n.n(p),h=n(254),I=n.n(h),j=n(2366),_=n.n(j),g=n(2370),w=n.n(g),y=n(27);function A(e,t,n){var r=function(e,t){var n="AlwaysSend"!=Object(b.a)().UserOptions.ReadReceipt,r=Object(v.a)("IsRead",t),i=[];return e.forEach(function(e){return i.push(O()({Updates:[r],ItemId:I()({Id:e})}))}),w()({ItemChanges:i,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:n})}(e,t);return _()({Header:Object(y.getJsonRequestHeader)(),Body:r},n).then(function(e){var t=e.Body.ResponseMessages.Items[0],n=t.ResponseClass;if(void 0!==n&&"Success"!=n){var r=new Error("ResponseCode="+t.ResponseCode+", Stacktrace="+t.StackTrace);return r.fetchErrorType="ServerFailure",Promise.reject(r)}return Promise.resolve()}).catch(function(e){return Promise.reject(e)})}var R=n(5055),P=n(126),S=n(1176),M=n(232),k=n(11),C=n(25),E=Object(C.b)("markItemsAsReadBasedOnItemIds",a.markItemReadUnread)(function(e,t,n,a,c,u){return r.__awaiter(this,void 0,void 0,function(){var s,l,m;return r.__generator(this,function(r){return 0==(s=function(e,t){var n=[];return e.forEach(function(e){var r=o.a.items.get(e);Object(i.M)(r)&&r.IsRead!=t&&n.push(e)}),n}(t,n)).length?[2,Promise.resolve()]:(n?f(s):a?d(s):k.d.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(S.a)(s,n,a,l),R.a.import().then(function(t){t(e?e.tableQuery:null,!1,n,c,s)}),n?a?Object(P.o)("MarkAsRead",u):Object(P.o)("MarkAsReadImplicit",u):Object(P.o)("MarkAsUnread",u),m=Object(M.b)(e).requestOptions,[2,A(s,n,m)])})})}),T=Object(c.action)("autoMarkItemAsRead")(function(e,t){Object(i.f)(t)&&(m([e])||(E(t,[e],!0,!1,null,[]),l()))}),x=Object(c.action)("onItemPartDeselected")(function(e,t){t&&"OnSelectionChange"==Object(b.a)().UserOptions.PreviewMarkAsRead&&T(e,t)}),D=n(4609),F=n(4448),U=n(2442),q=n.n(U),V=n(2443),B=n.n(V),N=n(2441),Q=n.n(N),G=n(1330);function H(e,t,n){var r=Object(F.a)(n),i=e.map(function(e){return function(e,t,n){return B()({Action:"SetReadState",ConversationId:I()({Id:e.conversationId}),IsRead:t,ConversationLastSyncTime:Object(D.a)(e.conversationLastSyncTimeStamp),SuppressReadReceipts:!0,ContextFolderId:n})}(e,t,r)});return q()({ConversationActions:i,ReturnMovedItemIds:!1})}var L=n(1175),J=n(1477),W=n(3778);var z=Object(C.b)("markConversationsAsReadBasedOnConversationIds",a.markConversationAsRead)(function(e,t,n,a,o,c,u){var s=function(e,t,n){var r=[];return e.forEach(function(e){var a=Object(i.F)(e,t);a&&a.unreadCount>0===n&&r.push(e)}),r}(u,t.id,n);if(0==s.length)return Promise.resolve();if(1==e.length&&1==t.selectedRowKeys.size){var f=i.b.getRowIdString(s[0],t),m=Object(i.F)(r.__spread(t.selectedRowKeys.keys())[0],t.id);if(f==m.id){var v=m.itemIds;n?l():a?d(v):k.d.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(L.a)(e,t.id,n,a),R.a.import().then(function(r){r(t.tableQuery,!1,n,o,e)}),n?a?Object(P.o)("MarkAsRead",c):Object(P.o)("MarkAsReadImplicit",c):Object(P.o)("MarkAsUnread",c);var b=Object(M.b)(t).requestOptions;return Object(i.e)(t)?function(e,t,n,a){var o=[];return t.forEach(function(t){o.push.apply(o,r.__spread(i.b.getItemIds(t,e)))}),A(o,n,a)}(t,s,n,b):function(e,t,n,r,a){var o=Object(J.a)(e),c=function(e,t,n,r){var i=H(e,t,n);return Q()({Header:Object(G.getJsonRequestHeader)(),Body:i},r).then(function(e){return e.Body.ResponseMessages.Items[0]})}(t.map(function(t){return Object(i.h)(t,e.id)}),n,o,a),u=Object(i.Q)(e,n,r);return Object(W.d)(c,t,o,e,u)}(t,s,n,a,b)});var K=n(292),$=Object(c.action)("autoMarkConversationAsRead")(Object(c.select)({items:function(){return o.a.items}})(function(e,t,n){var r=Object(i.B)([e],t),a=Object(K.a)(r[0],t.id);if(a&&Object(i.f)(t)){var o=a.itemIds;m(o)||(0==Object.keys(s.suppressedItemIdsMap).length?z([e],t,!0,!1,null,[],r):o.forEach(function(e){!m([e])&&n.items.get(e)&&E(t,[e],!0,!1,null,[])}),l())}}));function X(e,t){var n=i.b.getRowIdString(e,t);switch(t.tableQuery.listViewType){case 0:$(n,t);break;case 1:T(n,t)}}var Y=n(87),Z=Object(c.action)("onReadingPaneClosed")(function(e,t){Object(Y.s)()&&!Object(Y.E)()&&Object(Y.D)()||k.d.error("onReadingPaneClosed should only be called when reading pane is closed in single line view."),"OnSelectionChange"==Object(b.a)().UserOptions.PreviewMarkAsRead&&X(e,t)}),ee=Object(c.action)("onSingleSelectionChanged")(function(e,t,n){var r=Object(b.a)().UserOptions;Object(Y.s)()||"OnSelectionChange"==r.PreviewMarkAsRead&&n&&X(e,t)}),te=Object(u.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",function(e,t,n,r,i){return{nodeIds:e,tableViewId:t,isReadValueToSet:n,isExplicit:r,actionSource:i}}),ne=Object(c.action)("markItemAsReadFromReadingPane")(function(e,t,n,r,a){var c=[],u=null;if(t){if(1==t.tableQuery.listViewType)c=Object(i.B)([e],t);else{var s=o.a.items.get(e).ConversationId.Id;c=Object(i.B)([s],t)}u=Object(i.k)(t)}E(t,[e],n,!0,a,r).then(function(){t&&Object(W.b)(c,u)}).catch(function(e){t&&(Object(W.b)(c,u),Object(W.c)(t))})}),re=n(1068),ie=Object(c.action)("markConversationsAsReadFromTable")(function(e,t,n,r){var a=Object(i.z)(e,t.id),o=Object(re.a)(e,t);return z(a,t,n,!0,r,o,e)}),ae=Object(c.action)("markItemsReadFromTable")(function(e,t,n,r,a){var o=Object(i.z)(e,t.id),c=Object(re.a)(e,t),u=E(t,o,n,r,a,c),s=Object(i.k)(t),d=Object(i.Q)(t,n,r);u.then(function(t){Object(W.b)(e,s,d)}).catch(function(n){Object(W.b)(e,s,d),Object(W.c)(t)})}),oe=n(1255),ce=Object(c.action)("toggleRowReadState")(function(e,t,n){var r=i.O.tableViews.get(t),a=i.b.getUnreadCount(e,r)>0;switch(r.tableQuery.listViewType){case 0:ie([e],r,a,n);break;case 1:ae([e],r,a,!0,n)}Object(oe.b)()}),ue=Object(c.action)("onNavigateAwayViaUpDown")(function(e,t){"OnSelectionChange"==Object(b.a)().UserOptions.PreviewMarkAsRead&&X(e,t)}),se=n(10174),de=n(1640),fe=n(1593),le=n(3473),me=n(4),ve=n(274),be=n(245),pe=n(10175),Oe=n.n(pe),he=n(10176),Ie=n.n(he);var je=n(6344),_e=n(115),ge=n(21),we=n(697),ye=n(1399),Ae=n(16),Re=n(6),Pe=Object(c.action)("markAsReadInTable")(function(e,t,n,a,o,c){var u=this;if(o.length&&n)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(t.length&&!n)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var s=c.tableQuery.folderId,d=ge.o.folderTable.get(s),f=n&&d&&d.UnreadCount>=je.b||Object(i.r)(c)&&o.length>=je.b,l=Object(i.p)(Object(i.m)(c),Object(i.q)(c.id),c.tableQuery.type,d&&d.DisplayName),m=a?Object(me.a)(de.a):Object(me.a)(fe.a),v=a?Object(me.b)(Object(me.a)(se.a),l):Object(me.b)(Object(me.a)(se.b),l);Object(be.b)(m,v,!f,{delayCallbackAfterAnimation:!0,okText:Object(me.a)(le.a)}).then(function(d){return r.__awaiter(u,void 0,void 0,function(){var u,f,l;return r.__generator(this,function(r){if(d===be.a.ok)if(we.b(),n)u=Object(b.a)().UserOptions.ReadReceipt,f="DoNotAutomaticallySend"==u||"NeverSend"==u||Object(ye.a)(s),l=Object(i.L)(s)?Object(Re.m)(i.O.inboxPausedDateTime):null,function(e,t,n){var r="TnS_MarkAllAs";r+=t?"Read":"Unread",Object(Ae.o)(r,[e,Object(i.m)(n)])}(e,a,c),R.a.import().then(function(t){t(c.tableQuery,!0,a,e)}),Object(_e.raiseAction)(ve.e.MarkAllAsReadStoreUpdate)(c,a,t),function(e,t,n,r,i,a){var o=null!=n?n.map(function(e){return I()({Id:e})}):void 0;Ie()({Header:Object(y.getJsonRequestHeader)(),Body:Oe()({ReadFlag:t,SuppressReadReceipts:r,FromFilter:null,FolderIds:[e],ItemIdsToExclude:o,ClientLastSyncTime:a&&a.toISOString()})},i).then(function(e){return e.Body.ResponseMessages.Items[0]})}(Object(i.j)(c),a,t,f,Object(M.b)(c).requestOptions,l);else switch(c.tableQuery.listViewType){case 0:ie(o,c,a,e);break;case 1:ae(o,c,a,!0,e)}return[2]})})})});var Se=n(351),Me=Object(c.action)("setAutoMarkAsReadTimer")(Object(c.select)({markAsReadDelaytime:function(){return Object(b.a)().UserOptions.MarkAsReadDelaytime},store:function(){return s},userOptions:function(){return Object(b.a)().UserOptions}})(function(e,t,n){var r=Object(Se.a)();if(r&&Object(i.f)(r)){var a=n.markAsReadDelaytime,o=n.store;"Delayed"==n.userOptions.PreviewMarkAsRead&&(o.markAsReadTimerTask=setTimeout(function(){Ce(e,r,t)},1e3*a))}})),ke=Object(c.action)("clearAutoMarkAsReadTimer")(Object(c.select)({store:function(){return s}})(function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)})),Ce=Object(c.action)("setMarkAsReadTimer:timeout")(function(e,t,n){if(ke(),n)T(e,t);else switch(t.tableQuery.listViewType){case 0:$(e,t);break;case 1:T(e,t)}}),Ee=n(5404),Te=(Object(u.orchestrator)(te,function(e){var t=Object(Ee.a)(e.nodeIds),n=i.O.tableViews.get(e.tableViewId);E(n,t,e.isReadValueToSet,e.isExplicit,e.actionSource,null)}),n(268)),xe=n(3670),De=n(845);Object(u.orchestrator)(Te.q,function(e){var t=Object(xe.b)(e.nodeIdToSelect);t&&(De.a.importAndExecute(),De.i.importAndExecute(t.ItemId.Id,!0))}),n.d(t,"onItemPartDeselected",function(){return x}),n.d(t,"onReadingPaneClosed",function(){return Z}),n.d(t,"onSingleSelectionChanged",function(){return ee}),n.d(t,"markItemsAsReadBasedOnNodeIds",function(){return te}),n.d(t,"markItemAsReadFromReadingPane",function(){return ne}),n.d(t,"toggleRowReadState",function(){return ce}),n.d(t,"onNavigateAwayViaUpDown",function(){return ue}),n.d(t,"markAsReadInTable",function(){return Pe}),n.d(t,"clearAutoMarkAsReadTimer",function(){return ke}),n.d(t,"setAutoMarkAsReadTimer",function(){return Me})},3473:function(e){e.exports={a:"PEa"}},3670:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f});var r=n(0),i=n(157),a=n(1474),o=n(186),c=n(8),u=n(344);function s(e){var t,n,c=e&&e.itemIds?e.itemIds.length:0;if(0==c)return[null,!1,!1];var s=null,d=2==Object(o.c)().type||!Object(o.b)();if(1==c){if(!(s=i.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||s.ParentFolderId&&s.ParentFolderId.Id==Object(o.b)()}else{var f=null;try{for(var l=r.__values(e.itemIds),m=l.next();!m.done;m=l.next()){var v=m.value,b=i.a.items.get(v);if(!b)return[null,!1,!1];if(b.ParentFolderId&&b.ParentFolderId.Id==Object(o.b)()){s=b,d=!0;break}Object(u.a)(b.ParentFolderId.Id,"sentitems")&&(f=b)}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}s||(s=f||i.a.items.get(e.itemIds[0]))}return[s,d,Object(a.a)(s.ParentFolderId.Id)]}function d(e,t,n){var r=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&t&&!n)}function f(e){var t=i.a.conversationNodes.get(e),n=r.__read(s(t),3),a=n[0],o=n[1];return d(a,n[2],o)?a:null}},3778:function(e,t,n){"use strict";var r=n(5070),i=n(0),a=n(4232),o=n(4233);function c(e,t,n,r,c){return e.then(function(e){if(Object(a.a)(t,n,c),e.ResponseMessages){var u=function(e,t){var n,r;try{for(var a=i.__values(e),c=a.next();!c.done;c=a.next()){var u=c.value;if(u&&"Success"!=u.ResponseClass){Object(o.a)(t);var s=new Error("ResponseCode="+u.ResponseCode+", Stacktrace="+u.StackTrace);return s.fetchErrorType="ServerFailure",s}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return u?Promise.reject(u):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))}).catch(function(e){return Object(a.a)(t,n,c),Object(o.a)(r),Promise.reject(e)})}var u=n(4449);n.d(t,"d",function(){return r.a}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return u.a}),n.d(t,"b",function(){return a.a}),n.d(t,"c",function(){return o.a})},3824:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2355),i=n.n(r),a=n(69),o=n.n(a),c=n(1759),u=n.n(c);function s(e,t){var n;return u()({Path:o()({FieldURI:e}),Item:i()((n={},n[e]=t,n))})}},4232:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(306);function i(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}},4233:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1396);function i(e){e&&Object(r.a)(e)}},4448:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(114),i=n.n(r),a=n(291),o=n.n(a);function c(e){return e?o()({BaseFolderId:i()({Id:e})}):null}},4449:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(35);function a(e){var t,n;if(!e)return Promise.reject(o("500","Server returned a null response!"));var a=Array.isArray(e)?e:[e];try{for(var c=r.__values(a),u=c.next();!u.done;u=c.next()){var s=u.value;if(s&&!Object(i.f)(s))return Promise.reject(o(s.ResponseCode,s.StackTrace))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve()}function o(e,t){var n=new Error("ResponseCode="+e+", Stacktrace="+t);return n.fetchErrorType="ServerFailure",n}},4609:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",function(){return r})},498:function(e,t,n){"use strict";n.d(t,"j",function(){return r}),n.d(t,"l",function(){return i}),n.d(t,"w",function(){return a}),n.d(t,"u",function(){return o}),n.d(t,"a",function(){return c}),n.d(t,"q",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"m",function(){return p}),n.d(t,"d",function(){return O}),n.d(t,"k",function(){return h}),n.d(t,"t",function(){return I}),n.d(t,"o",function(){return j}),n.d(t,"v",function(){return _}),n.d(t,"p",function(){return g}),n.d(t,"r",function(){return w}),n.d(t,"s",function(){return y}),n.d(t,"n",function(){return A});var r="multipart/signed",i="application/pkcs7-mime",a="application/x-pkcs7-mime",o=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",f=57,l=16,m=11,v="IPM.Note.SMIME.MultipartSigned",b="IPM.Note.SMIME",p="smime-",O="image",h="OwaToSmime",I="SmimeToOwa",j="en-US",_=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],g="https://ow2.res.office365.com/owasmime/20.19.701.1/owasmime.msi",w="OwaSmimeEdgeExtension.appxbundle",y="https://ow2.res.office365.com/owasmime/20.19.701.1/OwaSmimeEdgeExtension.appxbundle",A="https://ow2.res.office365.com/owasmime/20.19.701.1/SmimeOutlookWebChrome.msi"},5055:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return c});var r=n(3),i=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(267)]).then(n.bind(null,8157))}),a=new r.b(i,function(e){return e.addMarkAsReadDiagnostics}),o=new r.b(i,function(e){return e.addUnreadCountNotificationDiagnostics}),c=new r.b(i,function(e){return e.addUnreadCountSubscriptionDiagnostics})},5070:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(4232),i=n(4233),a=n(4449);function o(e,t,n,o,c){return e.then(function(e){return Object(r.a)(t,n,c),Object(a.a)(e)}).catch(function(e){return Object(r.a)(t,n,c),Object(i.a)(o),Promise.reject(e)})}},5404:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(3670);function a(e){var t,n,a=[];try{for(var o=r.__values(e),c=o.next();!c.done;c=o.next()){var u=c.value,s=Object(i.b)(u);s&&a.push(s.ItemId.Id)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}},6344:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var r=1e4,i=25},732:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1071);function i(e){return e&&Object(r.b)(e.ItemClass)}},909:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SortResults:#Exchange"},e)}},923:function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"i",function(){return f}),n.d(t,"e",function(){return l}),n.d(t,"d",function(){return m}),n.d(t,"h",function(){return v}),n.d(t,"g",function(){return b}),n.d(t,"l",function(){return p}),n.d(t,"m",function(){return O}),n.d(t,"f",function(){return h}),n.d(t,"k",function(){return I}),n.d(t,"c",function(){return j}),n.d(t,"j",function(){return _}),n.d(t,"n",function(){return g}),n.d(t,"o",function(){return w}),n.d(t,"a",function(){return y});var r=n(3),i=n(1766);n.d(t,"b",function(){return i.a});var a=n(1769);n.d(t,"q",function(){return a.a});var o=n(1760);n.d(t,"r",function(){return o.a});var c=n(1767);n.d(t,"s",function(){return c.a});var u=n(1764);n.d(t,"p",function(){return u.a});var s=new r.c(function(){return Promise.all([n.e(5),n.e(8),n.e(17),n.e(32),n.e(327)]).then(n.bind(null,2863))}),d=new r.a(s,function(e){return e.initializeMeetingRequestViewStateAction}),f=Object(r.d)(s,function(e){return e.MeetingMessageInfo}),l=(Object(r.d)(s,function(e){return e.MeetingRequestActions}),Object(r.d)(s,function(e){return e.MeetingCancellationInfo})),m=Object(r.d)(s,function(e){return e.MeetingActionButton}),v=Object(r.d)(s,function(e){return e.MeetingDetailsTime}),b=Object(r.d)(s,function(e){return e.MeetingDetailsLocation}),p=Object(r.d)(s,function(e){return e.MeetingRequestInfo}),O=Object(r.d)(s,function(e){return e.MeetingRequestResponseEditor}),h=Object(r.d)(s,function(e){return e.MeetingDetails}),I=Object(r.d)(s,function(e){return e.MeetingRequestConflicts}),j=Object(r.d)(s,function(e){return e.EditEventLink}),_=Object(r.d)(s,function(e){return e.MeetingMessageSummary}),g=Object(r.d)(s,function(e){return e.PreviewSummary}),w=Object(r.d)(s,function(e){return e.SenderSummary}),y=Object(r.d)(s,function(e){return e.CollapsedMeetingResponse})}},0,[2,32,38,83,343,6,7,9,10,128,5,8,17,327,0,1,522,181,12,43,124,508,108,29,119,521,177,224,311,489]]);
//# sourceMappingURL=owa.MarkRead.js.map
self.scriptsLoaded['owa.MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MarkRead.js'] = (new Date()).getTime();