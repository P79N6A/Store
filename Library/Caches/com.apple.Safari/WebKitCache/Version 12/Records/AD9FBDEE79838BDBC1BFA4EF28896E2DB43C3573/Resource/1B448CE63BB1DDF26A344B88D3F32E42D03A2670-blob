mw.loader.implement("ext.tmh.OgvJsSupport@04zk68g",function($,jQuery,require,module){!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([
function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";var o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"OGVCompat",{enumerable:!0,get:function(){return u.default}}),t.OGVVersion=void 0;var r=o(n(2)),u=o(n(3));t.OGVVersion="1.6.1-20190618150123-e65cc4a","object"===("undefined"==typeof window?"undefined":(0,r.default)(window))&&(window.OGVCompat=u.default,window.OGVVersion="1.6.1-20190618150123-e65cc4a")},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=o=function(e){return n(e)}:e.exports=o=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},o(t)}e.exports=o},function(e,t
,n){"use strict";var o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(4)),u=o(n(5)),i=o(n(6)),f=new(function(){function e(){(0,r.default)(this,e),this.benchmark=new i.default}return(0,u.default)(e,[{key:"hasTypedArrays",value:function(){return!!window.Uint32Array}},{key:"hasWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"hasFlash",value:function(){if(-1!==navigator.userAgent.indexOf("Trident"))try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!0}catch(e){return!1}return!1}},{key:"hasAudio",value:function(){return this.hasWebAudio()||this.hasFlash()}},{key:"isBlacklisted",value:function(e){var t=!1;return[/\(i.* OS [6789]_.* like Mac OS X\).* Mobile\/.* Safari\//,/\(Macintosh.* Version\/6\..* Safari\/\d/].forEach(function(n){e.match(n)&&(t=!0)}),t}},{key:"isSlow",value:function(){return this.benchmark.slow}},{key:"isTooSlow",value:function(){return this.benchmark.tooSlow}},{key:"supported",value:
function(e){return"OGVDecoder"===e?this.hasTypedArrays()&&!this.isBlacklisted(navigator.userAgent):"OGVPlayer"===e&&(this.supported("OGVDecoder")&&this.hasAudio()&&!this.isTooSlow())}}]),e}());t.default=f},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}},function(e,t,n){"use strict";e.exports=function(){var e,t=this;e=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};var n=null;Object.defineProperty(t,"speed",{get:function(){return null===n&&function(){var t=0,o=e();!function e(n){return t++,n<2?n:e(n-2)+e(n-1)}(30);var r=e()-o;n=t/r}(),n}}),Object.defineProperty(t,"slowCutoff",{get:function(){return 5e4}}),
Object.defineProperty(t,"tooSlowCutoff",{get:function(){return 0}}),Object.defineProperty(t,"slow",{get:function(){return t.speed<t.slowCutoff}}),Object.defineProperty(t,"tooSlow",{get:function(){return t.speed<t.tooSlowCutoff}})}}]);(function(){var support=mw.OgvJsSupport={loadOgvJs:function(mod){mod=mod||'ext.tmh.OgvJs';return $.Deferred(function(deferred){if(typeof OGVPlayer==='undefined'){mw.loader.using(mod,function(){OGVLoader.base=support.basePath();deferred.resolve();});}else{deferred.resolve();}});},canPlayNatively:function(){var el=document.createElement('video');if(el&&el.canPlayType&&el.canPlayType('application/ogg')){return true;}return false;},loadIfNeeded:function(mod){mod=mod||'ext.tmh.OgvJs';if(this.canPlayNatively()){return $.Deferred(function(deferred){deferred.resolve();});}else{return this.loadOgvJs(mod);}},basePath:function(){return mw.config.get('wgExtensionAssetsPath')+'/TimedMediaHandler/resources/mwembed/lib/binPlayers/ogv.js';},initAudioContext:function(){var
context,node,AudioContext=window.AudioContext||window.webkitAudioContext;if(AudioContext){context=new AudioContext();if(context.createScriptProcessor){node=context.createScriptProcessor(1024,0,2);}else if(context.createJavaScriptNode){node=context.createJavaScriptNode(1024,0,2);}else{throw new Error('Bad version of web audio API?');}node.connect(context.destination);node.disconnect();return context;}else{return null;}}};}());});mw.loader.implement("fullScreenApi@1r71reo",function($,jQuery,require,module){(function(){var fullScreenApi={supportsFullScreen:!1,isFullScreen:function(){return false;},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:'',prefix:''},browserPrefixes='webkit moz o ms khtml'.split(' ');if(typeof document.exitFullscreen!='undefined'){fullScreenApi.supportsFullScreen=!0;}else{for(var i=0,il=browserPrefixes.length;i<il;i++){fullScreenApi.prefix=browserPrefixes[i];if(typeof document[fullScreenApi.prefix+'ExitFullscreen']!='undefined'){fullScreenApi.supportsFullScreen=!0;break;}if(typeof document[fullScreenApi.prefix+'CancelFullScreen']!='undefined'){fullScreenApi.supportsFullScreen=!0;break;}}}if(fullScreenApi.supportsFullScreen){fullScreenApi.fullScreenEventName=fullScreenApi.prefix+'fullscreenchange';fullScreenApi.isFullScreen=function(doc){if(!doc){doc=document;}if(typeof doc.fullscreenElement!=='undefined'){return!!doc.fullscreenElement;}else if(
typeof doc[this.prefix+'FullscreenElement']!=='undefined'){return!!doc[this.prefix+'FullscreenElement'];}else{switch(this.prefix){case'':return doc.fullScreen;case'webkit':return doc.webkitIsFullScreen;default:return doc[this.prefix+'FullScreen'];}}}
fullScreenApi.requestFullScreen=function(el){var func=el.requestFullscreen||el[this.prefix+'RequestFullscreen']||el[this.prefix+'RequestFullScreen']
return func.call(el);}
fullScreenApi.cancelFullScreen=function(el){var func=document.exitFullscreen||document[this.prefix+'ExitFullscreen']||document[this.prefix+'CancelFullScreen'];return func.call(document);}}if(typeof jQuery!='undefined'){jQuery.fn.requestFullScreen=function(){return this.each(function(){var el=jQuery(this);if(fullScreenApi.supportsFullScreen){fullScreenApi.requestFullScreen(el);}});};}window.fullScreenApi=fullScreenApi;})();});mw.loader.implement("jquery.debouncedresize@16dtf23",function($,jQuery,require,module){(function($){var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler);},teardown:function(){$(this).off("resize",$special.handler);},handler:function(event,execAsap){var context=this,args=arguments,dispatch=function(){event.type="debouncedresize";$event.dispatch.apply(context,args);};if(resizeTimeout){clearTimeout(resizeTimeout);}execAsap?dispatch():resizeTimeout=setTimeout(dispatch,$special.threshold);},threshold:150};})(jQuery);});mw.loader.implement("jquery.embedMenu@0mqy64w",function($,jQuery,require,module){var allUIMenus=[];(function($){$.getLineItem=function(string,icon,callback,opt_class,opt_data){var $li=$('<li>').append($('<a>').attr('href','#').click(callback));if(!opt_class){opt_class='';}if(!opt_data){opt_data=[];}if(icon){$li.find('a').append($('<span style="float:left;"></span>').addClass('ui-icon ui-icon-'+icon).addClass(opt_class).data(opt_data));}$li.find('a').append($('<span>').text(string));return $li;};$.fn.embedMenu=function(options){var caller=this;var options=options;if(!caller.m){caller.m=new Menu(caller,options);allUIMenus.push(caller.m);$(this).mousedown(function(){if(!caller.m.menuOpen){caller.m.showLoading();};}).click(function(){if(caller.m.menuOpen==false){caller.m.showMenu();}else{caller.m.kill();};return false;});}if(options.autoShow){setTimeout(function(){caller.m.showLoading();caller.m.showMenu();},0);}if(options=='show'){caller.m.showMenu();}return this;};function Menu(caller,
options){var menu=this;var caller=$(caller);mw.log('jquery.Menu:: target container: '+options.targetMenuContainer);var callerClassList='fg-menu-container ui-widget ui-widget-content ui-corner-all';if(options.targetMenuContainer){var container=$(options.targetMenuContainer).addClass(callerClassList).html(options.content)}else{var container=$('<div>').addClass(callerClassList).html(options.content);}this.menuOpen=!1;this.menuExists=!1;var options=jQuery.extend({content:null,autoShow:!1,width:180,maxHeight:180,targetMenuContainer:null,zindex:2,positionOpts:{posX:'left',posY:'bottom',offsetX:0,offsetY:0,directionH:'right',directionV:'down',detectH:!0,detectV:!0,linkToFront:!1},showSpeed:200,createMenuCallback:null,closeMenuCallback:null,callerOnState:'ui-state-active',loadingState:'ui-state-loading',linkHover:'ui-state-hover',linkHoverSecondary:'li-hover',crossSpeed:200,crumbDefaultText:'Choose an option:',backLink:!0,backLinkText:'Back',flyOut:!1,flyOutOnState:
'ui-state-default',nextMenuLink:'ui-icon-triangle-1-e',topLinkText:'All',nextCrumbLink:'ui-icon-carat-1-e'},options);container.css({'left':'0px','z-index':options.zindex});var killAllMenus=function(){$.each(allUIMenus,function(i){if(allUIMenus[i].menuOpen){allUIMenus[i].kill();};});};this.kill=function(){caller.removeClass(options.loadingState).removeClass('fg-menu-open').removeClass(options.callerOnState);container.find('li').removeClass(options.linkHoverSecondary).find('a').removeClass(options.linkHover);if(options.flyOutOnState){container.find('li a').removeClass(options.flyOutOnState);};if(options.callerOnState){caller.removeClass(options.callerOnState);};if(container.is('.fg-menu-ipod')){menu.resetDrilldownMenu();};if(container.is('.fg-menu-flyout')){menu.resetFlyoutMenu();};if(!options.keepPosition){container.parent().hide();}else{container.hide();}menu.menuOpen=!1;if(typeof options.closeMenuCallback=='function'){options.closeMenuCallback();}$(document).unbind('click',
killAllMenus);$(document).unbind('keydown');};this.showLoading=function(){caller.addClass(options.loadingState);};this.showMenu=function(){mw.log('jquery.embedMenu:: show menu');killAllMenus();menu.create()
mw.log('jquery.embedMenu:: menu.create');caller.addClass('fg-menu-open').addClass(options.callerOnState);container.parent().show().click(function(){menu.kill();return false;});mw.log('jquery.embedMenu:: menu. binding container');container.hide().slideDown(options.showSpeed).find('.fg-menu:eq(0)');menu.menuOpen=!0;caller.removeClass(options.loadingState);$(document).click(killAllMenus);$(document).keydown(function(event){var e;if(event.which!=""){e=event.which;}else if(event.charCode!=""){e=event.charCode;}else if(event.keyCode!=""){e=event.keyCode;}var menuType=($(event.target).parents('div').is('.fg-menu-flyout'))?'flyout':'ipod';switch(e){case 37:if(menuType=='flyout'){$(event.target).trigger('mouseout');if($('.'+options.flyOutOnState).length>0){$('.'+options.flyOutOnState).trigger('mouseover');};};if(menuType=='ipod'){$(event.target).trigger('mouseout');if($('.fg-menu-footer').find('a').length>0){$('.fg-menu-footer').find('a').trigger('click');};if($('.fg-menu-header').find('a').
length>0){$('.fg-menu-current-crumb').prev().find('a').trigger('click');};if($('.fg-menu-current').prev().is('.fg-menu-indicator')){$('.fg-menu-current').prev().trigger('mouseover');};};return false;break;case 38:if($(event.target).is('.'+options.linkHover)){var prevLink=$(event.target).parent().prev().find('a:eq(0)');if(prevLink.length>0){$(event.target).trigger('mouseout');prevLink.trigger('mouseover');};}else{container.find('a:eq(0)').trigger('mouseover');}return false;break;case 39:if($(event.target).is('.fg-menu-indicator')){if(menuType=='flyout'){$(event.target).next().find('a:eq(0)').trigger('mouseover');}else if(menuType=='ipod'){$(event.target).trigger('click');setTimeout(function(){$(event.target).next().find('a:eq(0)').trigger('mouseover');},options.crossSpeed);};};return false;break;case 40:if($(event.target).is('.'+options.linkHover)){var nextLink=$(event.target).parent().next().find('a:eq(0)');if(nextLink.length>0){$(event.target).trigger('mouseout');nextLink.trigger(
'mouseover');};}else{container.find('a:eq(0)').trigger('mouseover');}return false;break;case 27:killAllMenus();break;case 13:if($(event.target).is('.fg-menu-indicator')&&menuType=='ipod'){$(event.target).trigger('click');setTimeout(function(){$(event.target).next().find('a:eq(0)').trigger('mouseover');},options.crossSpeed);};break;};});};this.create=function(){mw.log("jquery.embedMenu.create ");container.css({'width':options.width}).find('ul:first').not('.fg-menu-breadcrumb').addClass('fg-menu');if(!options.keepPosition){container.appendTo('body')}container.find('ul, li a').addClass('ui-corner-all');container.find('ul').attr('role','menu').eq(0).attr('aria-activedescendant','active-menuitem').attr('aria-labelledby',caller.attr('id'));container.find('li').attr('role','menuitem');container.find('li:has(ul)').attr('aria-haspopup','true').find('ul').attr('aria-expanded','false');container.find('a').attr('tabindex','-1');if(container.find('ul').length>1){if(options.flyOut){mw.log(
"jquery.embedMenu:: call menu.flyout ");menu.flyout(container,options);}else{mw.log("jquery.embedMenu:: call menu.drilldown ");menu.drilldown(container,options);}}else{container.find('a').click(function(){menu.chooseItem(this);return false;});};if(options.linkHover){var allLinks=container.find('.fg-menu li a');allLinks.hover(function(){var menuitem=$(this);var menuli=menuitem.parent();if(!menuli.hasClass('divider')&&!menuli.hasClass('disabled')){$('.'+options.linkHover).removeClass(options.linkHover).blur().parent().removeAttr('id');$(this).addClass(options.linkHover).focus().parent().addClass('active-menuitem');}},function(){if(typeof menuitem!='undefined'&&!menuitem.hasClass('divider')&&!menuitem.hasClass('disabled')){$(this).removeClass(options.linkHover).blur().parent().removeClass('active-menuitem');}});};if(options.linkHoverSecondary){container.find('.fg-menu li').hover(function(){$(this).siblings('li').removeClass(options.linkHoverSecondary);if(options.flyOutOnState){$(this).
siblings('li').find('a').removeClass(options.flyOutOnState);}$(this).addClass(options.linkHoverSecondary);},function(){$(this).removeClass(options.linkHoverSecondary);});};if(!options.keepPosition){menu.setPosition(container,caller,options);}menu.menuExists=!0;if(typeof options.createMenuCallback=='function'){options.createMenuCallback();}};this.chooseItem=function(item){menu.kill();if(options.selectItemCallback)options.selectItemCallback(item);};};Menu.prototype.flyout=function(container,options){var menu=this;this.resetFlyoutMenu=function(){var allLists=container.find('ul ul');allLists.removeClass('ui-widget-content').hide();};container.addClass('fg-menu-flyout').find('li:has(ul)').each(function(){var linkWidth=container.width();var showTimer,hideTimer;var allSubLists=$(this).find('ul');allSubLists.css({left:linkWidth,width:linkWidth}).hide();$(this).find('a:eq(0)').addClass('fg-menu-indicator').html('<span>'+$(this).find('a:eq(0)').html()+'</span><span class="ui-icon '+options.
nextMenuLink+'"></span>').hover(function(){clearTimeout(hideTimer);var subList=$(this).next();if(!fitVertical(subList,$(this).offset().top)){subList.css({top:'auto',bottom:0});};if(!fitHorizontal(subList,$(this).offset().left+100)){subList.css({left:'auto',right:linkWidth,'z-index':1005});};showTimer=setTimeout(function(){subList.addClass('ui-widget-content').show(options.showSpeed).attr('aria-expanded','true');},300);},function(){clearTimeout(showTimer);var subList=$(this).next();hideTimer=setTimeout(function(){subList.removeClass('ui-widget-content').hide(options.showSpeed).attr('aria-expanded','false');},400);});$(this).find('ul a').hover(function(){clearTimeout(hideTimer);if($(this).parents('ul').prev().is('a.fg-menu-indicator')){$(this).parents('ul').prev().addClass(options.flyOutOnState);}},function(){hideTimer=setTimeout(function(){allSubLists.hide(options.showSpeed);container.find(options.flyOutOnState).removeClass(options.flyOutOnState);},500);});});container.find('a').click(
function(){menu.chooseItem(this);return false;});};Menu.prototype.drilldown=function(container,options){var menu=this;var topList=container.find('.fg-menu');var breadcrumb=$('<ul class="fg-menu-breadcrumb ui-widget-header ui-corner-all ui-helper-clearfix"></ul>');var crumbDefaultHeader=$('<li class="fg-menu-breadcrumb-text">'+options.crumbDefaultText+'</li>');var firstCrumbText=(options.backLink)?options.backLinkText:options.topLinkText;var firstCrumbClass=(options.backLink)?'fg-menu-prev-list':'fg-menu-all-lists';var firstCrumbLinkClass=(options.backLink)?'ui-state-default ui-corner-all':'';var firstCrumbIcon=(options.backLink)?'<span class="ui-icon ui-icon-triangle-1-w"></span>':'';var firstCrumb=$('<li class="'+firstCrumbClass+'"><a href="#" class="'+firstCrumbLinkClass+'">'+firstCrumbIcon+firstCrumbText+'</a></li>');container.addClass('fg-menu-ipod');if(options.backLink){breadcrumb.addClass('fg-menu-footer').appendTo(container).hide();}else{breadcrumb.addClass('fg-menu-header').
prependTo(container);};breadcrumb.append(crumbDefaultHeader);var checkMenuHeight=function(el){if(el.height()>options.maxHeight){el.addClass('fg-menu-scroll')};el.css({height:options.maxHeight-30});};var resetChildMenu=function(el){el.removeClass('fg-menu-scroll').removeClass('fg-menu-current').height('auto');};this.resetDrilldownMenu=function(){$('.fg-menu-current').removeClass('fg-menu-current');topList.animate({left:0},options.crossSpeed,function(){$(this).find('ul').each(function(){$(this).hide();resetChildMenu($(this));});topList.addClass('fg-menu-current');});$('.fg-menu-all-lists').find('span').remove();breadcrumb.empty().append(crumbDefaultHeader);$('.fg-menu-footer').empty().hide();checkMenuHeight(topList);};topList.addClass('fg-menu-content fg-menu-current ui-widget-content ui-helper-clearfix').css({width:container.width()}).find('ul').css({width:container.width(),left:container.width()}).addClass('ui-widget-content').hide();checkMenuHeight(topList);topList.find('a').each(
function(){if($(this).next().is('ul')){$(this).addClass('fg-menu-indicator').each(function(){if(!$(this).hasClass('fg-menu-link')){$(this).addClass('fg-menu-link').html(nextMenuLink='<span>'+$(this).html()+'</span><span class="ui-icon '+options.nextMenuLink+'"></span>')}}).click(function(){var nextList=$(this).next();var parentUl=$(this).parents('ul:eq(0)');var parentLeft=(parentUl.is('.fg-menu-content'))?0:parseFloat(topList.css('left'));var nextLeftVal=Math.round(parentLeft-parseFloat(container.width()));var footer=$('.fg-menu-footer');resetChildMenu(parentUl);checkMenuHeight(nextList);topList.animate({left:nextLeftVal},options.crossSpeed);nextList.show().addClass('fg-menu-current').attr('aria-expanded','true');var setPrevMenu=function(backlink){var b=backlink;var c=$('.fg-menu-current');var prevList=c.parents('ul:eq(0)');c.hide().attr('aria-expanded','false');resetChildMenu(c);checkMenuHeight(prevList);prevList.addClass('fg-menu-current').attr('aria-expanded','true');if(prevList.
hasClass('fg-menu-content')){b.remove();footer.hide();};};if(options.backLink){if(footer.find('a').length==0){footer.show();$('<a href="#"><span class="ui-icon ui-icon-triangle-1-w"></span> <span>Back</span></a>').appendTo(footer).click(function(){var b=$(this);var prevLeftVal=parseFloat(topList.css('left'))+container.width();topList.animate({left:prevLeftVal},options.crossSpeed,function(){setPrevMenu(b);});return false;});}}else{if(breadcrumb.find('li').length==1){breadcrumb.empty().append(firstCrumb);firstCrumb.find('a').click(function(){menu.resetDrilldownMenu();return false;});}$('.fg-menu-current-crumb').removeClass('fg-menu-current-crumb');var crumbText=$(this).find('span:eq(0)').text();var newCrumb=$('<li class="fg-menu-current-crumb"><a href="javascript://" class="fg-menu-crumb">'+crumbText+'</a></li>');newCrumb.appendTo(breadcrumb).find('a').click(function(){if($(this).parent().is('.fg-menu-current-crumb')){menu.chooseItem(this);}else{var newLeftVal=-($('.fg-menu-current').
parents('ul').length-1)*180;topList.animate({left:newLeftVal},options.crossSpeed,function(){setPrevMenu();});$(this).parent().addClass('fg-menu-current-crumb').find('span').remove();$(this).parent().nextAll().remove();};return false;});newCrumb.prev().append(' <span class="ui-icon '+options.nextCrumbLink+'"></span>');};return false;});}else{$(this).click(function(){menu.chooseItem(this);return false;});};});};Menu.prototype.setPosition=function(widget,caller,options){mw.log('jquery.embedMenu::setPosition');var el=widget;var referrer=caller;var dims={refX:referrer.offset().left,refY:referrer.offset().top,refW:referrer.getTotalWidth(),refH:referrer.getTotalHeight()};var options=options;var xVal,yVal;var helper=$('<div class="menuPositionHelper">');helper.css('z-index',options.zindex);if(isNaN(dims.refW)||isNaN(dims.refH)){dims.refH=16;dims.refW=23;}helper.css({'position':'absolute','left':dims.refX,'top':dims.refY,'width':dims.refW,'height':dims.refH});el.wrap(helper);xVal=yVal=0;switch(
options.positionOpts.posX){case'left':xVal=0;break;case'center':xVal=dims.refW/2;break;case'right':xVal=dims.refW;break;};switch(options.positionOpts.posY){case'top':yVal=0;break;case'center':yVal=dims.refH/2;break;case'bottom':yVal=dims.refH;break;};xVal+=(options.positionOpts.offsetX)?options.positionOpts.offsetX:0;yVal+=(options.positionOpts.offsetY)?options.positionOpts.offsetY:0;mw.log(" about to position: "+yVal);if(options.positionOpts.directionV=='up'){el.css({'top':'auto','bottom':yVal});if(options.positionOpts.detectV&&!fitVertical(el)){el.css({'bottom':'auto','top':yVal});}}else{el.css({'bottom':'auto','top':yVal});if(options.positionOpts.detectV&&!fitVertical(el)){el.css({'top':'auto','bottom':yVal});}};if(options.positionOpts.directionH=='left'){el.css({left:'auto',right:xVal});if(options.positionOpts.detectH&&!fitHorizontal(el)){el.css({right:'auto',left:xVal});}}else{el.css({right:'auto',left:xVal});if(options.positionOpts.detectH&&!fitHorizontal(el)){el.css({left:'auto'
,right:xVal});}};if(options.positionOpts.linkToFront){referrer.clone().addClass('linkClone').css({position:'absolute',top:0,right:'auto',bottom:'auto',left:0,width:referrer.width(),height:referrer.height()}).insertAfter(el);};};function sortBigToSmall(a,b){return b-a;};jQuery.fn.getTotalWidth=function(){return $(this).width()+parseInt($(this).css('paddingRight'))+parseInt($(this).css('paddingLeft'))+parseInt($(this).css('borderRightWidth'))+parseInt($(this).css('borderLeftWidth'));};jQuery.fn.getTotalHeight=function(){return $(this).height()+parseInt($(this).css('paddingTop'))+parseInt($(this).css('paddingBottom'))+parseInt($(this).css('borderTopWidth'))+parseInt($(this).css('borderBottomWidth'));};function getScrollTop(){return self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;};function getScrollLeft(){return self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;};function getWindowHeight(){var de=document.documentElement;return self
.innerHeight||(de&&de.clientHeight)||document.body.clientHeight;};function getWindowWidth(){var de=document.documentElement;return self.innerWidth||(de&&de.clientWidth)||document.body.clientWidth;};function fitHorizontal(el,leftOffset){var leftVal=parseInt(leftOffset)||$(el).offset().left;return(leftVal+$(el).width()<=getWindowWidth()+getScrollLeft()&&leftVal-getScrollLeft()>=0);};function fitVertical(el,topOffset){var topVal=parseInt(topOffset)||$(el).offset().top;return(topVal+$(el).height()<=getWindowHeight()+getScrollTop()&&topVal-getScrollTop()>=0);};})(jQuery);},{"css":[
".fg-menu-container{position:absolute;top:0;right:-999px;padding:.4em;overflow:hidden}.fg-menu-container.fg-menu-flyout{overflow:visible}.fg-menu,.fg-menu ul{list-style:none none;padding:0;margin:0}.fg-menu{position:relative}.fg-menu-flyout .fg-menu{position:static}.fg-menu ul{position:absolute;top:0}.fg-menu ul ul{top:-1px}.fg-menu-container.fg-menu-ipod .fg-menu-content,.fg-menu-container.fg-menu-ipod .fg-menu-content ul{background:none !important}.fg-menu.fg-menu-scroll,.fg-menu ul.fg-menu-scroll{overflow:scroll;overflow-x:hidden}.fg-menu li{clear:both;float:right;width:100%;margin:0;padding:0;border:0}.fg-menu li li{font-size:1em} .fg-menu-flyout ul ul{padding:.4em}.fg-menu-flyout li{position:relative}.fg-menu-scroll{overflow:scroll;overflow-x:hidden}.fg-menu-breadcrumb{margin:0;padding:0}.fg-menu-footer{margin-top:.4em;padding:.4em;position:absolute;bottom:2px;width:170px}.fg-menu-header{margin-bottom:.4em;padding:.4em}.fg-menu-breadcrumb li{float:right;list-style:none;margin:0;padding:0 .2em;font-size:.9em;opacity:.7}.fg-menu-breadcrumb li.fg-menu-prev-list,.fg-menu-breadcrumb li.fg-menu-current-crumb{clear:right;float:none;opacity:1}.fg-menu-breadcrumb li.fg-menu-current-crumb{padding-top:.2em}.fg-menu-breadcrumb a,.fg-menu-breadcrumb span{float:right}.fg-menu-footer a:link,.fg-menu-footer a:visited{float:right;width:100%;text-decoration:none}.fg-menu-footer a:hover,.fg-menu-footer a:active{}.fg-menu-footer a span{float:right;cursor:pointer}.fg-menu-breadcrumb .fg-menu-prev-list a:link,.fg-menu-breadcrumb .fg-menu-prev-list a:visited,.fg-menu-breadcrumb .fg-menu-prev-list a:hover,.fg-menu-breadcrumb .fg-menu-prev-list a:active{background-image:none;text-decoration:none}.fg-menu-breadcrumb .fg-menu-prev-list a{float:right;padding-left:.4em}.fg-menu-breadcrumb .fg-menu-prev-list a .ui-icon{float:right}.fg-menu-breadcrumb .fg-menu-current-crumb a:link,.fg-menu-breadcrumb .fg-menu-current-crumb a:visited,.fg-menu-breadcrumb .fg-menu-current-crumb a:hover,.fg-menu-breadcrumb .fg-menu-current-crumb a:active{display:block;background-image:none;font-size:1.3em;text-decoration:none} .fg-menu a:link,.fg-menu a:visited,.fg-menu a:hover,.fg-menu a:active{float:right;width:92%;padding:.3em 3%;text-decoration:none;outline:0 !important}.fg-menu a{border:1px dashed transparent}.fg-menu a.ui-state-default:link,.fg-menu a.ui-state-default:visited,.fg-menu a.ui-state-default:hover,.fg-menu a.ui-state-default:active,.fg-menu a.ui-state-hover:link,.fg-menu a.ui-state-hover:visited,.fg-menu a.ui-state-hover:hover,.fg-menu a.ui-state-hover:active,.fg-menu a.ui-state-active:link,.fg-menu a.ui-state-active:visited,.fg-menu a.ui-state-active:hover,.fg-menu a.ui-state-active:active{border-style:solid;font-weight:normal}.fg-menu a span{display:block;cursor:pointer} .fg-menu-indicator span{float:right}.fg-menu-indicator span.ui-icon{float:left}.fg-menu-content.ui-widget-content,.fg-menu-content ul.ui-widget-content{border:0} .fg-menu.fg-menu-has-icons a:link,.fg-menu.fg-menu-has-icons a:visited,.fg-menu.fg-menu-has-icons a:hover,.fg-menu.fg-menu-has-icons a:active{padding-right:20px}.fg-menu .horizontal-divider hr,.fg-menu .horizontal-divider span{padding:0;margin:5px .6em}.fg-menu .horizontal-divider hr{border:0;height:1px}.fg-menu .horizontal-divider span{font-size:.9em;text-transform:uppercase;padding-right:.2em}"
]});mw.loader.implement("jquery.hoverIntent@0dl80b7",function($,jQuery,require,module){(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY;};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev]);}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev]);};var handleHover=function(e){var p=(e.type=="mouseover"?e.fromElement:e.toElement)||e.relatedTarget;while(p&&p!=this){try{p=p.parentNode;}catch(e){p=this;}}if(p==this){return false;}var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);}if(e.
type=="mouseover"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob);},cfg.timeout);}}};return this.mouseover(handleHover).mouseout(handleHover);};})(jQuery);});mw.loader.implement("jquery.ui.touchPunch@1kvm02e",function($,jQuery,require,module){(function($){jQuery.ui['touchPunch']=!0;$.support.touch='ontouchend'in document;if(!$.support.touch){return;}var mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,touchHandled;function simulateMouseEvent(event,simulatedType){if(event.originalEvent.touches.length>1){return;}event.preventDefault();var touch=event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent('MouseEvents');simulatedEvent.initMouseEvent(simulatedType,true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);event.target.dispatchEvent(simulatedEvent);}mouseProto._touchStart=function(event){var self=this;if(touchHandled||!self._mouseCapture(event.originalEvent.changedTouches[0])){return;}touchHandled=!0;self._touchMoved=!1;simulateMouseEvent(event,'mouseover');simulateMouseEvent(event,'mousemove');simulateMouseEvent(event,'mousedown');};mouseProto.
_touchMove=function(event){if(!touchHandled){return;}this._touchMoved=!0;simulateMouseEvent(event,'mousemove');};mouseProto._touchEnd=function(event){if(!touchHandled){return;}simulateMouseEvent(event,'mouseup');simulateMouseEvent(event,'mouseout');if(!this._touchMoved){simulateMouseEvent(event,'click');}touchHandled=!1;};mouseProto._mouseInit=function(){var self=this;self.element.bind('touchstart',$.proxy(self,'_touchStart')).bind('touchmove',$.proxy(self,'_touchMove')).bind('touchend',$.proxy(self,'_touchEnd'));_mouseInit.call(self);};})(jQuery);});mw.loader.implement("mediawiki.UtilitiesTime@0k2m6dy",function($,jQuery,require,module){(function(){mw.seconds2npt=function(sec,showMs){var tm,hoursStr;if(isNaN(sec)){mw.log('Warning: mediawiki.UtilitiesTime, trying to get npt time on NaN:'+sec);return'0:00:00';}tm=mw.seconds2Measurements(sec);if(showMs){tm.seconds=Math.round(tm.seconds*1000)/1000;}else{tm.seconds=Math.round(tm.seconds);}if(tm.seconds<10){tm.seconds='0'+tm.seconds;}if(tm.hours===0){hoursStr='';}else{if(tm.minutes<10){tm.minutes='0'+tm.minutes;}hoursStr=tm.hours+':';}return hoursStr+tm.minutes+':'+tm.seconds;};mw.seconds2Measurements=function(sec){var tm={};tm.days=Math.floor(sec/(3600*24));tm.hours=Math.floor(sec/3600);tm.minutes=Math.floor((sec/60)%60);tm.seconds=sec%60;return tm;};mw.measurements2seconds=function(timeMeasurements){var seconds=0;if(timeMeasurements.days){seconds+=parseInt(timeMeasurements.days,10)*24*3600;}if(timeMeasurements.hours){seconds+=parseInt(timeMeasurements.hours,10)*3600;}if(
timeMeasurements.minutes){seconds+=parseInt(timeMeasurements.minutes,10)*60;}if(timeMeasurements.seconds){seconds+=parseInt(timeMeasurements.seconds,10);}if(timeMeasurements.milliseconds){seconds+=parseFloat(timeMeasurements.milliseconds)/1000;}return seconds;};mw.npt2seconds=function(nptString){var hour,min,sec,times;if(!nptString){return 0;}nptString=nptString.replace(/npt:|s/g,'');hour=0;min=0;times=nptString.replace(/,\s?/,'.').split(':');sec=+(times.pop()||0);min=+(times.pop()||0);hour=+(times.pop()||0);return(hour*3600)+(min*60)+sec;};}());});mw.loader.implement("mediawiki.absoluteUrl@1vyq4rr",function($,jQuery,require,module){(function(){mw.absoluteUrl=function(source,contextUrl){var contextUrlObj,fileUrl;if(source.indexOf('http://')===0||source.indexOf('https://')===0){return source;}contextUrlObj=new mw.Uri(contextUrl||document.URL);if(source.indexOf('//')===0){return contextUrlObj.protocol+':'+source;}if(contextUrlObj.directory===''&&contextUrlObj.protocol==='file'){fileUrl=contextUrlObj.split('\\');fileUrl.pop();return fileUrl.join('\\')+'\\'+source;}if(source.indexOf('/')===0){return contextUrlObj.protocol+'://'+contextUrlObj.getAuthority()+source;}else{return contextUrlObj.protocol+'://'+contextUrlObj.getAuthority()+contextUrlObj.path+source;}};}());});mw.loader.implement("mediawiki.client@08g5pb9",function($,jQuery,require,module){(function(){var config=mw.config.get('wgTimedMediaHandler');mw.isMobileDevice=function(){return(mw.isIphone()||mw.isIpod()||mw.isIpad()||mw.isAndroid());};mw.isIphone=function(){return(navigator.userAgent.indexOf('iPhone')!==-1&&!mw.isIpad());};mw.isIphone4=function(){return(mw.isIphone()&&(window.devicePixelRatio&&window.devicePixelRatio>=2));};mw.isIpod=function(){return(navigator.userAgent.indexOf('iPod')!==-1);};mw.isIpad=function(){return(navigator.userAgent.indexOf('iPad')!==-1);};mw.isAndroid=function(){return(navigator.userAgent.indexOf('Android ')!==-1);};mw.isMobileChrome=function(){return(navigator.userAgent.indexOf('Android 4.')!==-1&&navigator.userAgent.indexOf('Chrome')!==-1);};mw.isIOS=function(){return(mw.isIphone()||mw.isIpod()||mw.isIpad());};mw.isHTML5FallForwardNative=function(){if(mw.isMobileHTML5()){return true;}if(document.URL.indexOf('forceMobileHTML5')!==-1){return true;}if(mw.
supportsFlash()){return false;}if(mw.supportsHTML5()){return true;}return false;};mw.isMobileHTML5=function(){if(mw.isIphone()||mw.isIpod()||mw.isIpad()){return true;}return false;};mw.supportsHTML5=function(){var dummyvid;if(navigator.userAgent.indexOf('BlackBerry')!==-1){return false;}dummyvid=document.createElement('video');if(dummyvid.canPlayType){return true;}return false;};mw.supportsFlash=function(){var majorVersion;if(config['EmbedPlayer.DisableHTML5FlashFallback']){return false;}majorVersion=this.getFlashVersion().split(',').shift();if(majorVersion<10){return false;}else{return true;}};mw.getFlashVersion=function(){var axo;if(navigator.plugins&&navigator.plugins.length){try{if(navigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin){return(navigator.plugins['Shockwave Flash 2.0']||navigator.plugins['Shockwave Flash']).description.replace(/\D+/g,',').match(/^,?(.+),?$/)[1];}}catch(e){}}try{try{if(typeof ActiveXObject!=='undefined'){axo=new ActiveXObject(
'ShockwaveFlash.ShockwaveFlash.6');try{axo.AllowScriptAccess='always';}catch(e){return'6,0,0';}}}catch(e){}return new ActiveXObject('ShockwaveFlash.ShockwaveFlash').GetVariable('$version').replace(/\D+/g,',').match(/^,?(.+),?$/)[1];}catch(e){}return'0,0,0';};}());});mw.loader.implement("mediawiki.language.names@15p4zaj",{"main":"mediawiki.language.names.js","files":{"mediawiki.language.names.js":function(require,module){(function(){var names=require('./names.json');mw.language.setData(mw.config.get('wgUserLanguage'),'languageData',names);}());},"names.json":{"aa":"الأفارية","ab":"الأبخازية","abe":"Western Abenaki","abq":"Abaza","abs":"Ambonese Malay","ace":"الأتشينيزية","ach":"الأكولية","ada":"الأدانجمية","ady":"الأديغة","ady-cyrl":"Adyghe (Cyrillic script)","ae":"الأفستية","aeb":"Tunisian Arabic","aeb-arab":"Tunisian Arabic (Arabic script)","aeb-latn":"Tunisian Arabic (Latin script)","af":"الأفريقانية","afh":"الأفريهيلية","agq":"الأغم","ain":"الآينوية","ak":"الأكانية","akk":"الأكادية","akz":"Alabama","ale":"الأليوتية","aln":"Gheg Albanian","als":"Alemannisch","alt":"الألطائية الجنوبية","am":"الأمهرية",
"ami":"Amis","an":"الأراغونية","ang":"الإنجليزية القديمة","anp":"الأنجيكا","ar":"العربية","ar-001":"العربية الرسمية الحديثة","arc":"الآرامية","arn":"المابودونغونية","aro":"Araona","arp":"الأراباهو","arq":"Algerian Arabic","ars":"اللهجة النجدية","arw":"الأراواكية","ary":"Moroccan Arabic","arz":"Egyptian Arabic","as":"الأسامية","asa":"الآسو","ase":"American Sign Language","ast":"الأسترية","atj":"Atikamekw","av":"الأوارية","avk":"Kotava","awa":"الأوادية","ay":"الأيمارا","az":"الأذربيجانية","azb":"South Azerbaijani","ba":"الباشكيرية","bal":"البلوشية","ban":"البالينية","bar":"Bavarian","bas":"الباسا","bat-smg":"Samogitian","bax":"بامن","bbc":"Batak Toba","bbc-latn":"Batak Toba (Latin script)","bbj":"لغة الغومالا","bcc":"Southern Balochi","bcl":"Central Bikol","be":
"البيلاروسية","be-tarask":"Belarusian (Taraškievica orthography)","be-x-old":"Belarusian (Taraškievica orthography)","bej":"البيجا","bem":"البيمبا","bew":"Betawi","bez":"بينا","bfd":"لغة البافوت","bfq":"Badaga","bg":"البلغارية","bgn":"البلوشية الغربية","bgp":"Eastern Balochi","bh":"Bhojpuri","bho":"البهوجبورية","bi":"البيسلامية","bik":"البيكولية","bin":"البينية","bjn":"Banjar","bkm":"لغة الكوم","bla":"السيكسيكية","bm":"البامبارا","bn":"البنغالية","bnn":"Bunun","bo":"التبتية","bpy":"Bishnupriya","bqi":"Bakhtiari","br":"البريتونية","bra":"البراجية","brh":"Brahui","brx":"البودو","bs":"البوسنية","bss":"أكوس","btm":"Batak Mandailing","bto":"Iriga Bicolano","bua":"البرياتية","bug":"البجينيزية","bum":"لغة البولو","bxr":"Russia Buriat","byn":"البلينية","byv":
"لغة الميدومبا","ca":"الكتالانية","cad":"الكادو","car":"الكاريبية","cay":"الكايوجية","cbk-zam":"Chavacano","cch":"الأتسام","ccp":"Chakma","cdo":"Min Dong Chinese","ce":"الشيشانية","ceb":"السيبيوانية","cgg":"تشيغا","ch":"التشامورو","chb":"التشيبشا","chg":"التشاجاتاي","chk":"التشكيزية","chm":"الماري","chn":"الشينوك جارجون","cho":"الشوكتو","chp":"الشيباوايان","chr":"الشيروكي","chy":"الشايان","cja":"Western Cham","cja-arab":"Western Cham (Arabic script)","cja-cham":"Western Cham (Cham script)","cja-latn":"Western Cham (Latin script)","cjm":"Eastern Cham","cjm-arab":"Eastern Cham (Arabic script)","cjm-cham":"Eastern Cham (Cham script)","cjm-latn":"Eastern Cham (Latin script)","cjy":"Jinyu","cjy-hans":"Jinyu (Simplified)","cjy-hant":"Jinyu (Traditional)","ckb":"السورانية الكردية","cnr":"Montenegrin","co":
"الكورسيكية","cop":"القبطية","cps":"Capiznon","cr":"الكرى","crh":"لغة تتار القرم","crh-cyrl":"Crimean Tatar (Cyrillic script)","crh-latn":"Crimean Tatar (Latin script)","crs":"الفرنسية الكريولية السيشيلية","cs":"التشيكية","csb":"الكاشبايان","cu":"سلافية كنسية","cv":"التشوفاشي","cy":"الويلزية","da":"الدانمركية","dak":"الداكوتا","dar":"الدارجوا","dav":"تيتا","de":"الألمانية","de-at":"الألمانية النمساوية","de-ch":"الألمانية العليا السويسرية","de-formal":"German (formal address)","del":"الديلوير","den":"السلافية","dgr":"الدوجريب","din":"الدنكا","diq":"Zazaki","dje":"الزارمية","dlc":"Dalecarlian","doi":"الدوجرية","dsb":"صوربيا السفلى","dtp":"Central Dusun","dty":"Doteli","dua":"الديولا","dum":"الهولندية الوسطى","dv":
"المالديفية","dyo":"جولا فونيا","dyu":"الدايلا","dz":"الزونخاية","dzg":"القرعانية","ebu":"إمبو","ee":"الإيوي","efi":"الإفيك","egl":"Emilian","egy":"المصرية القديمة","eka":"الإكاجك","el":"اليونانية","el-cy":"Cypriot Greek","elx":"الإمايت","eml":"Emiliano-Romagnolo","en":"الإنجليزية","en-au":"الإنجليزية الأسترالية","en-ca":"الإنجليزية الكندية","en-gb":"الإنجليزية البريطانية","en-us":"الإنجليزية الأمريكية","enm":"الإنجليزية الوسطى","eo":"الإسبرانتو","es":"الإسبانية","es-419":"الإسبانية أمريكا اللاتينية","es-es":"الإسبانية الأوروبية","es-formal":"español (formal)‎","es-mx":"الإسبانية المكسيكية","esu":"Central Yupik","et":"الإستونية","ett":"Etruscian","eu":"الباسكية","ewo":"الإيوندو","ext":
"Extremaduran","eya":"Eyak","fa":"الفارسية","fa-af":"Dari","fan":"الفانج","fat":"الفانتي","ff":"الفولانية","fi":"الفنلندية","fil":"الفلبينية","fit":"Tornedalen Finnish","fiu-vro":"Võro","fj":"الفيجية","fkv":"Kvensk","fo":"الفاروية","fon":"الفون","fos":"Siraya","fr":"الفرنسية","fr-ca":"الفرنسية الكندية","fr-ch":"الفرنسية السويسرية","frc":"الفرنسية الكاجونية","frm":"الفرنسية الوسطى","fro":"الفرنسية القديمة","frp":"Arpitan","frr":"الفريزينية الشمالية","frs":"الفريزينية الشرقية","fuf":"Pular","fur":"الفريلايان","fy":"الفريزيان","ga":"الأيرلندية","gaa":"الجا","gag":"الغاغوز","gan":"الغان الصينية","gan-hans":"Gan (Simplified)","gan-hant":"Gan (Traditional)","gay":"الجايو","gba":"الجبيا","gbz":"Zoroastrian Dari","gcr":"Guianan Creole","gd":
"الغيلية الأسكتلندية","gez":"الجعزية","gil":"لغة أهل جبل طارق","gl":"الجاليكية","glk":"Gilaki","gmh":"الألمانية العليا الوسطى","gmy":"Mycenaean Greek","gn":"الغوارانية","goh":"الألمانية العليا القديمة","gom":"Goan Konkani","gom-deva":"Goan Konkani (Devanagari script)","gom-latn":"Goan Konkani (Latin script)","gon":"الجندي","gor":"الجورونتالو","got":"القوطية","grb":"الجريبو","grc":"اليونانية القديمة","gsw":"الألمانية السويسرية","gu":"الغوجاراتية","guc":"Wayuu","gur":"Frafra","guz":"الغيزية","gv":"المنكية","gwi":"غوتشن","ha":"الهوسا","hai":"الهيدا","hak":"الهاكا الصينية","haw":"لغة هاواي","haz":"Hazaragi","hbo":"Biblical Hebrew","he":"العبرية","hi":"الهندية","hif":"Fiji Hindi","hif-latn":"Fiji Hindi (Latin script)","hil":"الهيليجينون",
"hit":"الحثية","hmn":"الهمونجية","ho":"الهيري موتو","hr":"الكرواتية","hrx":"Hunsrik","hsb":"الصوربية العليا","hsn":"شيانغ الصينية","ht":"الكريولية الهايتية","hu":"الهنغارية","hu-formal":"magyar (formal)‎","hup":"الهبا","hy":"الأرمنية","hyw":"Western Armenian","hz":"الهيريرو","ia":"اللّغة الوسيطة","iba":"الإيبان","ibb":"الإيبيبيو","id":"الإندونيسية","ie":"الإنترلينج","ig":"الإيجبو","ii":"السيتشيون يي","ik":"الإينبياك","ike-cans":"Eastern Canadian (Aboriginal syllabics)","ike-latn":"Eastern Canadian (Latin script)","ilo":"الإيلوكو","inh":"الإنجوشية","io":"الإيدو","is":"الأيسلندية","it":"الإيطالية","iu":"الإينكتيتت","izh":"Ingrian","ja":"اليابانية","jam":"Jamaican Creole English","jbo":"اللوجبان","jgo":"نغومبا","jmc":
"الماتشامية","jpr":"الفارسية اليهودية","jrb":"العربية اليهودية","jut":"Jutish","jv":"الجاوية","ka":"الجورجية","kaa":"الكارا-كالباك","kab":"القبيلية","kac":"الكاتشين","kaj":"الجو","kam":"الكامبا","kaw":"الكوي","kbd":"الكاباردايان","kbd-cyrl":"Kabardian (Cyrillic script)","kbl":"كانمبو","kbp":"Kabiye","kcg":"التايابية","kde":"ماكونده","kea":"كابوفيرديانو","ken":"Kenyang","kfo":"الكورو","kg":"الكونغو","kgp":"Kaingang","kha":"الكازية","kho":"الخوتانيز","khq":"كويرا تشيني","khw":"Khowar","ki":"الكيكيو","kiu":"Kirmanjki","kj":"الكيونياما","kjh":"Khakas","kjp":"Eastern Pwo","kk":"الكازاخستانية","kk-arab":"Kazakh (Arabic script)","kk-cn":"Kazakh (China)","kk-cyrl":"Kazakh (Cyrillic script)","kk-kz":"Kazakh (Kazakhstan)","kk-latn":"Kazakh (Latin script)","kk-tr":"Kazakh (Turkey)",
"kkj":"لغة الكاكو","kl":"الكالاليست","kln":"كالينجين","km":"الخميرية","kmb":"الكيمبندو","kn":"الكانادا","knn":"Maharashtrian Konkani","ko":"الكورية","ko-kp":"Korean (North Korea)","koi":"كومي-بيرماياك","kok":"الكونكانية","kos":"الكوسراين","koy":"Koyukon","kpe":"الكبيل","kr":"الكانوري","krc":"الكاراتشاي-بالكار","kri":"Krio","krj":"Kinaray-a","krl":"الكاريلية","kru":"الكوروخ","ks":"الكشميرية","ks-arab":"Kashmiri (Arabic script)","ks-deva":"Kashmiri (Devanagari script)","ksb":"شامبالا","ksf":"لغة البافيا","ksh":"لغة الكولونيان","ku":"الكردية","ku-arab":"Kurdish (Arabic script)","ku-latn":"Kurdish (Latin script)","kum":"القموقية","kut":"الكتيناي","kv":"الكومي","kw":"الكورنية","ky":"القيرغيزية","la":"اللاتينية","lad":"اللادينو","lag":"لانجي","lah":
"اللاهندا","lam":"اللامبا","lb":"اللكسمبورغية","lbe":"Lak","lez":"الليزجية","lfn":"Lingua Franca Nova","lg":"الغاندا","li":"الليمبورغية","lij":"Ligurian","liv":"Livonian","lki":"Laki","lkt":"لاكوتا","lld":"Ladin","lmo":"Lombard","ln":"اللينجالا","lo":"اللاوية","lol":"منغولى","lou":"الكريولية اللويزيانية","loz":"اللوزي","lrc":"اللرية الشمالية","lt":"الليتوانية","ltg":"Latgalian","lu":"اللوبا كاتانغا","lua":"اللبا-لؤلؤ","lui":"اللوسينو","lun":"اللوندا","luo":"اللو","lus":"الميزو","luy":"لغة اللويا","luz":"Southern Luri","lv":"اللاتفية","lzh":"Literary Chinese","lzz":"Laz","mad":"المادريز","maf":"Mafa","mag":"الماجا","mai":"المايثيلي","mak":"الماكاسار","man":"الماندينغ","map-bms":"Basa Banyumasan","mas":"الماساي","mde":"مابا","mdf":
"الموكشا","mdr":"الماندار","men":"الميند","mer":"الميرو","mfe":"المورسيانية","mg":"الملغاشي","mga":"الأيرلندية الوسطى","mgh":"ماخاوا-ميتو","mgo":"ميتا","mh":"المارشالية","mhr":"Eastern Mari","mi":"الماورية","mic":"الميكماكيونية","mid":"Mandaic","min":"المينانجكاباو","mis":"Unsupported language","mk":"المقدونية","ml":"المالايالامية","mn":"المنغولية","mnc":"المانشو","mni":"المانيبورية","mnw":"Mon","mo":"Moldovan","moe":"Innu","moh":"الموهوك","mos":"الموسي","mr":"الماراثية","mrj":"Western Mari","ms":"الماليزية","mt":"المالطية","mua":"مندنج","mui":"Musi","mul":"لغات متعددة","mus":"الكريك","mwl":"الميرانديز","mwr":"الماروارية","mwv":"Mentawai","my":"البورمية","mye":"Myene","myv":"الأرزية","mzn":"المازندرانية","na":
"النورو","nah":"Nāhuatl","nan":"مين-نان الصينية","nap":"النابولية","naq":"لغة الناما","nb":"النرويجية بوكمال","nd":"النديبيل الشمالية","nds":"الألمانية السفلى","nds-nl":"السكسونية السفلى","ne":"النيبالية","new":"النوارية","ng":"الندونجا","nia":"النياس","niu":"النيوي","njo":"Ao Naga","nl":"الهولندية","nl-be":"الفلمنكية","nl-informal":"Nederlands (informeel)‎","nmg":"كواسيو","nn":"النرويجية نينورسك","nnh":"لغة النجيمبون","no":"النرويجية","nod":"Northern Thai","nog":"النوجاي","non":"النورس القديم","nov":"Novial","nqo":"أنكو","nr":"النديبيل الجنوبي","nrm":"Norman","nso":"السوتو الشمالية","nus":"النوير","nv":"النافاجو","nwc":"النوارية التقليدية","nxm":"Numidian","ny":"النيانجا","nym":"النيامويزي"
,"nyn":"النيانكول","nyo":"النيورو","nys":"Nyungar","nzi":"النزيما","oc":"الأوكسيتانية","oj":"الأوجيبوا","olo":"Livvi-Karelian","om":"الأورومية","ood":"O'odham","or":"الأورية","os":"الأوسيتيك","osa":"الأوساج","ota":"التركية العثمانية","otk":"Old Turkish","pa":"البنجابية","pag":"البانجاسينان","pal":"البهلوية","pam":"البامبانجا","pap":"البابيامينتو","pau":"البالوان","pcd":"Picard","pcm":"البدجنية النيجيرية","pdc":"Pennsylvania German","pdt":"Plautdietsch","peo":"الفارسية القديمة","pfl":"Palatine German","phn":"الفينيقية","pi":"البالية","pih":"Norfuk / Pitkern","pjt":"Pitjantjatjara","pl":"البولندية","pms":"Piedmontese","pnb":"Western Punjabi","pnt":"Pontic","pon":"البوهنبيايان","ppu":"Papora-Hoanya","prg":"البروسياوية","pro":
"البروفانسية القديمة","prs":"Dari","ps":"البشتو","pt":"البرتغالية","pt-br":"البرتغالية البرازيلية","pt-pt":"البرتغالية الأوروبية","pwn":"Paiwan","pyu":"Puyuma","qu":"الكويتشوا","quc":"الكيشية","qug":"Chimborazo Highland Quichua","qya":"Quenya","raj":"الراجاسثانية","rap":"الراباني","rar":"الراروتونجاني","rgn":"Romagnol","rif":"Riffian","rm":"الرومانشية","rmc":"Carpathian Romani","rmf":"Finnish Kalo","rmg":"Traveller Norwegian","rml":"Baltic Romani","rmn":"Balkan Romani","rmo":"Sinte Romani","rmw":"Welsh-Romani","rmy":"Vlax Romani","rn":"الرندي","ro":"الرومانية","ro-md":"المولدوفية","roa-rup":"Aromanian","roa-tara":"Tarantino","rof":"الرومبو","rom":"الغجرية","rtm":"Rotuman","ru":"الروسية","rue":"Rusyn","rug":"Roviana","rup":"الأرومانيان","ruq":"Megleno-Romanian","ruq-cyrl":
"Megleno-Romanian (Cyrillic script)","ruq-grek":"Megleno-Romanian (Greek script)","ruq-latn":"Megleno-Romanian (Latin script)","rw":"الكينيارواندا","rwk":"الروا","rwr":"Marwari (India)","sa":"السنسكريتية","sad":"السانداوي","sah":"الساخيّة","sam":"الآرامية السامرية","saq":"سامبورو","sas":"الساساك","sat":"السانتالية","saz":"Saurashtra","sba":"نامبي","sbp":"سانغو","sc":"السردينية","scn":"الصقلية","sco":"الأسكتلندية","sd":"السندية","sdc":"Sassarese Sardinian","sdh":"الكردية الجنوبية","se":"سامي الشمالية","see":"السنيكا","seh":"سينا","sei":"Seri","sel":"السيلكب","ses":"كويرابورو سيني","sg":"السانجو","sga":"الأيرلندية القديمة","sgs":"Samogitian","sh":"صربية-كرواتية","shi":"تشلحيت","shi-latn":"Tachelhit (Latin script)","shi-tfng":"Tachelhit (Tifinagh script)","shn":
"الشان","shu":"العربية التشادية","shy":"Shawiya","shy-arab":"Shawiya (Arabic script)","shy-latn":"Shawiya (Latin script)","shy-tfng":"Shawiya (Tifinagh script)","si":"السنهالية","sia":"Akkala Sámi","sid":"السيدامو","simple":"Simple English","sjd":"Kildin Sami","sje":"Pite Sami","sjk":"Kemi Sámi","sjn":"Sindarin","sjt":"Ter Sámi","sju":"Ume Sami","sk":"السلوفاكية","skr":"Saraiki","skr-arab":"Saraiki (Arabic script)","sl":"السلوفانية","sli":"Lower Silesian","sly":"Selayar","sm":"الساموائية","sma":"السامي الجنوبي","smj":"اللول سامي","smn":"الإيناري سامي","sms":"السكولت سامي","sn":"الشونا","snk":"السونينك","so":"الصومالية","sog":"السوجدين","sq":"الألبانية","sr":"الصربية","sr-ec":"Serbian (Cyrillic script)","sr-el":"Serbian (Latin script)","sr-me":"Montenegrin","srn":"السرانان تونجو","srq":"Sirionó","srr":"السرر"
,"ss":"السواتي","ssf":"Thao","ssy":"لغة الساهو","st":"السوتو الجنوبية","stq":"Saterland Frisian","sty":"cебертатар","su":"السوندانية","suk":"السوكوما","sus":"السوسو","sux":"السومارية","sv":"السويدية","sw":"السواحلية","sw-cd":"الكونغو السواحلية","swb":"القمرية","syc":"سريانية تقليدية","syr":"السريانية","szl":"Silesian","ta":"التاميلية","tay":"Tayal","tcy":"Tulu","te":"التيلوغوية","tem":"التيمن","teo":"تيسو","ter":"التيرينو","tet":"التيتم","tg":"الطاجيكية","tg-cyrl":"Tajik (Cyrillic script)","tg-latn":"Tajik (Latin script)","th":"التايلاندية","ti":"التغرينية","tig":"التيغرية","tiv":"التيف","tk":"التركمانية","tkl":"التوكيلاو","tkr":"Tsakhur","tl":"التاغالوغية","tlb":"Tobelo","tlh":"الكلينجون","tli":"التلينغيتية","tly":
"Talysh","tmh":"التاماشيك","tn":"التسوانية","to":"التونغية","tog":"تونجا - نياسا","tpi":"التوك بيسين","tr":"التركية","tru":"Turoyo","trv":"لغة التاروكو","ts":"السونجا","tsd":"Tsakonian","tsi":"التسيمشيان","tt":"التترية","tt-cyrl":"Tatar (Cyrillic script)","tt-latn":"Tatar (Latin script)","ttt":"Muslim Tat","tum":"التامبوكا","tvl":"التوفالو","tw":"التوي","twq":"تاساواق","ty":"التاهيتية","tyv":"التوفية","tzl":"Talossan","tzm":"الأمازيغية وسط الأطلس","udm":"الأدمرت","ug":"الأويغورية","ug-arab":"Uyghur (Arabic script)","ug-latn":"Uyghur (Latin script)","uga":"اليجاريتيك","uk":"الأوكرانية","umb":"الأمبندو","umu":"Munsee","und":"لغة غير معروفة","ur":"الأوردية","uun":"Pazeh","uz":"الأوزبكية","uz-cyrl":"Uzbek (Cyrillic script)","uz-latn":"Uzbek (Latin script)","vai":
"الفاي","ve":"الفيندا","vec":"Venetian","vep":"Veps","vi":"الفيتنامية","vls":"West Flemish","vmf":"Main-Franconian","vo":"لغة الفولابوك","vot":"الفوتيك","vro":"Võro","vun":"الفونجو","wa":"الولونية","wae":"الوالسر","wal":"الولاياتا","war":"الواراي","was":"الواشو","wbp":"وارلبيري","wo":"الولوفية","wuu":"الوو الصينية","xal":"الكالميك","xh":"الخوسا","xmf":"Mingrelian","xog":"السوغا","xpu":"Punic","xsy":"Saisiyat","yao":"الياو","yap":"اليابيز","yav":"يانجبن","ybb":"يمبا","ydd":"Eastern Yiddish","yi":"اليديشية","yo":"اليوروبا","yrl":"Nheengatu","yue":"الكَنْتُونية","za":"الزهيونج","zap":"الزابوتيك","zbl":"رموز المعايير الأساسية","zea":"Zeelandic","zen":"الزيناجا","zgh":"التمازيغية المغربية القياسية","zh":"الصينية","zh-classical":
"Classical Chinese","zh-cn":"Chinese (China)","zh-hans":"الصينية المبسطة","zh-hant":"الصينية التقليدية","zh-hk":"Chinese (Hong Kong)","zh-min-nan":"Chinese (Min Nan)","zh-mo":"Chinese (Macau)","zh-my":"Chinese (Malaysia)","zh-sg":"Chinese (Singapore)","zh-tw":"Chinese (Taiwan)","zh-yue":"Cantonese","zu":"الزولو","zun":"الزونية","zxx":"بدون محتوى لغوي","zza":"زازا"}}});mw.loader.implement("mw.Api@0vq94x5",function($,jQuery,require,module){(function(){var config=mw.config.get('wgTimedMediaHandler');mw.getJSON=function(){var callback,cbinx,timeoutCallback,requestTimeOutFlag,ranCallback,url=(typeof arguments[0]==='string')?arguments[0]:mw.getLocalApiUrl(),data=(typeof arguments[0]==='object')?arguments[0]:null;if(!data&&typeof arguments[1]==='object'){data=arguments[1];}callback=(typeof arguments[1]==='function')?arguments[1]:!1;cbinx=1;if(!callback&&(typeof arguments[2]==='function')){callback=arguments[2];cbinx=2;}timeoutCallback=(typeof arguments[cbinx+1]==='function')?arguments[cbinx+1]:!1;if(!url){mw.log('Error: no api url for api request');return;}if(!data.action){data.action='query';}if(!data.format){data.format='json';}requestTimeOutFlag=!1;ranCallback=!1;function myCallback(data){if(!requestTimeOutFlag){ranCallback=!0;callback(data);}}setTimeout(function(){if(!ranCallback){requestTimeOutFlag=!0;mw.log(
'Error:: request timed out: '+url);if(timeoutCallback){timeoutCallback();}}},30*1000);if(mw.checkRequestPost(data)||data._method==='post'){if(!mw.isLocalDomain(url)){ranCallback=!0;mw.loader.using('ApiProxy',function(){mw.ApiProxy.doRequest(url,data,callback,timeoutCallback);});}else{$.post(url,data,myCallback,'json');}return;}if(!mw.isLocalDomain(url)){if(url.indexOf('callback=')===-1||data.callback===-1){url+=(url.indexOf('?')===-1)?'?callback=?':'&callback=?';}}$.getJSON(url,data,myCallback);};mw.checkRequestPost=function(data){if(['login','purge','rollback','delete','undelete','protect','block','unblock','move','edit','upload','emailuser','import','userrights'].indexOf(data.action)!==-1){return true;}if(data.prop==='info'&&data.intoken){return true;}if(data.meta==='userinfo'){return true;}return false;};mw.isLocalDomain=function(url){if((url.indexOf('http://')!==0&&url.indexOf('//')!==0&&url.indexOf('https://')!==0)||new mw.Uri(document.URL).host===new mw.Uri(url).host){return true
;}return false;};mw.getApiProviderURL=function(providerId){if(config['MediaWiki.ApiProviders']&&config['MediaWiki.ApiProviders'][providerId]){return config['MediaWiki.ApiProviders'][providerId].url;}return mw.getLocalApiUrl();};mw.getLocalApiUrl=function(){if(typeof mw.config.get('wgServer')!=='undefined'&&typeof mw.config.get('wgScriptPath')!=='undefined'){return mw.config.get('wgServer')+mw.config.get('wgScriptPath')+'/api.php';}mw.log('Error trying to get local api url without ');return false;};}(window.mediaWiki,window.jQuery));});mw.loader.implement("mw.EmbedPlayer@16ciqv9",function($,jQuery,require,module){(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler');mw.processEmbedPlayers=function(playerSet,callback){var addedPlayersFlag,playerIdList=[];mw.log('processEmbedPlayers:: playerSet: ',playerSet);function areSelectedPlayersReady(){var playersLoaded=playerIdList.every(function(playerId){return $('#'+playerId)[0].playerReadyFlag;});if(playersLoaded){if(callback){callback();}}}function addPlayerElement(playerElement){var waitForMeta,ranPlayerSwapFlag;mw.log('EmbedPlayer:: addElement:: '+playerElement.id);if(playerElement.pause){playerElement.pause();}$(mw).trigger('EmbedPlayerWaitForMetaCheck',playerElement);waitForMeta=!1;if(playerElement.waitForMeta!==false){waitForMeta=waitForMetaCheck(playerElement);}ranPlayerSwapFlag=!1;function runPlayerSwap(){var playerInterface,inDomPlayer;if(ranPlayerSwapFlag){return;}ranPlayerSwapFlag=!0;mw.log('processEmbedPlayers::runPlayerSwap::'+$(
playerElement).attr('id'));playerInterface=new mw.EmbedPlayer(playerElement);inDomPlayer=swapEmbedPlayerElement(playerElement,playerInterface);if(playerElement.pause){playerElement.pause();}mw.log('processEmbedPlayers::trigger:: EmbedPlayerNewPlayer '+inDomPlayer.id);$(mw).trigger('EmbedPlayerNewPlayer',inDomPlayer);$(inDomPlayer).on('playerReady.swap',function(){$(inDomPlayer).off('playerReady.swap');areSelectedPlayersReady();});mw.log('EmbedPlayer::addPlayerElement :trigger startPlayerBuildOut:'+inDomPlayer.id);$(inDomPlayer).triggerQueueCallback('startPlayerBuildOut',function(){inDomPlayer.checkPlayerSources();});}if(waitForMeta&&config['EmbedPlayer.WaitForMeta']){mw.log('processEmbedPlayers::WaitForMeta ( video missing height ('+$(playerElement).attr('height')+'), width ('+$(playerElement).attr('width')+') or duration: '+$(playerElement).attr('duration'));$(playerElement).on('loadedmetadata',runPlayerSwap);setTimeout(runPlayerSwap,5000);return;}else{runPlayerSwap();return;}}
function waitForMetaCheck(playerElement){var waitForMeta=!1;if(!playerElement){return false;}if(!playerElement.tagName||(playerElement.tagName.toLowerCase()!=='audio'&&playerElement.tagName.toLowerCase()!=='video')){return false;}if(!mw.EmbedTypes.getMediaPlayers().isSupportedPlayer('oggNative')&&!mw.EmbedTypes.getMediaPlayers().isSupportedPlayer('mp3Native')&&!mw.EmbedTypes.getMediaPlayers().isSupportedPlayer('webmNative')&&!mw.EmbedTypes.getMediaPlayers().isSupportedPlayer('h264Native')&&!mw.EmbedTypes.getMediaPlayers().isSupportedPlayer('appleVdnPlayer')){return false;}if($(playerElement).css('width')==='300px'&&$(playerElement).css('height')==='150px'){waitForMeta=!0;}else{if($(playerElement).attr('duration')||$(playerElement).attr('durationHint')||$(playerElement).attr('data-durationhint')){return false;}else{waitForMeta=!0;}}if($(playerElement).attr('width')===-1||$(playerElement).attr('height')===-1){waitForMeta=!0;}if($(playerElement).attr('width')===0||$(playerElement
).attr('height')===0){waitForMeta=!0;}if(playerElement.height===150&&playerElement.width===300){waitForMeta=!0;}if(waitForMeta&&($(playerElement).attr('src')||$(playerElement).find('source[src]').length!==0)){return true;}else{return false;}}function swapEmbedPlayerElement(targetElement,playerInterface){var method,dataAttributes,$spinner,swapPlayerElement=document.createElement('div');mw.log('processEmbedPlayers::swapEmbedPlayerElement: '+targetElement.id);$(swapPlayerElement).addClass('mwEmbedPlayer');for(method in playerInterface){if(method!=='readyState'){swapPlayerElement[method]=playerInterface[method];}}swapPlayerElement.style.cssText=targetElement.style.cssText;swapPlayerElement.style.position='relative';dataAttributes=config['EmbedPlayer.DataAttributes'];if(dataAttributes){$.each(dataAttributes,function(attrName){if($(targetElement).data(attrName)){$(swapPlayerElement).data(attrName,$(targetElement).data(attrName));}});}if(playerInterface.isPersistentNativePlayer()||(
playerInterface.useNativePlayerControls()&&(targetElement.nodeName==='video'||targetElement.nodeName==='audio'))){$(targetElement).attr('id',playerInterface.pid).addClass('nativeEmbedPlayerPid').show().after($(swapPlayerElement).css('display','none'));}else{$(targetElement).replaceWith(swapPlayerElement);}if($('#loadingSpinner_'+playerInterface.id).length===0&&$.client.profile().name!=='firefox'){if(playerInterface.useNativePlayerControls()||playerInterface.isPersistentNativePlayer()){$spinner=$(targetElement).getAbsoluteOverlaySpinner();}else{$spinner=$(swapPlayerElement).getAbsoluteOverlaySpinner();}$spinner.attr('id','loadingSpinner_'+playerInterface.id);}return swapPlayerElement;}$(playerSet).each(function(index,playerElement){var posterSrc,width,height;if(!$(playerElement).attr('id')){$(playerElement).attr('id','mwe_vid'+(index));}playerIdList.push($(playerElement).attr('id'));if(playerElement.nodeName.toLowerCase()==='div'&&$(playerElement).attr('poster')){posterSrc=$(
playerElement).attr('poster');width=$(playerElement).width();height=$(playerElement).height();if(!width){width='100%';}if(!height){height='100%';}mw.log('EmbedPlayer:: set loading background: '+posterSrc);$(playerElement).append($('<img>').attr('src',posterSrc).css({position:'absolute',width:width,height:height}));}});addedPlayersFlag=!1;mw.log('processEmbedPlayers:: Do: '+$(playerSet).length+' players ');$(playerSet).each(function(index,playerElement){if($(playerElement).hasClass('nativeEmbedPlayerPid')){$('#loadingSpinner_'+$(playerElement).attr('id')).remove();mw.log('processEmbedPlayers::$.embedPlayer skip embedPlayer gennerated video: '+playerElement);}else{addedPlayersFlag=!0;addPlayerElement(playerElement);}});if(!addedPlayersFlag){if(callback){callback();}}};}());(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler');mw.mergeTMHConfig('EmbedPlayer.Attributes',{id:null,class:null,width:null,height:null,src:null,poster:null,autoplay:!1,loop:!1,
controls:!0,paused:!0,readyState:0,networkState:0,currentTime:0,previousTime:0,previousVolume:1,volume:0.75,preMuteVolume:0.75,duration:null,'data-durationhint':null,'data-disablecontrols':null,durationHint:null,muted:!1,videoAspect:'4:3',start:0,end:null,overlaycontrols:!0,usenativecontrols:!1,attributionbutton:!0,playerError:{},'data-blockPlayerDisplay':null,startOffset:0,downloadLink:!0,type:null});mw.mergeTMHConfig('EmbedPlayer.SourceAttributes',['id','src','title','label','URLTimeEncoding','startOffset','start','end','default','title','titleKey']);mw.EmbedPlayer=function(element){return this.init(element);};mw.EmbedPlayer.prototype={mediaElement:null,supports:{},playerReadyFlag:!1,loadError:!1,thumbnailUpdatingFlag:!1,stopped:!0,cmmlData:null,serverSeekTime:0,seeking:!1,bufferedPercent:0,monitorTimerId:null,bufferStartFlag:!1,bufferEndFlag:!1,pauseTime:null,donePlayingCount:0,_propagateEvents:!0,onDoneInterfaceFlag:!0,_checkHideSpinner:!1
,_playContorls:!0,displayPlayer:!0,widgetLoaded:!1,init:function(element){var attr,playerAttributes,self=this;mw.log('EmbedPlayer: initEmbedPlayer: '+$(element).width());playerAttributes=config['EmbedPlayer.Attributes'];this.rewriteElementTagName=element.tagName.toLowerCase();this.noPlayerFallbackHTML=$(element).html();for(attr in playerAttributes){if(element.getAttribute(attr)!==null){if(element.getAttribute(attr)===''){this[attr]=!0;}else{this[attr]=element.getAttribute(attr);}}else{this[attr]=playerAttributes[attr];}if(this[attr]==='false'){this[attr]=!1;}if(this[attr]==='true'){this[attr]=!0;}}if(this.useNativePlayerControls()){self.controls=!0;}if(!this.monitorRate){this.monitorRate=config['EmbedPlayer.MonitorRate'];}if(this.startOffset&&this.startOffset.split(':').length>=2){this.startOffset=parseFloat(mw.npt2seconds(this.startOffset));}this.startOffset=parseFloat(this.startOffset);if($(element).attr('duration')){self.duration=$(element).attr('duration');}if(self[
'data-durationhint']){self.durationHint=self['data-durationhint'];}if(self.durationHint&&!self.duration){self.duration=mw.npt2seconds(self.durationHint);}this.duration=parseFloat(this.duration);mw.log('EmbedPlayer::init:'+this.id+' duration is: '+this.duration);if(self['data-disablecontrols']){self.disablecontrols=self['data-disablecontrols'];}this.pid='pid_'+this.id;this.mediaElement=new mw.MediaElement(element);this.bindHelper('updateLayout',function(){self.updateLayout();});},bindHelper:function(name,callback){$(this).on(name,callback);return this;},unbindHelper:function(bindName){if(bindName){$(this).off(bindName);}return this;},triggerQueueCallback:function(name,callback){$(this).triggerQueueCallback(name,callback);},triggerHelper:function(name,obj){try{$(this).trigger(name,obj);}catch(e){}},stopEventPropagation:function(){mw.log('EmbedPlayer:: stopEventPropagation');this.stopMonitor();this._propagateEvents=!1;},restoreEventPropagation:function(){mw.log(
'EmbedPlayer:: restoreEventPropagation');this._propagateEvents=!0;this.startMonitor();},enablePlayControls:function(){mw.log('EmbedPlayer:: enablePlayControls');if(this.useNativePlayerControls()){return;}this._playContorls=!0;this.getInterface().find('.play-btn').buttonHover().css('cursor','pointer');this.controlBuilder.enableSeekBar();$(this).trigger('onEnableInterfaceComponents');},disablePlayControls:function(){if(this.useNativePlayerControls()){return;}this._playContorls=!1;this.getInterface().find('.play-btn').off('mouseenter mouseleave').css('cursor','default');this.controlBuilder.disableSeekBar();$(this).trigger('onDisableInterfaceComponents');},updateFeatureSupport:function(){$(this).trigger('updateFeatureSupportEvent',this.supports);},applyIntrinsicAspect:function(){var img,pHeight,pWidth,$this=$(this);if(this.getInterface().find('.playerPoster').length){img=this.getInterface().find('.playerPoster')[0];pHeight=$this.height();if(img.naturalWidth&&img.naturalHeight){
pWidth=Math.floor(img.naturalWidth/img.naturalHeight*pHeight);if(pWidth>$this.width()){pWidth=$this.width();pHeight=Math.floor(img.naturalHeight/img.naturalWidth*pWidth);}$(img).css({height:pHeight+'px',width:pWidth+'px',left:(($this.width()-pWidth)*0.5)+'px',top:(($this.height()-pHeight)*0.5)+'px',position:'absolute'});}}},loadPlayerSize:function(element){var $relativeParent,aspect,defaultSize;this.height=element.height>0?String(element.height):$(element).css('height');this.width=element.width>0?String(element.width):$(element).css('width');if(this.height==='32px'||this.height==='32px'){this.width='100%';this.height='100%';}mw.log('EmbedPlayer::loadPlayerSize: css size:'+this.width+' h: '+this.height);if(this.height.indexOf('100%')!==-1||this.width.indexOf('100%')!==-1){$relativeParent=$(element).parents().filter(function(){return $(this).is('body')||$(this).css('position')==='relative';}).slice(0,1);this.width=$relativeParent.width();this.height=$relativeParent.height();}this.height=
parseInt(this.height);this.width=parseInt(this.width);this.height=(this.height===0||isNaN(this.height)&&$(element).attr('height'))?parseInt($(element).attr('height')):this.height;this.width=(this.width===0||isNaN(this.width)&&$(element).attr('width'))?parseInt($(element).attr('width')):this.width;if(this.isAudio()&&this.height==='32'){this.height=20;}if(this.isAudio()&&this.videoAspect){aspect=this.videoAspect.split(':');if(this.height&&!this.width){this.width=parseInt(this.height*(aspect[0]/aspect[1]));}if(this.width&&!this.height){this.height=parseInt(this.width*(aspect[1]/aspect[0]));}}if((isNaN(this.height)||isNaN(this.width))||(this.height===-1||this.width===-1)||((this.height===150||this.height===64)&&this.width===300)){defaultSize=config['EmbedPlayer.DefaultSize'].split('x');if(isNaN(this.width)){this.width=defaultSize[0];}if(this.isAudio()){this.height=20;}else{this.height=defaultSize[1];}}},getPlayerWidth:function(){var profile=$.client.profile();if(profile.name==='firefox'&&
profile.versionNumber<2){return($(this).parent().parent().width());}return $(this).width();},getPlayerHeight:function(){return $(this).height();},checkPlayerSources:function(){var self=this;mw.log('EmbedPlayer::checkPlayerSources: '+this.id);$(self).trigger('preCheckPlayerSources');$(self).triggerQueueCallback('checkPlayerSourcesEvent',function(){self.setupSourcePlayer();});},getTextTracks:function(){if(!this.mediaElement){return[];}return this.mediaElement.getTextTracks();},emptySources:function(){if(this.mediaElement){this.mediaElement.sources=[];this.mediaElement.selectedSource=null;}this.prevPlayer=this.selectedPlayer;},switchPlaySource:function(source,switchCallback,doneCallback){var self=this,targetPlayer=mw.EmbedTypes.getMediaPlayers().defaultPlayer(source.mimeType);if(targetPlayer.library!==this.selectedPlayer.library){this.selectedPlayer=targetPlayer;this.updatePlaybackInterface(function(){self.playerSwitchSource(source,switchCallback,doneCallback);});}else{self.
playerSwitchSource(source,switchCallback,doneCallback);}},playerSwitchSource:function(){mw.log('Error player interface must support actual source switch');},setupSourcePlayer:function(){var self=this;mw.log('EmbedPlayer::setupSourcePlayer: '+this.id+' sources: '+this.mediaElement.sources.length);if(config['EmbedPlayer.ReplaceSources']){this.emptySources();config['EmbedPlayer.ReplaceSources'].forEach(function(source){self.mediaElement.tryAddSource(source);});}this.mediaElement.autoSelectSource();if(this.mediaElement.selectedSource){this.selectedPlayer=mw.EmbedTypes.getMediaPlayers().defaultPlayer(this.mediaElement.selectedSource.mimeType);if(this.selectedPlayer&&(!this.prevPlayer||this.prevPlayer.library!==this.selectedPlayer.library)){this.updatePlaybackInterface();return;}}if(!this.selectedPlayer||!this.mediaElement.selectedSource){this.showPlayerError();mw.log('EmbedPlayer:: setupSourcePlayer > player ready ( but with errors ) ');}else{$(this).trigger('layoutReady');this.getInterface
().find('.control-bar').show();this.addLargePlayBtn();}this.playerReadyFlag=!0;$(this).trigger('playerReady');this.triggerWidgetLoaded();},updatePlaybackInterface:function(callback){var tmpObj,i,self=this;mw.log('EmbedPlayer::updatePlaybackInterface: duration is: '+this.getDuration()+' playerId: '+this.id);if(this.instanceOf){$(this).data('previousInstanceOf',this.instanceOf);tmpObj=window['mw.EmbedPlayer'+this.instanceOf];for(i in tmpObj){if(typeof this['parent_'+i]!=='undefined'){this[i]=this['parent_'+i];}else{this[i]=null;}}}mw.log('EmbedPlayer::updatePlaybackInterface: embedding with '+this.selectedPlayer.library);this.selectedPlayer.load(function(){self.updateLoadedPlayerInterface(callback);});},updateLoadedPlayerInterface:function(callback){var playerInterface,method,self=this;mw.log('EmbedPlayer::updateLoadedPlayerInterface '+self.selectedPlayer.library+' player loaded for '+self.id);playerInterface=mw['EmbedPlayer'+self.selectedPlayer.library];if(playerInterface.init){
playerInterface.init();}for(method in playerInterface){if(typeof self[method]!=='undefined'&&!self['parent_'+method]){self['parent_'+method]=self[method];}self[method]=playerInterface[method];}self.updateFeatureSupport();self.getDuration();self.showPlayer();if(typeof callback==='function'){callback();}},selectPlayer:function(player){var self=this;mw.log('EmbedPlayer:: selectPlayer '+player.id);if(this.selectedPlayer.id!==player.id){this.selectedPlayer=player;this.updatePlaybackInterface(function(){self.getInterface().find('.track').remove();if(!self.useNativePlayerControls()&&self.controls&&self.controlBuilder.isOverlayControls()){self.controlBuilder.showControlBar();self.getInterface().hoverIntent({sensitivity:4,timeout:2000,over:function(){self.controlBuilder.showControlBar();},out:function(){self.controlBuilder.hideControlBar();}});}});}},getTimeRange:function(){var endTime=(this.controlBuilder.longTimeDisp)?'/'+mw.seconds2npt(this.getDuration()):'',defaultTimeRange='0:00'+endTime;
if(!this.mediaElement){return defaultTimeRange;}if(!this.mediaElement.selectedSource){return defaultTimeRange;}if(!this.mediaElement.selectedSource.endNpt){return defaultTimeRange;}return this.mediaElement.selectedSource.startNpt+this.mediaElement.selectedSource.endNpt;},getDuration:function(){if(isNaN(this.duration)&&this.mediaElement&&this.mediaElement.selectedSource&&typeof this.mediaElement.selectedSource.durationHint!=='undefined'){this.duration=this.mediaElement.selectedSource.durationHint;}return this.duration;},getHeight:function(){return this.getInterface().height();},getWidth:function(){return this.getInterface().width();},isAudio:function(){return this.rewriteElementTagName==='audio'||(this.mediaElement&&this.mediaElement.selectedSource&&this.mediaElement.selectedSource.mimeType.indexOf('audio/')!==-1);},embedPlayerHTML:function(){return'Error: function embedPlayerHTML should be implemented by embed player interface ';},seek:function(percent){var self=this;this.seeking=!0;
$(this).trigger('preSeek',percent);if(percent<0){percent=0;}if(percent>1){percent=1;}this.updatePlayHead(percent);if(this.supportsURLTimeEncoding()){mw.log('EmbedPlayer::seek:: updated serverSeekTime: '+mw.seconds2npt(this.serverSeekTime)+' currentTime: '+self.currentTime);if(self.currentTime===self.serverSeekTime){return;}this.stop();this.didSeekJump=!0;this.serverSeekTime=mw.npt2seconds(this.startNpt)+parseFloat(percent*this.getDuration());}this.controlBuilder.onSeek();},setCurrentTime:function(time,callback){mw.log('Error: EmbedPlayer, setCurrentTime not overriden');if(typeof callback==='function'){callback();}},triggeredEndDone:!1,postSequence:!1,onClipDone:function(){var self=this;if(!self._propagateEvents){return;}mw.log('EmbedPlayer::onClipDone: propagate:'+self._propagateEvents+' id:'+this.id+' doneCount:'+this.donePlayingCount+' stop state:'+this.isStopped());if(!this.isStopped()){this.stopped=!0;this.controlBuilder.showControlBar();if(!this.onDoneInterfaceFlag){this
.stopEventPropagation();}mw.log('EmbedPlayer:: trigger: ended ( inteface continue pre-check: '+this.onDoneInterfaceFlag+' )');$(this).trigger('ended');mw.log('EmbedPlayer::onClipDone:Trigged ended, continue? '+this.onDoneInterfaceFlag);if(!this.onDoneInterfaceFlag){this.restoreEventPropagation();return;}if(this.onDoneInterfaceFlag){mw.log('EmbedPlayer:: trigger: playbackComplete');$(this).trigger('playbackComplete');mw.log('EmbedPlayer:: trigger: postEnded');$(this).trigger('postEnded');}if(this.onDoneInterfaceFlag){mw.log('EmbedPlayer::onDoneInterfaceFlag=true do interface done');this.stopEventPropagation();self.donePlayingCount++;this.setCurrentTime(0.01,function(){self.stop();self.restoreEventPropagation();if(self.loop){self.stopped=!1;self.play();return;}else{self.pause();}if(config['EmbedPlayer.ForceLargeReplayButton']===true){self.addLargePlayBtn();}else{if($(self).data('hideEndPlayButton')||!self.useLargePlayBtn()){self.hideLargePlayBtn();}else{self.addLargePlayBtn();}}mw.log
('EmbedPlayer:: trigger: onEndedDone');if(!self.triggeredEndDone){self.triggeredEndDone=!0;$(self).trigger('onEndedDone',[self.id]);}});}}},showThumbnail:function(){mw.log('EmbedPlayer::showThumbnail::'+this.stopped);this.controlBuilder.closeMenuOverlay();this.updatePosterHTML();this.paused=!0;this.stopped=!0;if(!this.useNativePlayerControls()){mw.log('mediaLoaded');$(this).trigger('mediaLoaded');}},showPlayer:function(){var self=this;mw.log('EmbedPlayer:: showPlayer: '+this.id+' interface: w:'+this.width+' h:'+this.height);this.hideSpinnerAndPlayBtn();if(!this.useNativePlayerControls()&&this.isPersistentNativePlayer()){$(this).show();}if(this.controls){if(this.useNativePlayerControls()){if(this.getPlayerElement()){$(this.getPlayerElement()).attr('controls','true');}}else{this.controlBuilder.addControls();}}this.updatePosterHTML();this.updateTemporalUrl();if(this.displayPlayer===false){self.getVideoHolder().hide();self.getInterface().height(self.getComponentsHeight());self.
triggerHelper('updateLayout');}this.updateLayout();this.addLargePlayBtn();this.playerReadyFlag=!0;mw.log('EmbedPlayer:: Trigger: playerReady');$(this).trigger('playerReady');this.triggerWidgetLoaded();if(this['data-blockPlayerDisplay']){this.blockPlayerDisplay();return;}if(this.getError()){this.showErrorMsg(this.getError());return;}if(this.isStopped()&&this.autoplay&&!mw.isIOS()){mw.log('EmbedPlayer::showPlayer::Do autoPlay');self.play();}},getComponentsHeight:function(){var offset,height=0;this.getInterface().find('.block').each(function(){height+=$(this).outerHeight(true);});offset=mw.isIOS()?5:0;return height+offset;},updateLayout:function(){var windowHeight,newHeight,currentHeight;this.applyIntrinsicAspect();if(!config['EmbedPlayer.IsIframeServer']){return;}if(mw.isIOS()&&!this.controlBuilder.isInFullScreen()){windowHeight=$(window.parent.document.getElementById(this.id)).height();}else{windowHeight=window.innerHeight;}newHeight=windowHeight-this.getComponentsHeight();
currentHeight=this.getVideoHolder().height();if(currentHeight!==newHeight){mw.log('EmbedPlayer: updateLayout:: window: '+windowHeight+', components: '+this.getComponentsHeight()+', videoHolder old height: '+currentHeight+', new height: '+newHeight);this.getVideoHolder().height(newHeight);}},getInterface:function(){if(!this.$interface){this.controlBuilder=new mw.PlayerControlBuilder(this);this.$interface=$(this).wrap($('<div>').addClass('mwPlayerContainer '+this.class+' '+this.controlBuilder.playerClass).removeClass('kskin').append($('<div>').addClass('videoHolder'))).parent().parent();if(this.style.cssText){this.$interface[0].style.cssText=this.style.cssText;}this.style.cssText='';if(!this.useLargePlayBtn()){this.$interface.css('pointer-events','none');}}return this.$interface;},updateTemporalUrl:function(){var times,sourceHash=/[^#]+$/.exec(this.getSrc()).toString();if(sourceHash.indexOf('t=')===0){times=sourceHash.substr(2).split(',');if(times[0]){this.currentTime=mw.npt2seconds(
times[0].toString());}if(times[1]){this.pauseTime=mw.npt2seconds(times[1].toString());if(this.pauseTime<this.currentTime){this.pauseTime=null;}}this.updatePlayHead(this.currentTime/this.duration);this.controlBuilder.setStatus(mw.seconds2npt(this.currentTime));}},setError:function(errorObj){var self=this;if(typeof errorObj==='string'){this.playerError={title:self.getKalturaMsg('ks-GENERIC_ERROR_TITLE'),message:errorObj};return;}this.playerError=errorObj;},getError:function(){if(!$.isEmptyObject(this.playerError)){return this.playerError;}return null;},showErrorMsg:function(errorObj){var alertObj;this.hideSpinnerAndPlayBtn();if(this.controlBuilder){if(config['EmbedPlayer.ShowPlayerAlerts']){alertObj=$.extend(errorObj,{isModal:!0,keepOverlay:!0,noButtons:!0,isError:!0});this.controlBuilder.displayAlert(alertObj);}}return;},blockPlayerDisplay:function(){this.showErrorMsg();this.getInterface().find('.error').hide();},showPlayerError:function(){var $this=$(this);mw.log(
'EmbedPlayer::showPlayerError');this.hideSpinnerAndPlayBtn();$this.trigger('mediaLoadError');$this.trigger('mediaError');if(this['data-blockPlayerDisplay']){this.blockPlayerDisplay();return;}if(this.getError()){this.showErrorMsg(this.getError());return;}this.showNoInlinePlabackSupport();},showNoInlinePlabackSupport:function(){var downloadUrl,$pBtn,self=this;if(this.mediaElement.sources.length===0||!config['EmbedPlayer.NotPlayableDownloadLink']){return;}this.isLinkPlayer=!0;this.updatePosterHTML();this.addLargePlayBtn();downloadUrl=this.mediaElement.sources[0].getSrc();this.triggerHelper('directDownloadLink',function(dlUrl){if(dlUrl){downloadUrl=dlUrl;}});$pBtn=this.getInterface().find('.play-btn-large').attr('title',mw.msg('mwe-embedplayer-play_clip')).show().off('click').on('click',function(){self.triggerHelper('firstPlay',[self.id]);self.triggerHelper('playing');return true;});if(!$pBtn.parent('a').length){$pBtn.wrap($('<a>').attr('target','_blank'));}$pBtn.parent('a').attr('href',
downloadUrl);$(this).trigger('showInlineDownloadLink');},updateVideoTimeReq:function(timeRequest){var timeParts=timeRequest.split('/');mw.log('EmbedPlayer::updateVideoTimeReq:'+timeRequest);this.updateVideoTime(timeParts[0],timeParts[1]);},updateVideoTime:function(startNpt,endNpt){this.mediaElement.updateSourceTimes(startNpt,endNpt);this.controlBuilder.setStatus(startNpt+'/'+endNpt);this.updatePlayHead(0);if(this.supportsURLTimeEncoding()){this.serverSeekTime=0;}else{this.serverSeekTime=mw.npt2seconds(startNpt);}},updateThumbTimeNPT:function(time){this.updateThumbTime(mw.npt2seconds(time)-parseInt(this.startOffset));},updateThumbTime:function(floatSeconds){if(typeof this.orgThumSrc==='undefined'){this.orgThumSrc=this.poster;}if(this.orgThumSrc.indexOf('t=')!==-1){this.lastThumbUrl=mw.replaceUrlParams(this.orgThumSrc,{t:mw.seconds2npt(floatSeconds+parseInt(this.startOffset))});if(!this.thumbnailUpdatingFlag){this.updatePoster(this.lastThumbUrl,false);this.lastThumbUrl=null;}}},
updateThumbPerc:function(percent){return this.updateThumbTime((this.getDuration()*percent));},updatePosterSrc:function(posterSrc){if(!posterSrc){posterSrc='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkqAcAAIUAgUW0RjgAAAAASUVORK5CYII=';}this.poster=posterSrc;this.updatePosterHTML();this.applyIntrinsicAspect();},changeMedia:function(callback){var bindName,self=this,$this=$(this);mw.log('EmbedPlayer:: changeMedia ');this.emptySources();$this.trigger('onChangeMedia');this.firstPlay=!0;this.donePlayingCount=0;this.triggeredEndDone=!1;this.preSequence=!1;this.postSequence=!1;this.setCurrentTime(0.01);this.updatePlayHead(0);this.controlBuilder.setStatus(this.getTimeRange());this.pauseLoading();this.setError(null);this['data-blockPlayerDisplay']=null;$this.attr('data-blockPlayerDisplay','');this.getInterface().find('.error').remove();this.controlBuilder.closeAlert();this.controlBuilder.closeMenuOverlay();this.getInterface().find('.control-bar').
show();this.hideLargePlayBtn();bindName='playerReady.changeMedia';$this.off(bindName).on(bindName,function(){var source;mw.log('EmbedPlayer::changeMedia playerReady callback');self.hideSpinnerAndPlayBtn();if(self.getError()){self.showErrorMsg(self.getError());return;}if(self.controlBuilder){self.controlBuilder.showControlBar();}if(self.autoplay){self.hideLargePlayBtn();}else{self.addLargePlayBtn();}source=self.getSource();if((self.isPersistentNativePlayer()||self.useNativePlayerControls())&&source){self.switchPlaySource(source,function(){self.changeMediaStarted=!1;$this.trigger('onChangeMediaDone');if(self.autoplay){self.play();}else{self.pause();self.addLargePlayBtn();}if(callback){callback();}});return;}self.changeMediaStarted=!1;self.stop();if(self.autoplay){self.play();}else{self.addLargePlayBtn();}$this.trigger('onChangeMediaDone');if(callback){callback();}});$this.triggerQueueCallback('checkPlayerSourcesEvent',function(){self.setupSourcePlayer();});},isImagePlayScreen:
function(){return(this.useNativePlayerControls()&&!this.isLinkPlayer&&mw.isIphone()&&config['EmbedPlayer.iPhoneShowHTMLPlayScreen']);},triggerWidgetLoaded:function(){if(!this.widgetLoaded){this.widgetLoaded=!0;mw.log('EmbedPlayer:: Trigger: widgetLoaded');this.triggerHelper('widgetLoaded');}},updatePosterHTML:function(){var posterSrc,$vid,self=this,profile=$.client.profile();mw.log('EmbedPlayer:updatePosterHTML::'+this.id);if(this.isImagePlayScreen()){this.addPlayScreenWithNativeOffScreen();return;}posterSrc=(this.poster)?this.poster:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkqAcAAIUAgUW0RjgAAAAASUVORK5CYII=';if(this.isPersistentNativePlayer()){$vid=$('#'+this.pid).show();$vid.attr('poster',posterSrc);if(profile.name==='firefox'){$vid.hide();setTimeout(function(){$vid.show();},0);}}else{$('#'+this.pid).hide();$(this).html($('<img>').css({position:'absolute',top:0,left:0,right:0,bottom:0}).attr({src:posterSrc}).addClass('playerPoster').on('load'
,function(){self.applyIntrinsicAspect();})).show();}if(this.useLargePlayBtn()&&this.controlBuilder&&this.height>this.controlBuilder.getComponentHeight('playButtonLarge')){this.addLargePlayBtn();}},addPlayScreenWithNativeOffScreen:function(){mw.log('Error: EmbedPlayer, Must override \'addPlayScreenWithNativeOffScreen\' with player inteface');return;},useLargePlayBtn:function(){if(this.isPersistantPlayBtn()){return true;}return!this.useNativePlayerControls();},isPersistantPlayBtn:function(){return(mw.isIphone()&&config['EmbedPlayer.iPhoneShowHTMLPlayScreen']);},useNativePlayerControls:function(){if(this.usenativecontrols===true){return true;}if(config['EmbedPlayer.NativeControls']===true){return true;}if(config['EmbedPlayer.WebKitPlaysInline']===true&&mw.isIphone()){return false;}if(mw.isIpod()||mw.isIphone()){return true;}if(mw.isIpad()){if(config['EmbedPlayer.EnableIpadHTMLControls']===true){return false;}else{return true;}}return false;},isPersistentNativePlayer:function(){if(this.
isLinkPlayer){return false;}if($('#'+this.pid).length===0){return $('#'+this.id).hasClass('persistentNativePlayer');}return $('#'+this.pid).hasClass('persistentNativePlayer');},isTouchDevice:function(){return mw.isIpad()||mw.isMobileChrome();},hideLargePlayBtn:function(){if(this.getInterface()){this.getInterface().find('.play-btn-large').hide();}},addLargePlayBtn:function(){if(this.isPauseLoading){mw.log('EmbedPlayer:: addLargePlayBtn ( skip play button, during load )');return;}if(this.useNativePlayerControls()){this.getInterface().css('pointer-events','auto');}if(config['EmbedPlayer.WebKitPlaysInline']&&mw.isIphone()){return;}if(this.getInterface().find('.play-btn-large').length){this.getInterface().find('.play-btn-large').show();}else{this.getVideoHolder().append(this.controlBuilder.getComponent('playButtonLarge'));}},getVideoHolder:function(){return this.getInterface().find('.videoHolder');},getNativePlayerHtml:function(){return $('<div>').css('width',this.getWidth()).html(
'Error: Trying to get native html5 player without native support for codec');},applyMediaElementBindings:function(){mw.log('Warning applyMediaElementBindings should be implemented by player interface');return;},getSharingEmbedCode:function(){switch(config['EmbedPlayer.ShareEmbedMode']){case'iframe':return this.getShareIframeObject();case'videojs':return this.getShareEmbedVideoJs();}},getWikiEmbedCode:function(){if(this.apiTitleKey){return'[[File:'+this.apiTitleKey+']]';}else{return false;}},getShareIframeObject:function(){var iframeUrl=this.getIframeSourceUrl(),embedCode='&lt;iframe src=&quot;'+mw.html.escape(iframeUrl)+'&quot; ';embedCode+='width=&quot;'+this.getPlayerWidth()+'&quot; ';embedCode+='height=&quot;'+this.getPlayerHeight()+'&quot; ';embedCode+='frameborder=&quot;0&quot; ';embedCode+='webkitAllowFullScreen mozallowfullscreen allowFullScreen';embedCode+='&gt;&lt/iframe&gt;';return embedCode;},getIframeSourceUrl:function(){var params,i,source,iframeUrl=!1;this.
triggerHelper('getShareIframeSrc',[function(localIframeSrc){if(iframeUrl){mw.log('Error multiple modules binding getShareIframeSrc');}iframeUrl=localIframeSrc;},this.id]);if(iframeUrl){return iframeUrl;}iframeUrl=mw.getMwEmbedPath()+'mwEmbedFrame.php?';params={'src[]':[]};for(i=0;i<this.mediaElement.sources.length;i++){source=this.mediaElement.sources[i];if(source.src){params['src[]'].push(mw.absoluteUrl(source.src));}}if(this.poster){params.poster=this.poster;}if(this.duration){params.durationHint=parseFloat(this.duration);}iframeUrl+=$.param(params);return iframeUrl;},getShareEmbedVideoJs:function(){var i,source,embedtag=(this.isAudio())?'audio':'video',embedCode='&lt;script type=&quot;text/javascript&quot; '+'src=&quot;'+mw.html.escape(mw.absoluteUrl(mw.getMwEmbedSrc()))+'&quot;&gt;&lt;/script&gt'+'&lt;'+embedtag+' ';if(this.poster){embedCode+='poster=&quot;'+mw.html.escape(mw.absoluteUrl(this.poster))+'&quot; ';}embedCode+='class=&quot;kskin&quot; ';if(this.duration){embedCode+=
'durationHint=&quot;'+parseFloat(this.duration)+'&quot; ';}if(this.width||this.height){embedCode+='style=&quot;';embedCode+=(this.width)?'width:'+this.width+'px;':'';embedCode+=(this.height)?'height:'+this.height+'px;':'';embedCode+='&quot; ';}embedCode+='&gt;';for(i=0;i<this.mediaElement.sources.length;i++){source=this.mediaElement.sources[i];if(source.src){embedCode+='&lt;source src=&quot;'+mw.absoluteUrl(source.src)+'&quot; &gt;&lt;/source&gt;';}}embedCode+='&lt;/video&gt;';return embedCode;},firstPlay:!0,preSequence:!1,inPreSequence:!1,replayEventCount:0,play:function(){var self=this,$this=$(this);mw.log('EmbedPlayer:: play: '+this._propagateEvents+' poster: '+this.stopped);this.absoluteStartPlayTime=new Date().getTime();if(self.isStopped()&&(self.preSequence===false||(self.sequenceProxy&&self.sequenceProxy.isInSequence===false))){if(!self.selectedPlayer){self.showPlayerError();return false;}else{self.embedPlayerHTML();}}self.stopped=!1;if(!this.preSequence){this.
preSequence=!0;mw.log('EmbedPlayer:: trigger preSequence ');this.triggerHelper('preSequence');this.playInterfaceUpdate();if(self.sequenceProxy&&self.sequenceProxy.isInSequence){mw.log('EmbedPlayer:: isInSequence, do NOT play content');return false;}}if(this.firstPlay&&this._propagateEvents){this.firstPlay=!1;this.triggerHelper('firstPlay',[self.id]);}if(this.paused===true){this.paused=!1;mw.log('EmbedPlayer:: trigger play event::'+!this.paused+' events:'+this._propagateEvents);if(this._propagateEvents){this.triggerHelper('onplay');}}if(this.donePlayingCount>0&&!this.paused&&this._propagateEvents){this.replayEventCount++;this.triggeredEndDone=!1;if(this.replayEventCount<=this.donePlayingCount){mw.log('EmbedPlayer::play> trigger replayEvent');this.triggerHelper('replayEvent');}}if(this.currentTime<this.startTime){$this.on('playing.startTime',function(){$this.off('playing.startTime');if(!mw.isIOS()){self.setCurrentTime(self.startTime);self.startTime=0;}else{setTimeout(function(
){self.setCurrentTime(self.startTime,function(){self.play();});self.startTime=0;},500);}self.startTime=0;});}this.playInterfaceUpdate();if(self._playContorls){return true;}else{return false;}},playInterfaceUpdate:function(){var self=this;mw.log('EmbedPlayer:: playInterfaceUpdate');if(this.controlBuilder){this.controlBuilder.closeMenuOverlay();}this.getInterface().find('.error').remove();this.hideLargePlayBtn();this.getInterface().find('.play-btn span').removeClass('ui-icon-play').addClass('ui-icon-pause');this.hideSpinnerOncePlaying();this.getInterface().find('.play-btn').off('click').on('click',function(){if(self._playContorls){self.pause();}}).attr('title',mw.msg('mwe-embedplayer-pause_clip'));},pauseLoading:function(){this.pause();this.addPlayerSpinner();this.isPauseLoading=!0;},addPlayerSpinner:function(){var sId='loadingSpinner_'+this.id;$('#'+sId).remove();this.hideLargePlayBtn();$(this).show().getAbsoluteOverlaySpinner().attr('id',sId);},hideSpinner:function(){$(
'#loadingSpinner_'+this.id+',.loadingSpinner').remove();},hideSpinnerAndPlayBtn:function(){this.isPauseLoading=!1;this.hideSpinner();this.hideLargePlayBtn();},hideSpinnerOncePlaying:function(){this._checkHideSpinner=!0;},pause:function(){var self=this;if(this.paused===false){this.paused=!0;if(this._propagateEvents){mw.log('EmbedPlayer:trigger pause:'+this.paused);$(this).trigger('onpause');}}self.pauseInterfaceUpdate();},pauseInterfaceUpdate:function(){var self=this;mw.log('EmbedPlayer::pauseInterfaceUpdate');this.getInterface().find('.play-btn span').removeClass('ui-icon-pause').addClass('ui-icon-play');this.getInterface().find('.play-btn').off('click').on('click',function(){if(self._playContorls){self.play();}}).attr('title',mw.msg('mwe-embedplayer-play_clip'));},load:function(){mw.log('Waring:: the load method should be overided by player interface');},stop:function(){mw.log('EmbedPlayer::stop:'+this.id);this.stopped=!0;this.preSequence=!1;$(this).trigger('doStop');this.
didSeekJump=!1;this.currentTime=this.previousTime=this.serverSeekTime=0;this.stopMonitor();if(!this.paused){this.pause();}if(this.useLargePlayBtn()){this.addLargePlayBtn();this.pauseInterfaceUpdate();}if(!this.isPersistentNativePlayer()){this.showThumbnail();this.bufferedPercent=0;this.controlBuilder.setStatus(this.getTimeRange());}this.updatePlayHead(0);this.controlBuilder.setStatus(this.getTimeRange());this.bufferedPercent=0;this.updateBufferStatus();},toggleMute:function(){var percent;mw.log('EmbedPlayer::toggleMute> (old state:) '+this.muted);if(this.muted){this.muted=!1;percent=this.preMuteVolume;}else{this.muted=!0;this.preMuteVolume=this.volume;}this.setVolume(percent,true);this.setInterfaceVolume(percent);$(this).trigger('onToggleMute');},setVolume:function(percent,triggerChange){var self=this;if(isNaN(percent)){return;}this.previousVolume=this.volume;this.volume=percent;if(percent!==0){this.muted=!1;}this.setPlayerElementVolume(percent);if(triggerChange){$(self).
trigger('volumeChanged',percent);}},setInterfaceVolume:function(percent){if(this.supports.volumeControl&&this.getInterface().find('.volume-slider').length){this.getInterface().find('.volume-slider').slider('value',percent*100);}},setPlayerElementVolume:function(){mw.log('Error player does not support volume adjustment');},getPlayerElementVolume:function(){return this.volume;},getPlayerElementMuted:function(){return this.muted;},fullscreen:function(){this.controlBuilder.toggleFullscreen();},postEmbedActions:function(){return;},isPlaying:function(){if(this.stopped){return false;}else if(this.paused){return false;}else{return true;}},isStopped:function(){return this.stopped;},stopMonitor:function(){clearInterval(this.monitorInterval);this.monitorInterval=0;},startMonitor:function(){this.monitor();},monitor:function(){var self=this;self.syncCurrentTime();self.updatePlayheadStatus();self.syncVolume();self.syncMonitor();if(self._propagateEvents){$(self).trigger('monitorEvent',[self.id]);if(
self.progressEventData){$(self).trigger('progress',self.progressEventData);}}},syncMonitor:function(){var self=this;if(!this.isStopped()){if(!this.monitorInterval){this.monitorInterval=setInterval(function(){if(self.monitor){self.monitor();}},this.monitorRate);}}else{this.stopMonitor();}},syncVolume:function(){var self=this;if(Math.round(self.volume*100)!==Math.round(self.previousVolume*100)){self.setInterfaceVolume(self.volume);}self.previousVolume=self.volume;if(!this.getPlayerElement()){return;}self.volume=this.getPlayerElementVolume();if(self.muted!==self.getPlayerElementMuted()&&!self.isStopped()){mw.log('EmbedPlayer::syncVolume: muted does not mach embed player');self.toggleMute();self.muted=self.getPlayerElementMuted();}},syncCurrentTime:function(){var seekPercent,self=this;if(self._checkHideSpinner&&self.currentTime!==self.getPlayerElementTime()){self._checkHideSpinner=!1;self.hideSpinnerAndPlayBtn();if(self.isPersistantPlayBtn()){self.addLargePlayBtn();}else{self.
hideLargePlayBtn();}}if(parseInt(self.previousTime)!==parseInt(self.currentTime)&&!this.userSlide&&!this.seeking&&!this.isStopped()){if(self.getDuration()&&self.currentTime<=self.getDuration()){seekPercent=self.currentTime/self.getDuration();mw.log('EmbedPlayer::syncCurrentTime::'+self.previousTime+' !== '+self.currentTime+' javascript based currentTime update to '+seekPercent+' === '+self.currentTime);self.previousTime=self.currentTime;this.seek(seekPercent);}}self.currentTime=self.getPlayerElementTime();if(self.serverSeekTime&&self.supportsURLTimeEncoding()){self.currentTime=parseInt(self.serverSeekTime)+parseInt(self.getPlayerElementTime());}self.previousTime=self.currentTime;if(self.pauseTime&&self.currentTime>self.pauseTime){self.pause();self.pauseTime=null;}},updatePlayheadStatus:function(){var et,ct,endPresentationTime;if(this.currentTime>=0&&this.duration){if(!this.userSlide&&!this.seeking){if(parseInt(this.startOffset)!==0){this.updatePlayHead((this.currentTime-this.
startOffset)/this.duration);et=(this.controlBuilder.longTimeDisp)?'/'+mw.seconds2npt(parseFloat(this.startOffset)+parseFloat(this.duration)):'';this.controlBuilder.setStatus(mw.seconds2npt(this.currentTime)+et);}else{ct=(this.getPlayerElement())?this.getPlayerElement().currentTime||this.currentTime:this.currentTime;this.updatePlayHead(ct/this.duration);et=(this.controlBuilder.longTimeDisp)?'/'+mw.seconds2npt(this.duration):'';this.controlBuilder.setStatus(mw.seconds2npt(this.currentTime)+et);}}endPresentationTime=(this.startOffset)?(this.startOffset+this.duration):this.duration;if(this.currentTime>=endPresentationTime&&!this.isStopped()){mw.log('EmbedPlayer::updatePlayheadStatus > should run clip done :: '+this.currentTime+' > '+endPresentationTime);this.onClipDone();}}else{if(this.isStopped()){this.controlBuilder.setStatus(this.getTimeRange());}else if(this.paused){this.controlBuilder.setStatus(mw.msg('mwe-embedplayer-paused'));}else if(this.isPlaying()){if(this.currentTime&&!this.
duration){this.controlBuilder.setStatus(mw.seconds2npt(this.currentTime)+' /');}else{this.controlBuilder.setStatus(' - - - ');}}else{this.controlBuilder.setStatus(this.getTimeRange());}}},getPlayerElementTime:function(){mw.log('Error: getPlayerElementTime should be implemented by embed library');},getPlayerElement:function(){mw.log('Error: getPlayerElement should be implemented by embed library, or you may be calling this event too soon');},updateBufferStatus:function(){var $buffer=this.getInterface().find('.mw_buffer');if(this.bufferedPercent!==0){if(this.bufferedPercent>1){this.bufferedPercent=1;}$buffer.css({width:(this.bufferedPercent*100)+'%'});$(this).trigger('updateBufferPercent',this.bufferedPercent);}else{$buffer.css('width','0px');}if(this.bufferedPercent>0&&!this.bufferStartFlag){this.bufferStartFlag=!0;mw.log('EmbedPlayer::bufferStart');$(this).trigger('bufferStartEvent');}if(this.bufferedPercent===1&&!this.bufferEndFlag){this.bufferEndFlag=!0;$(this).trigger(
'bufferEndEvent');}},updatePlayHead:function(perc){var $playHead,val;if(this.getInterface()){$playHead=this.getInterface().find('.play_head');if(!this.useNativePlayerControls()&&$playHead.length!==0&&$.contains(document,$playHead[0])){val=Math.round(perc*1000);$playHead.slider('value',val);}}$(this).trigger('updatePlayHeadPercent',perc);},getSrc:function(serverSeekTime){if(serverSeekTime){this.serverSeekTime=serverSeekTime;}if(this.currentTime&&!this.serverSeekTime){this.serverSeekTime=this.currentTime;}if(!this.mediaElement){return false;}if(!this.mediaElement.selectedSource){this.mediaElement.autoSelectSource();}if(this.mediaElement.selectedSource){if(this.supportsURLTimeEncoding()){return this.mediaElement.selectedSource.getSrc(this.serverSeekTime);}else{return this.mediaElement.selectedSource.getSrc();}}return false;},getSource:function(){this.mediaElement.autoSelectSource();return this.mediaElement.selectedSource;},getCompatibleSource:function(videoFiles){var myMediaElement,source
,$media=$('<video>');videoFiles.forEach(function(source){$media.append($('<source>').attr({src:source.src,type:source.type}));mw.log('EmbedPlayer::getCompatibleSource: add '+source.src+' of type:'+source.type);});myMediaElement=new mw.MediaElement($media[0]);source=myMediaElement.autoSelectSource();if(source){mw.log('EmbedPlayer::getCompatibleSource: '+source.getSrc());return source;}mw.log('Error:: could not find compatible source');return false;},supportsURLTimeEncoding:function(){var timeUrls=config['EmbedPlayer.EnableURLTimeEncoding'];if(timeUrls==='none'){return false;}else if(timeUrls==='always'){return this.mediaElement.selectedSource.URLTimeEncoding;}else if(timeUrls==='flash'){if(this.mediaElement.selectedSource&&this.mediaElement.selectedSource.URLTimeEncoding){return(this.instanceOf==='Kplayer');}}else{mw.log('Error:: invalid config value for EmbedPlayer.EnableURLTimeEncoding:: '+config['EmbedPlayer.EnableURLTimeEncoding']);}return false;}};}());(function(){'use strict';var
config=mw.config.get('wgTimedMediaHandler');mw.PlayerControlBuilder=function(embedPlayer,options){return this.init(embedPlayer,options);};mw.PlayerControlBuilder.prototype={playerClass:'mv-player',longTimeDisp:!0,volumeLayout:'vertical',height:config['EmbedPlayer.ControlsHeight'],supportedComponents:{options:!0},supportedMenuItems:{playerSelect:!0,download:!0,share:!0,aboutPlayerLibrary:!0},inFullScreen:!1,addWarningFlag:!1,displayOptionsMenuFlag:!1,hideControlBarCallback:!1,controlsDisabled:!1,bindPostfix:'.controlBuilder',init:function(embedPlayer){var self=this;this.embedPlayer=embedPlayer;if(mw.PlayerSkinKskin){self=$.extend(true,{},this,mw.PlayerSkinKskin);}if(self.embedPlayer.mediaElement.getPlayableSources().length<=1&&self.supportedMenuItems.playerSelect){delete self.supportedMenuItems.playerSelect;}return self;},getHeight:function(){return this.height;},addControls:function(){var $controlBar,self=this,embedPlayer=this.embedPlayer,profile=$.client.
profile();embedPlayer.getInterface().find('.control-bar,.overlay-win').remove();self.displayOptionsMenuFlag=!1;$controlBar=$('<div>').addClass('ui-state-default ui-widget-header ui-helper-clearfix control-bar').css('height',this.height);if(self.isOverlayControls()){$controlBar.hide();}else{$controlBar.addClass('block');}if(embedPlayer.isAudio()&&embedPlayer.getInterface().height()===0){embedPlayer.getInterface().css({height:this.height});}embedPlayer.getInterface().append($controlBar);if(profile.name==='firefox'&&profile.versionNumber<2){embedPlayer.triggerHelper('resizeIframeContainer',[{height:embedPlayer.height+$controlBar.height()-1}]);}this.addControlComponents();this.addControlBindings();},addControlComponents:function(){var source,components,largestPos,componentId,self=this,embedPlayer=this.embedPlayer,$controlBar=embedPlayer.getInterface().find('.control-bar');this.availableWidth=embedPlayer.getPlayerWidth();mw.log('PlayerControlsBuilder:: addControlComponents into:'+this.
availableWidth);this.supportedComponents=$.extend(this.supportedComponents,embedPlayer.supports);if(embedPlayer.attributionbutton){this.supportedComponents.attributionButton=!0;}if(config['EmbedPlayer.EnableFullscreen']===false){this.supportedComponents.fullscreen=!1;}if(config['EmbedPlayer.EnableOptionsMenu']===false){this.supportedComponents.options=!1;}if(config['EmbedPlayer.EnableVolumeControl']===false){this.supportedComponents.volumeControl=!1;}if(embedPlayer.mediaElement.getPlayableSources().length===1){this.supportedComponents.sourceSwitch=!1;}source=embedPlayer.mediaElement.getPlayableSources()[0];if(!embedPlayer.disablecontrols&&source){embedPlayer.disablecontrols=source.disablecontrols;}if(embedPlayer.disablecontrols){embedPlayer.disablecontrols.split(',').forEach(function(key){mw.log('PlayerControlBuilder:: disabled component via flag:'+key);self.supportedComponents[key]=!1;});}$(embedPlayer).trigger('addControlBarComponent',this);components=[];largestPos=0
;function addComponent(componentId){var position;if(self.supportedComponents[componentId]){if(self.availableWidth>=self.components[componentId].w){self.availableWidth-=self.components[componentId].w;position=self.components[componentId].position?self.components[componentId].position:largestPos+1;if(position>largestPos){largestPos=position;}components.push({id:componentId,position:position});}else{mw.log('PlayerControlBuilder:: Not enough space for control component:'+componentId);}}}function addComponents(){var i;components.sort(function(a,b){return b.position-a.position;});for(i=0;i<components.length;i++){$controlBar.append(self.getComponent(components[i].id));}}for(componentId in this.components){if(this.components[componentId]===false){continue;}if(componentId==='playHead'){continue;}if(componentId==='timeDisplay'&&!config['EmbedPlayer.EnableTimeDisplay']){continue;}if(componentId==='fullscreen'&&this.embedPlayer.isAudio()){continue;}if(componentId==='sourceSwitch'&&this.
availableWidth<320){continue;}addComponent(componentId);}if(this.availableWidth>30){addComponent('playHead');}addComponents();$(embedPlayer).trigger('controlBarBuildDone');},getAspectPlayerWindowCss:function(windowSize){var targetWidth,targetHeight,offsetTop,offsetLeft,self=this;if(!windowSize){windowSize={width:$(window).width(),height:$(window).height()};}windowSize.width=parseInt(windowSize.width);windowSize.height=parseInt(windowSize.height);if(!self.isOverlayControls()){windowSize.height=windowSize.height-this.height;}targetWidth=windowSize.width;targetHeight=targetWidth*(1/self.getIntrinsicAspect());if(targetHeight>windowSize.height){targetHeight=windowSize.height;targetWidth=parseInt(targetHeight*self.getIntrinsicAspect());}offsetTop=0;offsetTop+=(targetHeight<windowSize.height)?(windowSize.height-targetHeight)/2:0;offsetLeft=(targetWidth<windowSize.width)?parseInt(windowSize.width-targetWidth)/2:0;mw.log('PlayerControlBuilder::getAspectPlayerWindowCss: h:'+targetHeight+' w:'+
targetWidth+' t:'+offsetTop+' l:'+offsetLeft);return{position:'absolute',height:parseInt(targetHeight),width:parseInt(targetWidth),top:parseInt(offsetTop),left:parseInt(offsetLeft)};},getIntrinsicAspect:function(){var ss,img,vid=this.embedPlayer.getPlayerElement();if(vid&&vid.videoWidth&&vid.videoHeight){return vid.videoWidth/vid.videoHeight;}if(this.embedPlayer.mediaElement&&this.embedPlayer.mediaElement.selectedSource){ss=this.embedPlayer.mediaElement.selectedSource;if(ss.aspect){return ss.aspect;}if(ss.width&&ss.height){return ss.width/ss.height;}}img=this.embedPlayer.getInterface().find('.playerPoster')[0];if(img&&img.naturalWidth&&img.naturalHeight){return img.naturalWidth/img.naturalHeight;}return this.embedPlayer.getWidth()/this.embedPlayer.getHeight();},getPlayButtonPosition:function(){return{left:'50%',top:'50%','margin-left':-0.5*this.getComponentWidth('playButtonLarge'),'margin-top':-0.5*this.getComponentHeight('playButtonLarge')};},isInFullScreen:function(){return this.
inFullScreen;},toggleFullscreen:function(){if(this.isInFullScreen()){this.restoreWindowPlayer();}else{this.doFullScreenPlayer();}return false;},doFullScreenPlayer:function(){var doc,context,embedPlayer,$interface,fullscreenHeight,fsTarget,vid,self=this,profile=$.client.profile();mw.log('PlayerControlBuilder:: doFullScreenPlayer');function escapeFullscreen(){if(!window.fullScreenApi.isFullScreen(window.document)){self.restoreWindowPlayer();}}doc=window.document;context=window;this.verticalScrollPosition=doc.all?doc.scrollTop:context.pageYOffset;embedPlayer=this.embedPlayer;$interface=embedPlayer.getInterface();if(this.isInFullScreen()===true){return;}this.inFullScreen=!0;$interface.addClass('fullscreen');if(self.isOverlayControls()&&!embedPlayer.isTouchDevice()){self.addFullscreenMouseMoveHideShowControls();}$(embedPlayer).trigger('fullScreenStoreVerticalScroll');if(window.fullScreenApi.supportsFullScreen){self.preFullscreenPlayerSize=this.getPlayerSize();fullscreenHeight=null;
fsTarget=this.getFsTarget();fsTarget.removeEventListener(fullScreenApi.fullScreenEventName,escapeFullscreen);fsTarget.addEventListener(fullScreenApi.fullScreenEventName,escapeFullscreen);window.fullScreenApi.requestFullScreen(fsTarget);if(profile.name==='firefox'){self.fullscreenRestoreCheck=setInterval(function(){if(fullscreenHeight&&$(window).height()<fullscreenHeight){clearInterval(self.fullscreenRestoreCheck);self.restoreWindowPlayer();}if(!fullscreenHeight&&self.preFullscreenPlayerSize.height!==$(window).height()){fullscreenHeight=$(window).height();}},250);}}else{vid=this.embedPlayer.getPlayerElement();if(config['EmbedPlayer.EnableIpadNativeFullscreen']&&vid&&vid.webkitSupportsFullscreen){this.doHybridNativeFullscreen();return;}else{this.doContextTargetFullscreen();}}$(window).on('keyup',function(event){if(event.keyCode===27){self.restoreWindowPlayer();}});$(embedPlayer).trigger('onOpenFullScreen');setTimeout(function(){self.addControls();},100);},doContextTargetFullscreen:
function(){var playerCssPosition,self=this,doc=window.document,$doc=$(doc),$target=$(this.getFsTarget()),context=window;this.parentsAbsoluteList=[];this.parentsRelativeList=[];this.orginalParnetViewPortContent=$doc.find('meta[name="viewport"]').attr('content');this.orginalTargetElementLayout={style:$target[0].style.cssText,width:$target.width(),height:$target.height()};mw.log('PlayerControls:: doParentIframeFullscreen> verticalScrollPosition:'+this.verticalScrollPosition);context.scroll(0,0);if(!$doc.find('meta[name="viewport"]').length){$doc.find('head').append($('<meta>').attr('name','viewport'));}$doc.find('meta[name="viewport"]').attr('content','initial-scale=1, maximum-scale=1, minimum-scale=1');playerCssPosition=(mw.isIOS())?'absolute':'fixed';$target.parents().each(function(){var $parent=$(this);if($parent.css('position')==='absolute'){self.parentsAbsoluteList.push($parent);$parent.css('position','static');}if($parent.css('position')==='relative'){self.parentsRelativeList.push(
$parent);$parent.css('position','static');}});$target.css({'z-index':config['EmbedPlayer.FullScreenZIndex'],position:playerCssPosition,top:'0px',left:'0px',margin:0}).data('isFullscreen',true);function updateTargetSize(){context.scroll(0,0);$target.css({width:context.innerWidth,height:context.innerHeight});self.embedPlayer.applyIntrinsicAspect();}updateTargetSize();$(context).on('orientationchange',function(){if(self.isInFullScreen()){updateTargetSize();}});document.ontouchmove=function(e){if(self.isInFullScreen()){e.preventDefault();}};},restoreContextPlayer:function(){var self=this,doc=window.document,$doc=$(doc),$target=$(this.getFsTarget());mw.log('PlayerControlsBuilder:: restoreContextPlayer> verticalScrollPosition:'+this.verticalScrollPosition);if(this.orginalParnetViewPortContent){$doc.find('meta[name="viewport"]').attr('content',this.orginalParnetViewPortContent);}else{$doc.find('meta[name="viewport"]').attr('content','initial-scale=1, maximum-scale=8, minimum-scale=1');}if(
this.orginalTargetElementLayout){$target[0].style.cssText=this.orginalTargetElementLayout.style;$target.attr({width:this.orginalTargetElementLayout.width,height:this.orginalTargetElementLayout.height});self.embedPlayer.applyIntrinsicAspect();}$doc.find(self.parentsAbsoluteList).each(function(){$(this).css('position','absolute');});$doc.find(self.parentsRelativeList).each(function(){$(this).css('position','relative');});},doHybridNativeFullscreen:function(){var vid=this.embedPlayer.getPlayerElement(),self=this;vid.webkitEnterFullscreen();this.fsIntervalID=setInterval(function(){var currentFS=vid.webkitDisplayingFullscreen;if(self.isInFullScreen()&&!currentFS){self.inFullScreen=!1;$(self.embedPlayer).trigger('onCloseFullScreen');clearInterval(self.fsIntervalID);}},250);},getWindowSize:function(){return{width:$(window).width(),height:$(window).height()};},doDomFullscreen:function(){var self=this,embedPlayer=this.embedPlayer,$interface=embedPlayer.getInterface();$(
'.mw-fullscreen-overlay').remove();self.preFullscreenPlayerSize=this.getPlayerSize();$interface.after($('<div>').addClass('mw-fullscreen-overlay').css('z-index',config['EmbedPlayer.FullScreenZIndex']).hide().fadeIn('slow'));if(!this.windowPositionStyle){this.windowPositionStyle=$interface.css('position');}if(!this.windowZindex){this.windowZindex=$interface.css('z-index');}this.windowOffset=this.getWindowOffset();$interface.css({position:'fixed','z-index':config['EmbedPlayer.FullScreenZIndex']+1,top:this.windowOffset.top,left:this.windowOffset.left});if(embedPlayer.isPersistentNativePlayer()){$(embedPlayer.getPlayerElement()).css({'z-index':config['EmbedPlayer.FullScreenZIndex']+1,position:'absolute'});}self.parentsAbsolute=[];$(document.body).css('overflow','hidden');$interface.css('overlow','hidden');$interface.parents().each(function(){if($(this).css('position')==='absolute'){self.parentsAbsolute.push($(this));$(this).css('position',null);mw.log(
'PlayerControlBuilder:: should update position: '+$(this).css('position'));}});$(window).on('keyup',function(event){if(event.keyCode===27){self.restoreWindowPlayer();}});},addFullscreenMouseMoveHideShowControls:function(){var self=this;self.mouseMovedFlag=!1;self.embedPlayer.getInterface().mousemove(function(){self.mouseMovedFlag=!0;});function checkMovedMouse(){if(self.isInFullScreen()){if(self.mouseMovedFlag){self.mouseMovedFlag=!1;self.showControlBar();setTimeout(checkMovedMouse,3000);}else{self.hideControlBar();setTimeout(checkMovedMouse,250);}return;}}self.showControlBar();checkMovedMouse();},getWindowOffset:function(){var windowOffset=this.embedPlayer.getInterface().offset();windowOffset.top=windowOffset.top-$(document).scrollTop();windowOffset.left=windowOffset.left-$(document).scrollLeft();this.windowOffset=windowOffset;return this.windowOffset;},displayFullscreenTip:function(){var toolTipMsg,$targetTip;if(mw.isMobileDevice()){return;}if($.client.profile().name===
'safari'){return;}toolTipMsg=(navigator.userAgent.indexOf('Mac OS X')!==-1)?mw.msg('mwe-embedplayer-fullscreen-tip-osx'):mw.msg('mwe-embedplayer-fullscreen-tip');$targetTip=this.addWarningBinding('EmbedPlayer.FullscreenTip',$('<h3/>').html(toolTipMsg));$targetTip.show();function hideTip(){config['EmbedPlayer.FullscreenTip']=!1;$targetTip.fadeOut('fast');}$(this.embedPlayer).on('onCloseFullScreen',hideTip);setTimeout(hideTip,5000);$(document).on('keyup',function(event){if(event.keyCode===122){hideTip();}return true;});},getPlayerSize:function(){var height=$(window).height()-this.getHeight();if(config['EmbedPlayer.IsIframeServer']){return{height:height,width:$(window).width()};}else{return{height:this.embedPlayer.getInterface().height(),width:this.embedPlayer.getInterface().width()};}},getFsTarget:function(){var $interface=this.embedPlayer.getInterface();return $interface[0];},restoreWindowPlayer:function(){var fsTarget,self=this,embedPlayer=this.embedPlayer;mw.log(
'PlayerControlBuilder :: restoreWindowPlayer');if(this.isInFullScreen()===false){return;}this.inFullScreen=!1;embedPlayer.getInterface().removeClass('fullscreen');if(window.fullScreenApi.supportsFullScreen){fsTarget=this.getFsTarget();window.fullScreenApi.cancelFullScreen(fsTarget);}this.restoreContextPlayer();$(document).off('touchend.fullscreen');$(embedPlayer).trigger('onCloseFullScreen');setTimeout(function(){window.scroll(0,self.verticalScrollPosition);},100);setTimeout(function(){self.addControls();},100);},restoreDomPlayer:function(){var topPos,self=this,embedPlayer=this.embedPlayer,$interface=embedPlayer.$interface,interfaceHeight=(self.isOverlayControls())?embedPlayer.getHeight():embedPlayer.getHeight()+self.getHeight();mw.log('restoreWindowPlayer:: h:'+interfaceHeight+' w:'+embedPlayer.getWidth());$('.mw-fullscreen-overlay').remove('slow');mw.log('restore embedPlayer:: '+embedPlayer.getWidth()+' h: '+embedPlayer.getHeight());embedPlayer.getInterface().css({width:self.
preFullscreenPlayerSize.width,height:self.preFullscreenPlayerSize.height});topPos={position:self.windowPositionStyle,'z-index':self.windowZindex,overlow:'visible',top:'0px',left:'0px'};$([$interface,$interface.find('.playerPoster'),embedPlayer]).css(topPos);if(embedPlayer.getPlayerElement()){$(embedPlayer.getPlayerElement()).css(topPos);}$(document.body).css('overflow','auto');if(embedPlayer.isPersistentNativePlayer()){$(embedPlayer.getPlayerElement()).css({'z-index':'auto'});}},getOverlayWidth:function(){return(this.embedPlayer.getPlayerWidth()<300)?300:this.embedPlayer.getPlayerWidth();},getOverlayHeight:function(){return(this.embedPlayer.getPlayerHeight()<200)?200:this.embedPlayer.getPlayerHeight();},addControlBindings:function(){var hoverIntentConfig,embedPlayer=this.embedPlayer,self=this,$interface=embedPlayer.getInterface(),profile=$.client.profile();self.onControlBar=!1;$(embedPlayer).off(this.bindPostfix);self.addRightClickBinding();self.addPlayerClickBindings();$(
embedPlayer).on('onplay'+this.bindPostfix,function(){embedPlayer.controlBuilder.addRightClickBinding();});$(embedPlayer).on('timeupdate'+this.bindPostfix,function(){embedPlayer.updatePlayheadStatus();});$(embedPlayer).on('progress'+this.bindPostfix,function(event,jEvent,id){var embedPlayer=$('#'+id)[0];embedPlayer.updateBufferStatus();});$(embedPlayer).on('onEnableInterfaceComponents'+this.bindPostfix,function(){embedPlayer.controlBuilder.controlsDisabled=!1;embedPlayer.controlBuilder.addPlayerClickBindings();});$(embedPlayer).on('onDisableInterfaceComponents'+this.bindPostfix,function(){embedPlayer.controlBuilder.controlsDisabled=!0;embedPlayer.controlBuilder.removePlayerClickBindings();});function bindSpaceUp(){$(window).on('keyup'+self.bindPostfix,function(e){if(e.keyCode===32){if(embedPlayer.paused){embedPlayer.play();}else{embedPlayer.pause();}return false;}});}function bindSpaceDown(){$(window).off('keyup'+self.bindPostfix);}$(window).on('debouncedresize',function(){
embedPlayer.triggerHelper('updateLayout');});if(!self.isOverlayControls()){$interface.show().on('mouseenter',bindSpaceUp).on('mouseleave',bindSpaceDown);$(embedPlayer).on('touchstart'+this.bindPostfix,function(){embedPlayer._playContorls=!0;mw.log('PlayerControlBuilder:: touchstart: isPause:'+embedPlayer.paused);if(embedPlayer.paused){embedPlayer.play();}else{embedPlayer.pause();}});}else{$(embedPlayer).on('touchstart'+this.bindPostfix,function(){if(embedPlayer.getInterface().find('.control-bar').is(':visible')){if(embedPlayer.paused){embedPlayer.play();}else{embedPlayer.pause();}}else{self.showControlBar();}clearTimeout(self.hideControlBarCallback);self.hideControlBarCallback=setTimeout(function(){self.hideControlBar();},60000);return true;});hoverIntentConfig={sensitivity:100,timeout:1000,over:function(){self.showControlBar();bindSpaceUp();},out:function(){self.hideControlBar();bindSpaceDown();}};if(!mw.isIpad()){$interface.hoverIntent(hoverIntentConfig);}}if(self.
checkNativeWarning()){self.addWarningBinding('EmbedPlayer.ShowNativeWarning',mw.msg('mwe-embedplayer-for_best_experience',$('<div>').append($('<a>').attr({href:'https://www.mediawiki.org/wiki/Extension:TimedMediaHandler/Client_download',target:'_new'}))[0].innerHTML));}if(profile.name==='msie'&&profile.versionNumber<=6){$('#'+embedPlayer.id+' .play-btn-large').pngFix();}this.doVolumeBinding();if(this.addSkinControlBindings&&typeof(this.addSkinControlBindings)==='function'){this.addSkinControlBindings();}mw.log('trigger::addControlBindingsEvent');$(embedPlayer).trigger('addControlBindingsEvent');},removePlayerClickBindings:function(){$(this.embedPlayer).off('click'+this.bindPostfix).off('dblclick'+this.bindPostfix);},addPlayerClickBindings:function(){var dblClickTime,lastClickTime,didDblClick,self=this,embedPlayer=this.embedPlayer;document.ontouchmove=function(e){if(self.isInFullScreen()){e.preventDefault();}};this.removePlayerClickBindings();if(this.supportedComponents.fullscreen){$(
embedPlayer).on('dblclick'+self.bindPostfix,function(){embedPlayer.fullscreen();});}dblClickTime=300;lastClickTime=0;didDblClick=!1;function playerClickCb(event){var clickTime;if(event.currentTarget.id!==embedPlayer.id){embedPlayer=$('#'+event.currentTarget.id)[0];}mw.log('PlayerControlBuilder:: click:'+embedPlayer.id+' isPause:'+embedPlayer.paused);if(embedPlayer.useNativePlayerControls()||self.isControlsDisabled()||embedPlayer.isTouchDevice()){return true;}clickTime=new Date().getTime();if(clickTime-lastClickTime<dblClickTime){didDblClick=!0;setTimeout(function(){didDblClick=!1;},dblClickTime+10);}lastClickTime=clickTime;setTimeout(function(){if(!didDblClick){if(embedPlayer.paused){embedPlayer.play();}else{embedPlayer.pause();}}},dblClickTime);return true;}if(embedPlayer.attachEvent){embedPlayer.attachEvent('onclick',playerClickCb);}else{embedPlayer.addEventListener('click',playerClickCb,false);}},addRightClickBinding:function(){var embedPlayer=this.embedPlayer;if(config[
'EmbedPlayer.EnableRightClick']===false){document.oncontextmenu=function(){return false;};$(embedPlayer).on('mousedown',function(e){if(e.button===2){return false;}});}},hideControlBar:function(){var animateDuration='fast',self=this;if(self.displayOptionsMenuFlag||self.keepControlBarOnScreen){setTimeout(function(){self.hideControlBar();},200);return;}if(this.onControlBar===true){return;}this.embedPlayer.getInterface().find('.control-bar').fadeOut(animateDuration);$(this.embedPlayer).trigger('onHideControlBar',[{bottom:15},this.embedPlayer.id]);},restoreControlsHover:function(){if(this.isOverlayControls()){this.keepControlBarOnScreen=!1;}},showControlBar:function(keepOnScreen){var animateDuration='fast';if(!this.embedPlayer){return;}if(this.embedPlayer.getPlayerElement&&!this.embedPlayer.isPersistentNativePlayer()){$(this.embedPlayer.getPlayerElement()).css('z-index','1');}mw.log('PlayerControlBuilder:: ShowControlBar, keep on screen: '+keepOnScreen);this.embedPlayer.getInterface().
find('.control-bar').fadeIn(animateDuration);if(keepOnScreen){this.keepControlBarOnScreen=!0;}$(this.embedPlayer).trigger('onShowControlBar',[{bottom:this.getHeight()+15},this.embedPlayer.id]);},isOverlayControls:function(){if(!this.embedPlayer.supports.overlays){return false;}if(this.embedPlayer.overlaycontrols===false){return false;}if(this.embedPlayer.isAudio()){return false;}if(config['EmbedPlayer.OverlayControls']===false){return false;}if(this.embedPlayer.controls===false){return false;}return true;},isControlsDisabled:function(){return this.controlsDisabled;},checkNativeWarning:function(){if(config['EmbedPlayer.ShowNativeWarning']===false){return false;}if(this.embedPlayer.instanceOf==='ImageOverlay'){return false;}if(parseInt(this.embedPlayer.getPlayerHeight())<199){return false;}if(this.embedPlayer.instanceOf==='Native'){return false;}if(this.embedPlayer.instanceOf==='VLCApp'){return false;}if(this.embedPlayer.instanceOf==='OgvJs'){return false;}if(/chrome/.test(navigator.
userAgent.toLowerCase())&&mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers('video/webm').length){return false;}if((mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers('video/h264').length&&this.embedPlayer.mediaElement.getSources('video/h264').length)||(mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers('video/x-flv').length&&this.embedPlayer.mediaElement.getSources('video/x-flv').length)||(mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers('application/vnd.apple.mpegurl').length&&this.embedPlayer.mediaElement.getSources('application/vnd.apple.mpegurl').length)||(mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers('audio/mpeg').length&&this.embedPlayer.mediaElement.getSources('audio/mpeg').length)){return false;}return true;},addWarningBinding:function(preferenceId,warningMsg,hideDisableUi){var warnId,$targetWarning,embedPlayer=this.embedPlayer,self=this;mw.log('mw.PlayerControlBuilder: addWarningBinding: '+preferenceId+' wm: '+warningMsg);if(embedPlayer.getWidth()<200){return false;}
if(mw.config.get(preferenceId)===true&&$.cookie(preferenceId)==='hidewarning'){return;}warnId='warningOverlay_'+embedPlayer.id;$('#'+warnId).remove();$targetWarning=$('<div>').attr({id:warnId}).addClass('ui-corner-all').css({position:'absolute',background:'#FFF',color:'#111',top:'10px',left:'10px',right:'10px',padding:'4px','z-index':'1502'}).html(warningMsg);embedPlayer.getInterface().append($targetWarning);$targetWarning.append($('<br>'));if(!hideDisableUi){$targetWarning.append($('<input>').attr({type:'checkbox',id:'ffwarn_'+embedPlayer.id,name:'ffwarn_'+embedPlayer.id}).on('click',function(){mw.log('WarningBindinng:: set '+preferenceId+' to hidewarning ');$.cookie(preferenceId,'hidewarning',{expires:30});config[preferenceId]=!1;$('#warningOverlay_'+embedPlayer.id).fadeOut('slow');self.addWarningFlag=!1;}));$targetWarning.append($('<label>').text(mw.msg('mwe-embedplayer-do_not_warn_again')).attr('for','ffwarn_'+embedPlayer.id));}return $targetWarning;},doVolumeBinding:function
(){var hoverOverDelay,$targetvol,userSlide,sliderConf,embedPlayer=this.embedPlayer;embedPlayer.getInterface().find('.volume_control').unbind().buttonHover().on('click',function(){mw.log('Volume control toggle');embedPlayer.toggleMute();});if(this.volumeLayout==='vertical'){hoverOverDelay=!1;$targetvol=embedPlayer.getInterface().find('.vol_container').hide();embedPlayer.getInterface().find('.volume_control').hover(function(){$targetvol.addClass('vol_container_top');if(embedPlayer&&embedPlayer.isPlaying&&embedPlayer.isPlaying()&&!embedPlayer.supports.overlays){$targetvol.removeClass('vol_container_top').addClass('vol_container_below');}$targetvol.fadeIn('fast');hoverOverDelay=!0;},function(){hoverOverDelay=!1;setTimeout(function(){if(!hoverOverDelay){$targetvol.fadeOut('fast');}},500);});}userSlide=!1;sliderConf={range:'min',value:80,min:0,max:100,slide:function(event,ui){var percent=ui.value/100;mw.log('PlayerControlBuilder::slide:update volume:'+percent);embedPlayer.
setVolume(percent);userSlide=!0;},change:function(event,ui){var percent=ui.value/100;if(percent===0){embedPlayer.getInterface().find('.volume_control span').removeClass('ui-icon-volume-on').addClass('ui-icon-volume-off');}else{embedPlayer.getInterface().find('.volume_control span').removeClass('ui-icon-volume-off').addClass('ui-icon-volume-on');}mw.log('PlayerControlBuilder::change:update volume:'+percent);embedPlayer.setVolume(percent,userSlide);userSlide=!1;}};if(this.volumeLayout==='vertical'){sliderConf.orientation='vertical';}embedPlayer.getInterface().find('.volume-slider').slider(sliderConf);},getOptionsMenu:function(){var menuItemKey,$optionsMenu=$('<ul>');for(menuItemKey in this.optionMenuItems){if(config['EmbedPlayer.EnabledOptionsMenuItems'].indexOf(menuItemKey)===-1){continue;}$optionsMenu.append(this.optionMenuItems[menuItemKey](this));}return $optionsMenu;},onClipDone:function(){},onSeek:function(){this.setStatus(mw.msg('mwe-embedplayer-seeking'));this.embedPlayer.
addPlayerSpinner();this.embedPlayer.hideSpinnerOncePlaying();},setStatus:function(value){if(this.embedPlayer.getInterface()){this.embedPlayer.getInterface().find('.time-disp').text(value);}},optionMenuItems:{share:function(ctrlObj){return $.getLineItem(mw.msg('mwe-embedplayer-share'),'mail-closed',function(){ctrlObj.displayMenuOverlay(ctrlObj.getShare());$(ctrlObj.embedPlayer).trigger('showShareEvent');});},aboutPlayerLibrary:function(ctrlObj){return $.getLineItem(mw.msg('mwe-embedplayer-about-library'),'info',function(){ctrlObj.displayMenuOverlay(ctrlObj.aboutPlayerLibrary());$(ctrlObj.embedPlayer).trigger('aboutPlayerLibrary');});}},closeMenuOverlay:function(){var embedPlayer=this.embedPlayer,$overlay=embedPlayer.getInterface().find('.overlay-win,.ui-widget-overlay,.ui-widget-shadow');this.displayOptionsMenuFlag=!1;$overlay.fadeOut('slow',function(){$overlay.remove();});if(embedPlayer.isStopped()&&(embedPlayer.sequenceProxy&&embedPlayer.sequenceProxy.isInSequence===false)){
embedPlayer.getInterface().find('.play-btn-large').fadeIn('slow');}$(embedPlayer).trigger('closeMenuOverlay');return false;},displayMenuOverlay:function(overlayContent,closeCallback,hideCloseButton){var $closeButton,controlBarHeight,overlayWidth,overlayHeight,overlayTop,overlayLeft,overlayMenuCss,$overlayMenu,self=this,embedPlayer=this.embedPlayer;mw.log('PlayerControlBuilder:: displayMenuOverlay');this.displayOptionsMenuFlag=!0;if(!this.supportedComponents.overlays){embedPlayer.stop();}embedPlayer.hideLargePlayBtn();if(embedPlayer.getInterface().find('.overlay-win').length){embedPlayer.getInterface().find('.overlay-content').html(overlayContent);return;}embedPlayer.getInterface().append($('<div>').addClass('ui-widget-overlay').css({height:'100%',width:'100%','z-index':2}));$closeButton=[];if(!hideCloseButton){$closeButton=$('<div>').addClass('ui-state-default ui-corner-all ui-icon_link rButton').css({position:'absolute',cursor:'pointer',top:'2px',right:'2px'}).on('click',function(){
self.closeMenuOverlay();if(closeCallback){closeCallback();}}).append($('<span>').addClass('ui-icon ui-icon-closethick'));}controlBarHeight=embedPlayer.getInterface().find('.control-bar').height();overlayWidth=(embedPlayer.getWidth()-30);overlayHeight=(embedPlayer.getHeight()-(controlBarHeight+30));overlayTop=(((embedPlayer.getInterface().height()-controlBarHeight)-overlayHeight)/2);overlayLeft=((embedPlayer.getInterface().width()-overlayWidth)/2);overlayMenuCss={height:overlayHeight+'px',width:overlayWidth+'px',position:'absolute',top:overlayTop+'px',left:overlayLeft+'px',margin:'0 10px 10px 0',overflow:'auto',padding:'4px','z-index':3};$overlayMenu=$('<div>').addClass('overlay-win ui-state-default ui-widget-header ui-corner-all').css(overlayMenuCss).append($closeButton,$('<div>').addClass('overlay-content').append(overlayContent));embedPlayer.getInterface().prepend($overlayMenu).find('.overlay-win').fadeIn('slow');$(embedPlayer).trigger('displayMenuOverlay');return false;},closeAlert:
function(keepOverlay){var embedPlayer=this.embedPlayer,$alert=$('#alertContainer');mw.log('mw.PlayerControlBuilder::closeAlert');if(!keepOverlay||(mw.isIpad()&&this.inFullScreen)){embedPlayer.controlBuilder.closeMenuOverlay();if(mw.isIpad()){embedPlayer.disablePlayControls();}}$alert.remove();return false;},displayAlert:function(alertObj){var callback,$container,$title,$message,$buttonsContainer,buttonSet,buttonsNum,embedPlayer=this.embedPlayer;mw.log('PlayerControlBuilder::displayAlert:: '+alertObj.title);if(embedPlayer.getInterface().find('.overlay-win').length!==0){return;}if(typeof alertObj.callbackFunction==='string'){if(alertObj.isExternal){try{callback=window.parent[alertObj.callbackFunction];}catch(e){}}else{callback=window[alertObj.callbackFunction];}}else if(typeof alertObj.callbackFunction==='function'){callback=alertObj.callbackFunction;}else{mw.log('PlayerControlBuilder :: displayAlert :: Error: bad callback type');callback=function(){};}$container=$('<div>').attr('id',
'alertContainer').addClass('alert-container');$title=$('<div>').text(alertObj.title).addClass('alert-title alert-text');if(alertObj.props&&alertObj.props.titleTextColor){$title.removeClass('alert-text');$title.css('color',mw.getHexColor(alertObj.props.titleTextColor));}$message=$('<div>').text(alertObj.message).addClass('alert-message alert-text');if(alertObj.isError){$message.addClass('error');}if(alertObj.props&&alertObj.props.textColor){$message.removeClass('alert-text');$message.css('color',mw.getHexColor(alertObj.props.textColor));}$buttonsContainer=$('<div>').addClass('alert-buttons-container');if(alertObj.props&&alertObj.props.buttonRowSpacing){$buttonsContainer.css('margin-top',alertObj.props.buttonRowSpacing);}buttonSet=alertObj.buttons||[];buttonsNum=buttonSet.length;if(buttonsNum===0&&!alertObj.noButtons){buttonSet=['OK'];buttonsNum++;}buttonSet.forEach(function(button,i){var label=button.toString(),$currentButton=$('<button>').addClass('alert-button').text(label).on('click'
,function(eventObject){callback(eventObject);embedPlayer.controlBuilder.closeAlert(alertObj.keepOverlay);});if(alertObj.props&&alertObj.props.buttonHeight){$currentButton.css('height',alertObj.props.buttonHeight);}if(buttonsNum>1){if(i<buttonsNum-1){if(alertObj.props&&alertObj.props.buttonSpacing){$currentButton.css('margin-right',alertObj.props.buttonSpacing);}}}$buttonsContainer.append($currentButton);});$container.append($title,$message,$buttonsContainer);return embedPlayer.controlBuilder.displayMenuOverlay($container,false,true);},aboutPlayerLibrary:function(){return $('<div>').append($('<h2>').text(mw.msg('mwe-embedplayer-about-library')),$('<span>').append(mw.msg('mwe-embedplayer-about-library-desc',$('<div>').append($('<a>').attr({href:'http://www.kaltura.org/project/HTML5_Video_Media_JavaScript_Library',target:'_new'}))[0].innerHTML)));},getShare:function(){var embedPlayer=this.embedPlayer,embedCode=embedPlayer.getSharingEmbedCode(),embedWikiCode=embedPlayer.getWikiEmbedCode(),
$shareInterface=$('<div>'),$shareList=$('<ul>');$shareList.append($('<li>').text(mw.msg('mwe-embedplayer-embed_site_or_blog')));$shareInterface.append($('<h2>').text(embedPlayer.isAudio()?mw.msg('mwe-embedplayer-shareself_audio'):mw.msg('mwe-embedplayer-shareself_video')));if(embedWikiCode){$shareInterface.append($('<ul>').append($('<li>').text(mw.msg('mwe-embedplayer-embed_wiki'))),$('<textarea>').attr('rows',1).html(embedWikiCode).on('click',function(){$(this).trigger('select');}),$('<br>'));}$shareInterface.append($shareList);$shareInterface.append($('<textarea>').attr('rows',4).html(embedCode).on('click',function(){$(this).trigger('select');}),$('<br>'),$('<br>'));return $shareInterface;},getPlayerSelect:function(){var $playerSelect,embedPlayer=this.embedPlayer,self=this;mw.log('PlayerControlBuilder::getPlayerSelect: source:'+this.embedPlayer.mediaElement.selectedSource.getSrc()+' player: '+this.embedPlayer.selectedPlayer.id);$playerSelect=$('<div>').append($('<h2>').text(mw.msg(
'mwe-embedplayer-choose_player')));embedPlayer.mediaElement.getPlayableSources().forEach(function(source,sourceId){var $playerList,supportingPlayers,i,$playerLine,isPlayable=(typeof mw.EmbedTypes.getMediaPlayers().defaultPlayer(source.getMIMEType())==='object'),isSelected=(source.getSrc()===embedPlayer.mediaElement.selectedSource.getSrc());$playerSelect.append($('<h3>').text(source.getTitle()));if(isPlayable){$playerList=$('<ul>');supportingPlayers=mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers(source.getMIMEType());for(i=0;i<supportingPlayers.length;i++){if(embedPlayer.selectedPlayer.id===supportingPlayers[i].id&&isSelected){$playerLine=$('<span>').append($('<a>').attr({href:'#'}).addClass('active').text(supportingPlayers[i].getName()).on('click',function(){embedPlayer.controlBuilder.closeMenuOverlay();return false;}));}else{$playerLine=$('<a>').attr({href:'#',id:'sc_'+sourceId+'_'+supportingPlayers[i].id}).addClass('ui-corner-all').text(supportingPlayers[i].getName()).on('click',
function(){var playableSources,iparts=$(this).attr('id').replace(/sc_/,'').split('_'),sourceId=iparts[0],playerId=iparts[1];mw.log('PlayerControlBuilder:: source id: '+sourceId+' player id: '+playerId);embedPlayer.controlBuilder.closeMenuOverlay();if(self.isInFullScreen()){self.restoreWindowPlayer();}embedPlayer.mediaElement.setSourceByIndex(sourceId);playableSources=embedPlayer.mediaElement.getPlayableSources();mw.EmbedTypes.getMediaPlayers().setPlayerPreference(playerId,playableSources[sourceId].getMIMEType());embedPlayer.stop();return false;}).on('mouseenter',function(){$(this).addClass('active');}).on('mouseleave',function(){$(this).removeClass('active');});}$playerList.append($('<li>').append($playerLine));}$playerSelect.append($playerList);}else{$playerSelect.append(mw.message('mwe-embedplayer-no-player',source.getTitle()).escaped());}});return $playerSelect;},showDownload:function($target){var self=this;self.showDownloadWithSources($target);},showDownloadWithSources:function(
$target){var $mediaList,$textList,embedPlayer=this.embedPlayer;mw.log('PlayerControlBuilder:: showDownloadWithSources::'+$target.length);$target.empty();$target.append($('<div>'));$target=$target.find('div');$mediaList=$('<ul>');$textList=$('<ul>');embedPlayer.mediaElement.getSources().forEach(function(source){var fileName,path,pathParts,$dlLine;if(source.getSrc()){mw.log('showDownloadWithSources:: Add src: '+source.getTitle());fileName=source.mwtitle;if(!fileName){path=new mw.Uri(source.getSrc()).path;pathParts=path.split('/');fileName=pathParts[pathParts.length-1];}$dlLine=$('<li>').append($('<a>').attr({href:source.getSrc(),download:fileName}).text(source.getTitle()));if(source.getSrc().indexOf('?t=')!==-1){$target.append($dlLine);}else if(this.getMIMEType().indexOf('text')===0){$textList.append($dlLine);}else{$mediaList.append($dlLine);}}});if($mediaList.find('li').length!==0){$target.append($('<h2>').text(embedPlayer.isAudio()?mw.msg('mwe-embedplayer-download_full_audio'):mw.msg(
'mwe-embedplayer-download_full_video')),$mediaList);}if($textList.find('li').length!==0){$target.append($('<h2>').html(mw.message('mwe-embedplayer-download_text').escaped()),$textList);}},getSwitchSourceMenu:function(){var addedSources,i,lib,self=this,embedPlayer=this.embedPlayer,$sourceMenu=$('<ul>');function addToSourceMenu(source){var icon=(source.getSrc()===embedPlayer.mediaElement.selectedSource.getSrc())?'bullet':'radio-on';$sourceMenu.append($.getLineItem(source.getShortTitle(),icon,function(){var oldMediaTime,oldPaused;mw.log('PlayerControlBuilder::SwitchSourceMenu: '+source.getSrc());$(this).parent().siblings().find('span.ui-icon').removeClass('ui-icon-bullet').addClass('ui-icon-radio-on');$(this).find('span.ui-icon').removeClass('ui-icon-radio-on').addClass('ui-icon-bullet');embedPlayer.getInterface().find('.source-switch').text(source.getShortTitle());embedPlayer.mediaElement.setSource(source);if(!self.embedPlayer.isStopped()){oldMediaTime=self.embedPlayer.getPlayerElement()
.currentTime;oldPaused=self.embedPlayer.paused;embedPlayer.playerSwitchSource(source,function(){embedPlayer.setCurrentTime(oldMediaTime,function(){if(oldPaused){embedPlayer.pause();}});});}}));}addedSources={};this.embedPlayer.mediaElement.getPlayableSources().forEach(function(source){var supportingPlayers=mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers(source.getMIMEType());for(i=0;i<supportingPlayers.length;i++){lib=supportingPlayers[i].library;if(lib==='Native'||lib==='OgvJs'){if(!(source.getSrc()in addedSources)){addedSources[source.getSrc()]=!0;addToSourceMenu(source);}}}});return $sourceMenu;},getComponent:function(componentId){if(this.components[componentId]){return this.components[componentId].o(this);}else{return false;}},getComponentHeight:function(componentId){if(this.components[componentId]&&this.components[componentId].h){return this.components[componentId].h;}return 0;},getComponentWidth:function(componentId){if(this.components[componentId]&&this.components[
componentId].w){return this.components[componentId].w;}return 0;},disableSeekBar:function(){var $playHead=this.embedPlayer.getInterface().find('.play_head');if($playHead.length){$playHead.slider('option','disabled',true);}},enableSeekBar:function(){var $playHead=this.embedPlayer.getInterface().find('.play_head');if($playHead.length){$playHead.slider('option','disabled',false);}},components:{pause:{w:28,position:1,o:function(ctrlObj){return $('<div>').attr('title',mw.msg('mwe-embedplayer-play_clip')).addClass('ui-state-default ui-corner-all ui-icon_link lButton play-btn').append($('<span>').addClass('ui-icon ui-icon-play')).buttonHover().on('click',function(){ctrlObj.embedPlayer.play();return false;});}},volumeControl:{w:28,position:7,o:function(ctrlObj){var $volumeOut=$('<span>');mw.log('PlayerControlBuilder::Set up volume control for: '+ctrlObj.embedPlayer.id);if(ctrlObj.volumeLayout==='horizontal'){$volumeOut.append($('<div>').addClass(
'ui-slider ui-slider-horizontal rButton volume-slider'));}$volumeOut.append($('<div>').attr('title',mw.msg('mwe-embedplayer-volume_control')).addClass('ui-state-default ui-corner-all ui-icon_link rButton volume_control').append($('<span>').addClass('ui-icon ui-icon-volume-on')));if(ctrlObj.volumeLayout==='vertical'){$volumeOut.find('.volume_control').append($('<div>').hide().addClass('vol_container ui-corner-all').append($('<div>').addClass('volume-slider')));}return $volumeOut.html();}},playButtonLarge:{w:70,h:53,position:2,o:function(ctrlObj){return $('<div>').attr({title:mw.msg('mwe-embedplayer-play_clip'),class:'play-btn-large'}).css(ctrlObj.getPlayButtonPosition()).on('click',function(){ctrlObj.embedPlayer.play();return false;});}},attributionButton:{w:28,position:3,o:function(){var $icon,buttonConfig={title:'Kaltura html5 video library',href:'http://www.kaltura.com',class:'kaltura-icon',style:{},iconurl:!1};if(buttonConfig.iconurl){$icon=$('<img>').attr('src',buttonConfig.
iconurl);}else{$icon=$('<span>').addClass('ui-icon');if(buttonConfig.class){$icon.addClass(buttonConfig.class);}}if(typeof buttonConfig.style!=='object'){buttonConfig.style={};}if(buttonConfig.style.width){this.w=parseInt(buttonConfig.style.width);}else{buttonConfig.style.width=parseInt(this.w)+'px';}return $('<div>').addClass('rButton').css({top:'1px',left:'2px'}).css(buttonConfig.style).append($('<a>').attr({href:buttonConfig.href,title:buttonConfig.title,target:'_new'}).append($icon));}},timeDisplay:{w:config['EmbedPlayer.TimeDisplayWidth'],position:6,o:function(ctrlObj){return $('<div>').addClass('ui-widget time-disp').append(ctrlObj.embedPlayer.getTimeRange());}},options:{w:28,position:10,o:function(ctrlObj){return $('<div>').attr('title',mw.msg('mwe-embedplayer-player_options')).addClass('ui-state-default ui-corner-all ui-icon_link rButton options-btn').append($('<span>').addClass('ui-icon ui-icon-wrench')).buttonHover().embedMenu({content:ctrlObj.getOptionsMenu(),zindex:config[
'EmbedPlayer.FullScreenZIndex']+2,positionOpts:{directionV:'up',offsetY:30,directionH:'left',offsetX:-28}});}},fullscreen:{w:24,position:8,o:function(ctrlObj){var url,$btn=$('<div>').attr('title',mw.msg('mwe-embedplayer-player_fullscreen')).addClass('ui-state-default ui-corner-all ui-icon_link rButton fullscreen-btn').append($('<span>').addClass('ui-icon ui-icon-arrow-4-diag')).buttonHover();if(config['EmbedPlayer.NewWindowFullscreen']||(config['EmbedPlayer.IsIframeServer']&&config['EmbedPlayer.EnableIframeApi']===false)){url=ctrlObj.embedPlayer.getIframeSourceUrl();return $('<a>').attr({href:url,target:'_new'}).on('click',function(){var newwin,url=$(this).attr('href'),iframeMwConfig={};iframeMwConfig['EmbedPlayer.IsFullscreenIframe']=!0;iframeMwConfig['EmbedPlayer.IframeCurrentTime']=ctrlObj.embedPlayer.currentTime;iframeMwConfig['EmbedPlayer.IframeIsPlaying']=ctrlObj.embedPlayer.isPlaying();iframeMwConfig['EmbedPlayer.IframeParentUrl']=document.URL;url+='#'+encodeURIComponent(JSON.
stringify({mwConfig:iframeMwConfig}));ctrlObj.embedPlayer.pause();newwin=window.open(url,ctrlObj.embedPlayer.id,'width='+screen.width+', height='+(screen.height-90)+', top=0, left=0'+', fullscreen=yes');if(newwin===null){return true;}if(window.focus){newwin.focus();}return false;}).append($btn);}else{return $btn.on('click',function(){ctrlObj.embedPlayer.fullscreen();});}}},sourceSwitch:{w:70,position:9,o:function(ctrlObj){var $menuContainer=$('<div>').addClass('swMenuContainer').hide();ctrlObj.embedPlayer.getInterface().append($menuContainer);return $('<div>').addClass('ui-widget source-switch').append(ctrlObj.embedPlayer.mediaElement.selectedSource.getShortTitle()).embedMenu({content:ctrlObj.getSwitchSourceMenu(),zindex:config['EmbedPlayer.FullScreenZIndex']+2,keepPosition:!0,targetMenuContainer:$menuContainer,width:130,showSpeed:0,createMenuCallback:function(){var $interface=ctrlObj.embedPlayer.getInterface(),$sw=$interface.find('.source-switch'),$swMenuContainer=$interface.find(
'.swMenuContainer'),height=$swMenuContainer.find('li').length*30,top=$interface.height()-height-ctrlObj.getHeight()-6;$menuContainer.css({position:'absolute',left:$sw[0].offsetLeft,top:top,bottom:ctrlObj.getHeight(),height:height});ctrlObj.showControlBar(true);},closeMenuCallback:function(){ctrlObj.restoreControlsHover();}});}},playHead:{w:0,position:5,o:function(ctrlObj){var perc,$playHead,embedPlayer=ctrlObj.embedPlayer,self=this,sliderConfig={range:'min',value:0,min:0,max:1000,start:function(){var id=embedPlayer.pc?embedPlayer.pc.pp.id:embedPlayer.id;embedPlayer.userSlide=!0;$(id+' .play-btn-large').fadeOut('fast');embedPlayer.startTimeSec=(embedPlayer.instanceOf==='mvPlayList')?0:mw.npt2seconds(embedPlayer.getTimeRange().split('/')[0]);},slide:function(event,ui){var perc=ui.value/1000;embedPlayer.jumpTime=mw.seconds2npt(parseFloat(parseFloat(embedPlayer.getDuration())*perc)+embedPlayer.startTimeSec);if(self.longTimeDisp){ctrlObj.setStatus(mw.msg('mwe-embedplayer-seek_to',
embedPlayer.jumpTime));}else{ctrlObj.setStatus(embedPlayer.jumpTime);}if(embedPlayer.isPlaying===false){embedPlayer.updateThumbPerc(perc);}},change:function(event,ui){if(embedPlayer.userSlide){embedPlayer.userSlide=!1;embedPlayer.seeking=!0;perc=ui.value/1000;embedPlayer.seekTimeSec=mw.npt2seconds(embedPlayer.jumpTime,true);mw.log('PlayerControlBuilder:: seek to: '+embedPlayer.jumpTime+' perc:'+perc+' sts:'+embedPlayer.seekTimeSec);ctrlObj.setStatus(mw.msg('mwe-embedplayer-seeking'));if(embedPlayer.isStopped()){embedPlayer.play();}embedPlayer.seek(perc);}}};$playHead=$('<div>').addClass('play_head').css({position:'absolute',left:'33px',right:((embedPlayer.getPlayerWidth()-ctrlObj.availableWidth-33))+'px'}).slider(sliderConfig);$playHead.find('.ui-slider-handle').css('z-index',4);$playHead.find('.ui-slider-range').addClass('ui-corner-all').css('z-index',2);$playHead.append($('<div>').addClass('ui-slider-range ui-slider-range-min ui-widget-header').addClass(
'ui-state-highlight ui-corner-all mw_buffer'));function showPosition(event){var pos=(event.clientX-$playHead.offset().left)/$playHead.width(),time=mw.seconds2npt(parseFloat(embedPlayer.getDuration())*pos+(embedPlayer.startTimeSec||0));$playHead.attr('title',time);}$playHead.on({mouseenter:showPosition,mouseleave:function(){$playHead.attr({title:''});},mousemove:showPosition});return $playHead;}}}};}());(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler');mw.PlayerSkinKskin={playerClass:'k-player',longTimeDisp:!1,height:20,volumeLayout:'horizontal',supportedMenuItems:{credits:!0},currentMenuItem:null,components:{pause:{w:28},volumeControl:{w:40},playButtonLarge:{h:55},options:{w:52,o:function(){return $('<div>').attr('title',mw.msg('mwe-embedplayer-player_options')).addClass('ui-state-default ui-corner-bl rButton k-options').append($('<span>').text(mw.msg('mwe-embedplayer-menu_btn')));}},attributionButton:!1,timeDisplay:{w:52},optionsMenu:{w:0,o:function(
ctrlObj){var userAgent,topPos,menuItem,$menuBar,$menuScreens,embedPlayer=ctrlObj.embedPlayer,$menuOverlay=$('<div>').addClass('overlay-win k-menu ui-widget-content').css({width:'100%',position:'absolute',top:'0px',bottom:(ctrlObj.getHeight()+2)+'px'});userAgent=navigator.userAgent.toLowerCase();if(userAgent.indexOf('safari')!==-1){$menuOverlay.css('opacity','0.9');}if(embedPlayer.getPlayerHeight()<ctrlObj.getOverlayHeight()){topPos=(ctrlObj.isOverlayControls())?embedPlayer.getPlayerHeight():embedPlayer.getPlayerHeight()+ctrlObj.getHeight();if(embedPlayer.isAudio()){topPos=ctrlObj.embedPlayer.getInterface().height();}$menuOverlay.css({top:topPos+'px',bottom:null,width:ctrlObj.getOverlayWidth(),height:ctrlObj.getOverlayHeight()+'px'});$(embedPlayer).parents('.thumbinner').css('overflow','visible');}$menuBar=$('<ul>').addClass('k-menu-bar');delete ctrlObj.supportedMenuItems.aboutPlayerLibrary;for(menuItem in ctrlObj.supportedMenuItems){$menuBar.append($('<li>').addClass('k-'+menuItem+
'-btn').attr('rel',menuItem).append($('<a>').attr({title:mw.msg('mwe-embedplayer-'+menuItem),href:'#'})));}$menuOverlay.append($menuBar);$menuScreens=$('<div>').addClass('k-menu-screens').css({position:'absolute',top:'0px',left:'0px',bottom:'0px',right:'45px',overflow:'hidden'});for(menuItem in ctrlObj.supportedMenuItems){$menuScreens.append($('<div>').addClass('menu-screen menu-'+menuItem));}$menuOverlay.append($menuScreens);return $menuOverlay;}}},getOverlayWidth:function(){return(this.embedPlayer.getPlayerWidth()<220)?220:this.embedPlayer.getPlayerWidth();},getOverlayHeight:function(){return(this.embedPlayer.getPlayerHeight()<160)?160:this.embedPlayer.getPlayerHeight();},addSkinControlBindings:function(){var $kmenu,embedPlayer=this.embedPlayer,self=this;this.$playerTarget=embedPlayer.$interface;this.$playerTarget.find('.k-options').off().on('click',function(){self.checkMenuOverlay();$kmenu=self.$playerTarget.find('.k-menu');if($kmenu.is(':visible')){self.closeMenuOverlay();}else{
self.showMenuOverlay();if(!self.currentMenuItem){self.showMenuItem('credits');self.$playerTarget.find('.menu-screen').hide();self.$playerTarget.find('.menu-credits').fadeIn('fast');}}});},checkMenuOverlay:function(){var self=this,embedPlayer=this.embedPlayer;if(self.$playerTarget.find('.k-menu').length===0){if(!embedPlayer.supports.overlays){embedPlayer.stop();}self.addMenuBinding();}},closeMenuOverlay:function(){var embedPlayer=this.embedPlayer,$optionsMenu=embedPlayer.getInterface().find('.k-options'),$kmenu=embedPlayer.getInterface().find('.k-menu');mw.log('PlayerSkinKskin:: close menu overlay');$kmenu.fadeOut('fast',function(){$optionsMenu.find('span').text(mw.msg('mwe-embedplayer-menu_btn'));});if(!embedPlayer.isPlaying()){embedPlayer.getInterface().find('.play-btn-large').fadeIn('fast');}this.showControlBar();this.displayOptionsMenuFlag=!1;},showMenuOverlay:function(){var $optionsMenu=this.$playerTarget.find('.k-options'),$kmenu=this.$playerTarget.find('.k-menu');$kmenu.fadeIn
('fast',function(){$optionsMenu.find('span').text(mw.msg('mwe-embedplayer-close_btn'));});this.$playerTarget.find('.play-btn-large').fadeOut('fast');$(this.embedPlayer).trigger('displayMenuOverlay');this.displayOptionsMenuFlag=!0;},addMenuBinding:function(){var menuItem,self=this,embedPlayer=this.embedPlayer,$playerTarget=embedPlayer.$interface;if($playerTarget.find('.k-menu').length!==0){return false;}$playerTarget.append(self.getComponent('optionsMenu'));$playerTarget.find('.k-menu').hide();for(menuItem in self.supportedMenuItems){$playerTarget.find('.k-'+menuItem+'-btn').on('click',function(){var mk=$(this).attr('rel'),$targetItem=$playerTarget.find('.menu-'+mk);self.showMenuItem(mk);$playerTarget.find('.menu-screen').hide();$targetItem.fadeIn('fast');return false;});}},showMenuItem:function(menuItem){var embedPlayer=this.embedPlayer;this.currentMenuItem=menuItem;switch(menuItem){case'credits':this.showCredits();break;case'playerSelect':embedPlayer.$interface.find(
'.menu-playerSelect').html(this.getPlayerSelect());break;case'download':embedPlayer.$interface.find('.menu-download').text(mw.msg('mwe-loading_txt'));this.showDownload(embedPlayer.$interface.find('.menu-download'));break;case'share':embedPlayer.$interface.find('.menu-share').html(this.getShare());break;}},showCredits:function(){var $creditBox,embedPlayer=this.embedPlayer,$target=embedPlayer.$interface.find('.menu-credits');$target.empty().append($('<h2>').text(mw.msg('mwe-embedplayer-credits')),$('<div>').addClass('credits_box ui-corner-all').append($('<div/>').loadingSpinner().css({position:'absolute',top:'50%',left:'50%'})));if(config['EmbedPlayer.KalturaAttribution']===true){$target.append($('<div>').addClass('k-attribution').attr({title:mw.msg('mwe-embedplayer-kaltura-platform-title')}).on('click',function(){window.location='http://html5video.org';}));}$creditBox=$target.find('.credits_box');$creditBox.data('playerId',embedPlayer.id);$(embedPlayer).triggerQueueCallback(
'showCredits',$creditBox,function(addedCredits){if(!addedCredits){$creditBox.find('.credits_box').text(mw.msg('mwe-embedplayer-nocredits'));}});}};}());},{"css":[
".ui-dialog-content .mediaContainer{margin:0 auto}.mwPlayerContainer,video{width:100%;height:100%}.mwPlayerContainer{position:relative;height:100%;background:#000}.videoHolder{position:absolute;top:0px;right:0px;left:0px;bottom:0px;overflow:hidden}.mwPlayerContainer.fullscreen{position:absolute !important;width:100% !important;height:100%! important;z-index:9999;min-height:100%;top:0;right:0;margin:0}.mwEmbedPlayer{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}.player_select_list{color:white;font-size:10pt; }.player_select_list a:visited{color:white}.mv_playhead{position:absolute;top:0;right:0;width:17px;height:21px; }.mv_status{font-family:\"Times New Roman\",Times,serif;font-size:14px;float:right}.set_ogg_player_pref{text-align:right}.large_play_button{display:block;width:130px;height:96px;margin:auto; position:absolute;z-index:3;cursor:pointer} .ui-icon_link{padding:.4em 20px .4em 1em;text-decoration:none;position:relative}.ui-icon_link span.ui-icon{margin:0 0 0 5px;position:absolute;right:0.2em;left:auto;top:50%;margin-top:-8px;zoom:1}.ui-icon_link span.ui-text{position:absolute;right:0.2em;left:auto;margin-top:-3px;zoom:1}.ui-progressbar-value{background-image:none}.kplayer .ui-widget-overlay{background:black;opacity:.40;filter:Alpha(Opacity=40)}.kplayer .ui-widget-content input{padding:5px}.kplayer .ui-widget-content a{color:#222}ul.ui-provider-selection{list-style-type:none;margin:0 0 0.6em 0;overflow:hidden;padding:0;text-align:center}ul.ui-provider-selection li{border-right:1px solid black;float:right;line-height:1.1em;margin:0 -0.5em 0 0.5em;padding:0 0.5em;color:blue;list-style-image:none;cursor:pointer}ul.ui-provider-selection li .ui-selected{color:black;font-weight:bold}ul.ui-provider-selection li a.ui-active{color:black;font-weight:bold}ul.ui-provider-selection li a{color:blue;text-decoration:none}.fg-menu .ui-icon{position:relative;top:-1px}.ui-dialog-buttonpane a{float:left;margin-left:10px} .mv-player .overlay-win{background:transparent;border:0} .mv-player .overlay-content{padding:10px}.mv-player .overlay-content h3{display:block;font-size:16px;font-weight:bold;color:#fff;font-family:arial}.mv-player .overlay-win h2{font-size:18px;margin-top:0}.mv-player .overlay-content div{font-size:12px;color:#fff;font-weight:bold}.mv-player .overlay-content div a{color:#00a8ff }.mv-player .overlay-content div a:hover{color:#3abcff }.mv-player .overlay-content ul{list-style:none;margin:0 0 10px 0;padding:0}.mv-player .vol_container{background:#272727;opacity:.80;filter:Alpha(Opacity=80);position:absolute;right:0px}.mv-player .ui-icon ui-icon-closethick{border:1px solid #606060;background:#222;font-weight:normal;color:#EEE}.mv-player .overlay-win textarea{background:#e4e4e4;height:35px;padding:6px;color:#666;border:0}.mv-player .overlay-content .copycode{padding:8px 12px;font-weight:bold;float:left;cursor:pointer}.control-bar .ui-icon_link{border:0}.control-bar .ui-state-hover{border:0} .k-player{color:#FFF;background-color:#000}.k-player .videoHolder a{color:#0645AD}.k-player .videoHolder a:visited{color:#0B0080}.k-player .ui-widget-content{color:#555;z-index:1503}.k-player .ui-widget-content a{color:#555} .k-player .play-btn-large{width:70px;height:55px;background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat 0px -433px;position:absolute;cursor:pointer;border:none}@print{.k-player .play-btn-large{display:none}} .k-player .play-btn-large:hover{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat 0px -377px} .k-player .control-bar .ui-icon,.k-player .control-bar .ui-icon{background:transparent url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat scroll 0 -48px}.k-player .ui-state-default .ui-icon-arrow-4-diag{background-position:0 -32px} .k-player .ui-state-hover .ui-icon-arrow-4-diag{background-position:-16px -32px}.k-player .ui-state-hover .ui-icon-volume-on{background-position:-16px -48px} .k-player .ui-state-default .ui-icon-comment{background-position:0px -65px}.k-player .ui-state-default .ui-icon-play{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat 0 0}.k-player .ui-state-hover .ui-icon-play{background-position:-16px 0}.k-player .ui-state-default .ui-icon-pause{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat 0 -17px}.k-player .ui-state-hover .ui-icon-pause{background-position:-16px -17px}.k-player .control-bar{border:1px solid #c8c8c8;border-top:0px;border-left:0px;height:21px;padding:2px 6px 0 0;margin-top:0px;background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) repeat-x 0 -81px;font:normal 11px arial,sans-serif;color:#555;position:absolute;bottom:0px;right:0px;left:0px;z-index:2}.k-player .play_head{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) repeat-x scroll 0 -350px transparent;display:inline; float:left;margin-right:10px;border:1px solid #EEEEEE;height:8px;margin:5px 0px 0 2px;position:relative; direction:ltr}.k-player .play_head .ui-slider-handle{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat scroll -67px -341px transparent !important;border:1px solid #888888;display:block;height:8px;margin:-1px -5px 0 0;position:absolute;top:0;width:8px;cursor:pointer;-moz-border-radius:5px 5px 5px 5px;border-radius:5px 5px 5px 5px;-webkit-border-radius:5px 5px 5px 5px}.k-player .ui-corner-all{border-radius:5px 5px 5px 5px !important;-webkit-border-radius:5px 5px 5px 5px !important;-moz-border-radius:5px 5px 5px 5px !important}.k-player ul.fg-menu{margin:0.3em .3em 0 0;font-size:1.2em;padding:0px}.k-player .fg-menu-container{padding:0px; right:16px; overflow:auto}.ui-dialog-content .k-player ul.fg-menu{font-size:1.2em}.k-player .time-disp{border:medium none;display:inline;color:#555555;font:11px arial,sans-serif;line-height:20px;overflow:hidden;width:39px; float:right}.k-player .source-switch{border:medium none;display:inline;color:#555;font:11px arial,sans-serif;line-height:20px;overflow:hidden;width:70px;cursor:pointer; float:right;text-align:center}.k-player .lButton{cursor:pointer; float:left;list-style:none outside none;margin:2px;padding:0px 0;width:19px;height:16px;position:relative;background:none repeat scroll 0 0 transparent !important;border:medium none}.k-player .rButton{cursor:pointer; float:right;list-style:none outside none;margin-top:2px;padding:0px 0;width:22px;height:16px;position:relative;background:none repeat scroll 0 0 transparent !important;border:medium none}.k-player .k-options{border:1px solid #AAAAAA !important;color:#555555 !important; float:right;height:21px;margin-top:-2px;margin-left:0px;width:50px;background:none repeat scroll 0 0 transparent !important;font-family:Lucida Grande,Lucida Sans,Arial,sans-serif;font-size:11px;text-transform:uppercase;text-align:center}.k-player .k-options span{position:relative;top:4px}.k-player .k-menu-screens{ float:left;font-size:14px;text-align:right;padding:5px 5px 10px 5px}.k-player ul.k-menu-bar{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat scroll -99px -104px transparent;bottom:5px;height:128px;list-style:none outside none;padding:0 0 5px;position:absolute; right:0;margin-right:0}.k-player .k-menu{background:none repeat scroll 0 0 #181818;border:medium none;display:none;right:0;position:absolute;top:0}.k-player .k-menu-bar li a{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat scroll -51px -110px transparent;display:block;height:32px;margin-right:1px;overflow:hidden;text-indent:99999px;width:49px}.k-menu-bar li a:hover{background-position:-1px -110px}.k-menu-bar li.k-download-btn a{background-position:-51px -203px}.k-menu-bar li.k-download-btn a:hover{background-position:-1px -203px}.k-menu-bar li.k-share-btn a{background-position:-51px -172px}.k-menu-bar li.k-share-btn a:hover{background-position:-1px -172px}.k-menu-bar li.k-credits-btn a{background-position:-51px -141px}.k-menu-bar li.k-credits-btn a:hover{background-position:-1px -141px}.k-menu-screens p{margin:6px 0}.k-menu-screens a img{border:none}.k-menu-screens ul{padding:0;margin:6px 0 0;list-style:none outside none}.k-edit-screen{width:370px;height:223px;padding-top:77px;text-align:center;background:#181818;color:#fff}.k-edit-screen div{}.k-edit-screen a{color:#7BB8FC}.k-edit-screen a img{border:none}.k-menu-screens h2,.k-menu-screens h3{padding:0 15px 5px 0;clear:both;font-size:12px;color:#999;border-bottom:0}.k-menu-screens p{margin:6px 0}.k-menu-screens a img{border:none}.k-menu-screens ul{padding:0;margin:6px 0 0;list-style:none outside none}.k-menu-screens li{margin-bottom:6px}.k-menu-screens li a{padding-right:22px;padding-left:22px;background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat -85px -274px;text-decoration:none;color:#BBB}.k-menu-screens li a.active,.k-menu-screens li a:hover .active{background-position:-85px -245px}.k-menu-screens li a:hover{background-position:-85px -259px}.k-menu textarea{background:none repeat scroll 0 0 transparent;border-color:#000000 #000000 -moz-use-text-color -moz-use-text-color;border-style:solid solid none none;border-width:2px medium medium 2px;color:#CCCCCC;font:11px arial,sans-serif;overflow:hidden;padding-right:2px;width:95%}.menu-screen.menu-share button{background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) no-repeat scroll 0 -81px #D4D4D4;border:1px solid #000000;color:#000000;float:left;height:34px;padding:0 5px 3px;font-size:1em}.k-player .menu-screen{height:100%;overflow-y:auto;overflow-x:hidden}.k-player .menu-screen.menu-share div.ui-state-highlight{background:none repeat scroll 0 0 transparent;border-color:#554926;color:#FFE96E;float:right;padding:2px 5px}.k-player .menu-screen.menu-share div.ui-state-highlight a{color:#FFE96E;font-weight:bold}.k-player .volume_control{ margin-right:2px;width:16px}.k-player .volume_control span{margin-left:0px}.k-player .volume-slider{width:20px; direction:ltr}.k-player .volume-slider .ui-slider-range{-moz-border-radius:0 0 0 0;background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/ksprite.png?3c85d) repeat-x scroll -66px -306px transparent !important;height:17px;position:absolute}.k-player .volume-slider a.ui-slider-handle{background:none repeat scroll 0 0 transparent;border:medium none;display:block;height:18px;margin:-3px -1px 0 5px;position:absolute;width:8px}.k-player .ui-slider-horizontal .ui-slider-range-min{ left:0}.k-player .credits_box{background-attachment:scroll;background-color:white;background-image:none;background-position:0 0;bottom:20px;right:20px;position:absolute;left:20px;top:30px;overflow:hidden}.k-player .credits_box a{color:#666;text-decoration:underline}.k-player .creditline img{float:right;width:90px;margin:4px}.k-player .k-attribution{position:absolute;bottom:5px;left :20px;background:url(/w/extensions/TimedMediaHandler/resources/mwembed/EmbedPlayer/skins/kskin/images/kaltura_open_source_video_platform.png?c1b3e);width :51px;height :12px;cursor:pointer}"
]},{"mwe-embedplayer-about-library":"عن مشغل كالشورا","mwe-embedplayer-about-library-desc":"تتيح لك مكتبة مشغل HTML5 Kaltura الاستفادة من وسوم \u0026lt;video\u0026gt; و\u0026lt;audio\u0026gt; اليوم مع واجهة مشغل متسقة عبر جميع المتصفحات الرئيسية.\n\n[$1 المزيد عن مكتبة مشغل Kaltura].","mwe-embedplayer-add_to_end_of_sequence":"أضف إلى نهاية السلسلة","mwe-embedplayer-audio-mpeg":"صوت MPEG","mwe-embedplayer-buffering":"التخزين المؤقت","mwe-embedplayer-choose_player":"اختر مشغل الفيديو","mwe-embedplayer-clip_linkback":"صفحة مصدر المقطع","mwe-embedplayer-close_btn":"أغلق","mwe-embedplayer-credit-author":"المؤلف: $1","mwe-embedplayer-credit-date":"تاريخ: $1","mwe-embedplayer-credit-title":"عنوان: $1","mwe-embedplayer-credits":"الإحالات","mwe-embedplayer-current_clip_msg":
"متابعة تشغيل هذا المقطع","mwe-embedplayer-do_not_warn_again":"لا تظهر هذه الرسالة في المرة القادمة","mwe-embedplayer-download":"نزّل","mwe-embedplayer-download-warn":"لم يتم اكتشاف مشغل متوافق في المتصفح: للتشغيل في المتصفح; يُرجَى تنزيل [$1 أحدث فيرفكس]","mwe-embedplayer-download_clip":"نزّل الفيديو","mwe-embedplayer-download_full_audio":"تنزيل ملف صوتي كامل:","mwe-embedplayer-download_full_video":"تحميل كامل ملف الفيديو:","mwe-embedplayer-download_right_click":"لتحميل, اضغط بزر الفارة الايمن واختر \u003Ci\u003Eحفظ الرابط كـ...\u003C/i\u003E","mwe-embedplayer-download_segment":"نزّل المحدد:","mwe-embedplayer-download_text":"تحميل النص","mwe-embedplayer-embed_site_or_blog":"مضمن في صفحة","mwe-embedplayer-embed_wiki":"مضمن في ويكي",
"mwe-embedplayer-error_swap_vid":"خطأ: mwEmbed غير قادر على تبديل علامة الفيديو لواجهة mwEmbed","mwe-embedplayer-for_best_experience":"للحصول على أفضل تجربة لعرض الفيديو نحن ننصح بـ \u003Ca href=\"//www.mediawiki.org/wiki/Extension:TimedMediaHandler/Client_download\" target=\"_blank\"\u003Eمستعرض HTML5 للفيديو\u003C/a\u003E","mwe-embedplayer-fullscreen-tip":"اضغط \u003Cb\u003EF11\u003C/b\u003E للتبديل لوضع الشاشة الكاملة","mwe-embedplayer-fullscreen-tip-osx":"اضغط \u003Cb\u003Eshift ⌘ F\u003C/b\u003E لوضع شاشة كاملة","mwe-embedplayer-iewebmprompt-intro":"عفوا! شيء آخر قبل أن تتمكن من تشغيل هذا الفيديو...","mwe-embedplayer-iewebmprompt-linktext":"تثبيت مكونات وسائط WebM لبرنامج إنترنت إكسبلورر","mwe-embedplayer-iewebmprompt-outro":
"أعد تحميل هذه الصفحة بعد التثبيت.","mwe-embedplayer-kaltura-platform-title":"كالشورا منصة فيديو مفتوحة المصدر","mwe-embedplayer-link_back":"رابط العودة","mwe-embedplayer-loading_plugin":"تحميل ملحق...","mwe-embedplayer-menu_btn":"قائمة","mwe-embedplayer-missing-source":"لم يعثر على مصدر الفيديو","mwe-embedplayer-missing_video_stream":"ملف الفيديو لهذا النسق مفقود","mwe-embedplayer-next_clip_msg":"شغّل المقطع التالي","mwe-embedplayer-no-player":"لا يوجد مشغل لـ $1","mwe-embedplayer-no-video_credits":"لا توجد إحالات متاحة","mwe-embedplayer-nocredits":"لا توجد إحالات متاحة","mwe-embedplayer-ogg-player-IEWebMPrompt":"البرنامج المساعد لتنزيل IE WebM","mwe-embedplayer-ogg-player-aacNative":"مشغل HTML5 AAC","mwe-embedplayer-ogg-player-flowplayer":"Flowplayer",
"mwe-embedplayer-ogg-player-h264Native":"مشغل HTML5 H.264","mwe-embedplayer-ogg-player-kplayer":"مشغل كالشورا","mwe-embedplayer-ogg-player-mp3Native":"مشغل HTML5 MP3","mwe-embedplayer-ogg-player-oggNative":"مشغل HTML5 Ogg","mwe-embedplayer-ogg-player-oggPlugin":"البرنامج المساعد العام لـOgg","mwe-embedplayer-ogg-player-ogvJsPlayer":"مشغل Ogg جافا سكريبت","mwe-embedplayer-ogg-player-omtkplayer":"OMTK Flash Vorbis","mwe-embedplayer-ogg-player-quicktime-activex":"QuickTime ActiveX","mwe-embedplayer-ogg-player-quicktime-mozilla":"إضافة لبرنامج كويك تايم","mwe-embedplayer-ogg-player-selected":"(مختار)","mwe-embedplayer-ogg-player-vlc-player":"المشغل VLC","mwe-embedplayer-ogg-player-vlcAppPlayer":"VLC لتطبيق آي أو إس","mwe-embedplayer-ogg-player-vp9Native":"مشغل HTML5 VP9","mwe-embedplayer-ogg-player-webmNative":"مشغل HTML5 WebM","mwe-embedplayer-pause_clip":"ألبث المقطع",
"mwe-embedplayer-paused":"ايقاف مؤقت","mwe-embedplayer-play_clip":"شغّل المقطع","mwe-embedplayer-playerSelect":"لاعبون","mwe-embedplayer-player_fullscreen":"املأ الشاشة","mwe-embedplayer-player_options":"خيارات المُشغّل","mwe-embedplayer-prev_clip_msg":"شغل المقطع السابق","mwe-embedplayer-read_before_embed":"\u003Ca href=\"https://www.mediawiki.org/wiki/Security_Notes_on_Remote_Embedding\" target=\"new\"\u003Eاقرأ هذا\u003C/a\u003E قبل التضمين.","mwe-embedplayer-related_videos":"فيديوهات ذات صلة","mwe-embedplayer-seek_to":"ابحث في $1","mwe-embedplayer-seeking":"بحث","mwe-embedplayer-select_playback":"تعيين تفضيلات التشغيل","mwe-embedplayer-share":"مشاركة","mwe-embedplayer-share_this_audio":"شارك هذا الملف الصوتي","mwe-embedplayer-share_this_video":"شارك هذا الفيديو","mwe-embedplayer-timed_text":"نص موقوت",
"mwe-embedplayer-video-3gp":"فيديو 3GP","mwe-embedplayer-video-audio":"صوت بترمز Ogg","mwe-embedplayer-video-flv":"فلاش فيديو","mwe-embedplayer-video-h264":"فيديو بترمز H.264","mwe-embedplayer-video-mpeg":"فيديو MPEG","mwe-embedplayer-video-msvideo":"فيديو AVI","mwe-embedplayer-video-ogg":"فيديو بترمز Ogg","mwe-embedplayer-video-webm":"فيديو بترمز WebM","mwe-embedplayer-video_credits":"إحالات الفيديو","mwe-embedplayer-vlcapp-downloadapp":"قم بتنزيل تطبيق VLC من آب ستور","mwe-embedplayer-vlcapp-downloadvideo":"تنزيل هذا الفيديو","mwe-embedplayer-vlcapp-intro":"لعرض مقاطع الفيديو من هذا الموقع في آيفون أو آيباد; تحتاج إلى $1 المجاني.","mwe-embedplayer-vlcapp-openvideo":"افتح هذا الفيديو في تطبيق VLC","mwe-embedplayer-vlcapp-vlcapplinktext":"تطبيق VLC","mwe-embedplayer-vlcapp-vlcapppopup":
"لتشغيل مقاطع الفيديو في هذا الموقع; تحتاج إلى تطبيق VLC المجاني، تثبيت الآن؟","mwe-embedplayer-volume_control":"التحكم بحجم الصوت"});mw.loader.implement("mw.EmbedPlayerNative@14vk75h",function($,jQuery,require,module){(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler');mw.EmbedPlayerNative={instanceOf:'Native',onlyLoadFlag:!1,onLoadedCallback:null,prevCurrentTime:-1,progressEventData:null,mediaLoadedFlag:null,keepPlayerOffScreenFlag:null,isFirstEmbedPlay:null,currentSeekTargetTime:null,nativeEvents:['loadstart','progress','suspend','abort','error','emptied','stalled','play','pause','loadedmetadata','loadeddata','waiting','playing','canplay','canplaythrough','seeking','seeked','timeupdate','ended','ratechange','durationchange','volumechange'],supports:{playHead:!0,pause:!0,fullscreen:!0,sourceSwitch:!0,timeDisplay:!0,volumeControl:!0,overlays:!0},updateFeatureSupport:function(){if(this.useNativePlayerControls()){this.supports.overlays=!1;this.supports.volumeControl=!1;}if(mw.isIpad()){this.supports.volumeControl=!1;}if(this.getPlayerElement()&&this.getSrc()){$(this.
getPlayerElement()).attr('src',this.getSrc());}if(this.getPlayerElement()){this.applyMediaElementBindings();}this.parent_updateFeatureSupport();},addPlayScreenWithNativeOffScreen:function(){var posterSrc,self=this;this.hidePlayerOffScreen();this.keepPlayerOffScreenFlag=!0;this.addLargePlayBtn();this.$interface.find('.play-btn-large').on('click',function(){self.$interface.find('.play-btn-large').hide();self.addPlayerSpinner();self.hideSpinnerOncePlaying();});posterSrc=(this.poster)?this.poster:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkqAcAAIUAgUW0RjgAAAAASUVORK5CYII=';if($(this).find('.playerPoster').length){$(this).find('.playerPoster').attr('src',posterSrc);}else{$(this).append($('<img>').css({margin:'0',width:'100%',height:'100%'}).attr('src',posterSrc).addClass('playerPoster'));}$(this).show();},embedPlayerHTML:function(){var self=this,vid=self.getPlayerElement();this.isFirstEmbedPlay=!0;if(this.useLargePlayBtn()){this.addLargePlayBtn();}
if(vid&&$(vid).attr('src')===this.getSrc(this.currentTime)){self.postEmbedActions();return;}mw.log('EmbedPlayerNative::embedPlayerHTML > play url:'+this.getSrc(this.currentTime)+' startOffset: '+this.start_ntp+' end: '+this.end_ntp);if(this.isPersistentNativePlayer()&&vid){self.postEmbedActions();return;}self.bufferStartFlag=!1;self.bufferEndFlag=!1;$(this).html(self.getNativePlayerHtml());self.postEmbedActions();},getNativePlayerHtml:function(playerAttributes,cssSet){var tagName;if(!playerAttributes){playerAttributes={};}if(!playerAttributes.id){playerAttributes.id=this.pid;}if(!playerAttributes.src){playerAttributes.src=this.getSrc(this.currentTime);}if(this.autoplay){playerAttributes.autoplay='true';}if(!cssSet){cssSet={};}if(!cssSet.width){cssSet.width='100%';}if(!cssSet.height){cssSet.height='100%';}if(this.loop){playerAttributes.loop='true';}tagName=this.isAudio()?'audio':'video';return $('<'+tagName+'>').addClass('nativeEmbedPlayerPid').attr(playerAttributes).css(cssSet);}
,postEmbedActions:function(){var waitReadyStateCount,checkReadyState,self=this,vid=this.getPlayerElement();if(!vid){return;}if($(vid).attr('src')!==this.getSrc(this.currentTime)){$(vid).attr('src',this.getSrc(this.currentTime));}if(config['EmbedPlayer.WebKitPlaysInline']){$(vid).attr('webkit-playsinline',1);}if(config['EmbedPlayer.WebKitAllowAirplay']){$(vid).attr('x-webkit-airplay','allow');}if(this.useNativePlayerControls()){$(vid).attr('controls','true');}self.applyMediaElementBindings();if(this.currentTime!==vid.currentTime){waitReadyStateCount=0;checkReadyState=function(){if(vid.readyState>0){vid.currentTime=this.currentTime;return;}if(waitReadyStateCount>1000){mw.log('Error: EmbedPlayerNative: could not run native seek');return;}waitReadyStateCount++;setTimeout(function(){checkReadyState();},10);};}this.setPlayerElementVolume(this.volume);if(!self.loop){vid.load();}},applyMediaElementBindings:function(){var self=this,vid=this.getPlayerElement();mw.log(
'EmbedPlayerNative::MediaElementBindings');if(!vid){mw.log(' Error: applyMediaElementBindings without player elemnet');return;}self.nativeEvents.forEach(function(eventName){$(vid).off(eventName+'.embedPlayerNative').on(eventName+'.embedPlayerNative',function(){var argArray;if(self._propagateEvents){argArray=$.makeArray(arguments);argArray.push(self.id);if(self['_on'+eventName]){self['_on'+eventName].apply(self,argArray);}else{$(self).trigger(eventName,argArray);}}});});},monitor:function(){var self=this,vid=self.getPlayerElement();if(vid&&vid.buffered&&vid.buffered.end&&vid.duration){try{this.bufferedPercent=(vid.buffered.end(0)/vid.duration);}catch(e){}}self.parent_monitor();},seek:function(percent){if(percent<0){percent=0;}if(percent>1){percent=1;}mw.log('EmbedPlayerNative::seek p: '+percent+' : '+this.supportsURLTimeEncoding()+' dur: '+this.getDuration()+' sts:'+this.seekTimeSec);this.triggerHelper('preSeek',percent);this.seeking=!0;this.currentTime=(percent*this.duration).toFixed
(2);mw.log('EmbedPlayerNative::seek:trigger');this.triggerHelper('seeking');this.controlBuilder.onSeek();if(this.supportsURLTimeEncoding()){if(percent<this.bufferedPercent&&this.playerElement.duration&&!this.didSeekJump){mw.log('EmbedPlayerNative::seek local seek '+percent+' is already buffered < '+this.bufferedPercent);this.doNativeSeek(percent);}else{this.parent_seek(percent);}}else{this.doNativeSeek(percent);}},doNativeSeek:function(percent,callback){var self=this;if((navigator.userAgent.indexOf('Chrome')===-1)&&self.playerElement.seeking){return;}mw.log('EmbedPlayerNative::doNativeSeek::'+percent);this.seeking=!0;this.seekTimeSec=0;if(mw.isIOS()){this.hidePlayerOffScreen();}this.setCurrentTime((percent*this.duration),function(){self.currentTime=self.getPlayerElement().currentTime;if(self.seeking){self.seeking=!1;$(self).trigger('seeked');}self.restorePlayerOnScreen();self.monitor();if(callback){callback();}});},doPlayThenSeek:function(percent){var self=this,retryCount=0,
oldPauseState=this.paused;mw.log('EmbedPlayerNative::doPlayThenSeek::'+percent+' isPaused '+this.paused);this.play();function readyForSeek(){self.getPlayerElement();if(self.playerElement&&self.playerElement.duration){self.doNativeSeek(percent,function(){if(oldPauseState){self.pause();}});}else{if(retryCount<800){setTimeout(readyForSeek,10);retryCount++;}else{mw.log('EmbedPlayerNative:: Error: doPlayThenSeek failed :'+self.playerElement.duration);}}}readyForSeek();},setCurrentTime:function(seekTime,callback,callbackCount){var vid,seekBind,self=this;if(!callbackCount){callbackCount=0;}mw.log('EmbedPlayerNative:: setCurrentTime seekTime:'+seekTime+' count:'+callbackCount);$(this).data('currentSeekTarget',seekTime);vid=this.getPlayerElement();function callbackHandler(){if(typeof callback==='function'){callback();callback=null;}}if(!vid){callbackHandler();self.currentSeekTargetTime=seekTime.toFixed(2);return;}if(vid.readyState<1){if(callbackCount>=40){mw.log(
'Error:: EmbedPlayerNative: with seek request, media never in ready state');callbackHandler();return;}setTimeout(function(){if($(self).data('currentSeekTarget')!==seekTime){mw.log('EmbedPlayerNative:: expired seek target');return;}self.setCurrentTime(seekTime,callback,callbackCount+1);},100);return;}if(vid.currentTime.toFixed(2)===seekTime.toFixed(2)){mw.log('EmbedPlayerNative:: setCurrentTime: current time matches seek target: '+vid.currentTime.toFixed(2)+' === '+seekTime.toFixed(2));callbackHandler();return;}seekBind='seeked.nativeSeekBind';$(vid).off(seekBind);$(vid).on(seekBind,function(){$(vid).off(seekBind);if(seekTime===0&&vid.currentTime===0){callbackHandler();return;}if(vid.currentTime>0){callbackHandler();}else{mw.log('Error:: EmbedPlayerNative: seek callback without time updatet '+vid.currentTime);}});setTimeout(function(){if($(self).data('currentSeekTarget')!==seekTime){mw.log('EmbedPlayerNative:: Expired seek target');return;}if(typeof callback==='function'){if(Math.abs(
vid.currentTime-seekTime)<5){mw.log('EmbedPlayerNative:: Seek time is within 5 seconds of target, successful seek');callback();}else{mw.log('Error:: EmbedPlayerNative: Seek still has not made a callback after 5 seconds, retry');self.setCurrentTime(seekTime,callback,callbackCount++);}}},5000);try{self.currentSeekTargetTime=seekTime.toFixed(2);vid.currentTime=self.currentSeekTargetTime;}catch(e){mw.log('Error:: EmbedPlayerNative: Could not set video tag seekTime');callbackHandler();return;}if(!vid.seeking){mw.log('Error:: not entering seek state, play and wait for positive time');vid.play();setTimeout(function(){self.waitForPositiveCurrentTime(function(){mw.log('EmbedPlayerNative:: Got possitive time:'+vid.currentTime.toFixed(3)+', trying to seek again');self.setCurrentTime(seekTime,callback,callbackCount+1);});},config['EmbedPlayer.MonitorRate']);}},waitForPositiveCurrentTime:function(callback){var self=this,vid=this.getPlayerElement();this.waitForPositiveCurrentTimeCount++;if(vid.
currentTime>0){mw.log('EmbedPlayerNative:: waitForPositiveCurrentTime success');callback();}else if(this.waitForPositiveCurrentTimeCount>200){mw.log('Error:: waitForPositiveCurrentTime failed to reach possitve time');callback();}else{setTimeout(function(){self.waitForPositiveCurrentTime(callback);},50);}},getPlayerElementTime:function(){var ct;this.getPlayerElement();if(!this.playerElement){mw.log('EmbedPlayerNative::getPlayerElementTime: '+this.id+' not in dom ( stop monitor)');this.stop();return false;}ct=this.playerElement.currentTime;if(!ct||isNaN(ct)||ct<0||!isFinite(ct)){return 0;}return this.playerElement.currentTime;},updatePosterSrc:function(src){if(this.getPlayerElement()){$(this.getPlayerElement()).attr('poster',src);}this.parent_updatePosterSrc(src);},emptySources:function(){$(this.getPlayerElement()).attr('src',null);this.parent_emptySources();},playerSwitchSource:function(source,switchCallback,doneCallback){var orginalControlsState,handleSwitchCallback,self=this,src=
source.getSrc(),vid=this.getPlayerElement(),switchBindPostfix='.playerSwitchSource';this.isPauseLoading=!1;if(!src||src===vid.src){if(typeof switchCallback==='function'){switchCallback(vid);}if(typeof doneCallback==='function'){doneCallback();}return;}mw.log('EmbedPlayerNative:: playerSwitchSource: '+src+' native time: '+vid.currentTime);this.currentTime=0;this.previousTime=0;if(vid){try{$(vid).off(switchBindPostfix);vid.pause();orginalControlsState=vid.controls;vid.removeAttribute('controls');self.seeking=!1;self.addPlayerSpinner();vid.src=src;vid.load();self.hidePlayerOffScreen();$(vid).on('loadedmetadata'+switchBindPostfix,function(){$(vid).off('loadedmetadata'+switchBindPostfix);mw.log('EmbedPlayerNative:: playerSwitchSource> loadedmetadata callback for:'+src+' switchCallback: '+switchCallback);if(!self.duration&&isFinite(vid.duration)){self.duration=vid.duration;}if(typeof switchCallback==='function'){vid.play();}});handleSwitchCallback=function(){self.restorePlayerOnScreen(
);self.hideSpinnerAndPlayBtn();vid.controls=orginalControlsState;if(typeof switchCallback==='function'){switchCallback(vid);switchCallback=null;}};$(vid).on('playing'+switchBindPostfix,function(){$(vid).off('playing'+switchBindPostfix);mw.log('EmbedPlayerNative:: playerSwitchSource> playing callback');handleSwitchCallback();});if(typeof doneCallback==='function'){$(vid).on('ended'+switchBindPostfix,function(){$(vid).off(switchBindPostfix);doneCallback();return false;});}vid.play();setTimeout(function(){if(vid.readyState===0&&typeof switchCallback==='function'){mw.log('EmbedPlayerNative:: possible iOS play without gesture failed, issue callback');handleSwitchCallback();self.pause();if(!self.useLargePlayBtn()){self.addLargePlayBtn();}}},5000);}catch(e){mw.log('Error: EmbedPlayerNative Error in switching source playback');}}},hidePlayerOffScreen:function(){var vid=this.getPlayerElement();$(vid).css({position:'absolute',left:'-4048px'});},restorePlayerOnScreen:function(){var vid=this.
getPlayerElement();if(this.keepPlayerOffScreenFlag){return;}$(this).find('.playerPoster').remove();$(vid).css({left:'0px'});},pause:function(){this.getPlayerElement();this.parent_pause();if(this.playerElement){this.playerElement.pause();}},play:function(){var self=this;if(this.isStopped()&&this._playContorls){this.restorePlayerOnScreen();}if(self.parent_play()){if(this.getPlayerElement()&&this.getPlayerElement().play){mw.log('EmbedPlayerNative:: issue native play call');if(this.isPauseLoading){this.hideSpinnerOncePlaying();}this.getPlayerElement().play();this.monitor();}}else{mw.log('EmbedPlayerNative:: parent play returned false, don\'t issue play on native element');}},stop:function(){if(this.playerElement&&this.playerElement.currentTime){this.playerElement.currentTime=0;this.playerElement.pause();}this.parent_stop();},toggleMute:function(){this.parent_toggleMute();this.getPlayerElement();if(this.playerElement){this.playerElement.muted=this.muted;}},setPlayerElementVolume:function(
percent){if(this.getPlayerElement()){if(percent!==0){this.playerElement.muted=!1;}this.playerElement.volume=percent;}},getPlayerElementVolume:function(){if(this.getPlayerElement()){return this.playerElement.volume;}},getPlayerElementMuted:function(){if(this.getPlayerElement()){return this.playerElement.muted;}},getNativeDuration:function(){if(this.playerElement){return this.playerElement.duration;}},load:function(callback){this.getPlayerElement();if(!this.playerElement){mw.log('EmbedPlayerNative::load() ... doEmbed');this.onlyLoadFlag=!0;this.embedPlayerHTML();this.onLoadedCallback=callback;}else{this.playerElement.load();if(callback){callback();}}},getPlayerElement:function(){this.playerElement=$('#'+this.pid).get(0);return this.playerElement;},_onseeking:function(){mw.log('EmbedPlayerNative::onSeeking '+this.seeking+' new time: '+this.getPlayerElement().currentTime);if(this.seeking&&Math.round(this.getPlayerElement().currentTime-this.currentSeekTargetTime)>2){mw.log(
'Error:: EmbedPlayerNative Seek time missmatch: target:'+this.getPlayerElement().currentTime+' actual '+this.currentSeekTargetTime+', note apple HLS can only seek to 10 second targets');}if(!this.seeking){this.currentSeekTargetTime=this.getPlayerElement().currentTime;this.seeking=!0;this.controlBuilder.onSeek();mw.log('EmbedPlayerNative::seeking:trigger:: '+this.seeking);if(this._propagateEvents){this.triggerHelper('seeking');}}},_onseeked:function(){mw.log('EmbedPlayerNative::onSeeked '+this.seeking+' ct:'+this.playerElement.currentTime);this.previousTime=this.currentTime=this.playerElement.currentTime;if(this.seeking){if(Math.abs(this.currentSeekTargetTime-this.getPlayerElement().currentTime)>2){mw.log('Error:: EmbedPlayerNative:seeked triggred with time mismatch: target:'+this.currentSeekTargetTime+' actual:'+this.getPlayerElement().currentTime);return;}this.seeking=!1;if(this._propagateEvents){mw.log('EmbedPlayerNative:: trigger: seeked');this.triggerHelper('seeked');}}this.
hideSpinner();if(this.isStopped()){this.addLargePlayBtn();}this.monitor();},_onpause:function(){var self=this,timeSincePlay=Math.abs(this.absoluteStartPlayTime-new Date().getTime());mw.log('EmbedPlayerNative:: OnPaused:: propagate:'+this._propagateEvents+' time since play: '+timeSincePlay+' isNative=true');if(timeSincePlay>config['EmbedPlayer.MonitorRate']){self.parent_pause();}else{this.getPlayerElement().play();}},_onplay:function(){mw.log('EmbedPlayerNative:: OnPlay:: propogate:'+this._propagateEvents+' paused: '+this.paused);if(this.useNativePlayerControls()){this.$interface.css('pointer-events','none');}if(!this.isFirstEmbedPlay&&this._propagateEvents&&this.paused){this.parent_play();}else{this.playInterfaceUpdate();}this.isFirstEmbedPlay=!1;},_onloadedmetadata:function(){this.getPlayerElement();if(this.playerElement&&!isNaN(this.playerElement.duration)&&isFinite(this.playerElement.duration)){mw.log('EmbedPlayerNative :onloadedmetadata metadata ready Update duration:'+this.
playerElement.duration+' old dur: '+this.getDuration());if(!this.duration&&this.playerElement&&isFinite(this.playerElement.duration)){this.duration=this.playerElement.duration;}}if(!this.paused&&this._propagateEvents){this.getPlayerElement().play();}if(typeof this.onLoadedCallback==='function'){this.onLoadedCallback();}if(!this.mediaLoadedFlag){$(this).trigger('mediaLoaded');this.mediaLoadedFlag=!0;}},_onended:function(){if(this.getPlayerElement()){mw.log('EmbedPlayer:native: onended:'+this.playerElement.currentTime+' real dur:'+this.getDuration()+' ended '+this._propagateEvents);if(this._propagateEvents){this.onClipDone();}}},onClipDone:function(){var self=this;$(this).off('onEndedDone.onClipDone').on('onEndedDone.onClipDone',function(){self.addPlayScreenWithNativeOffScreen();if(!self.isImagePlayScreen()){self.keepPlayerOffScreenFlag=!1;}});this.parent_onClipDone();}};}());});mw.loader.implement("mw.EmbedTypes@1p9no45",function($,jQuery,require,module){(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler'),kplayer=new mw.MediaPlayer('kplayer',['video/x-flv','video/h264','video/mp4; codecs="avc1.42E01E"','video/mp4; codecs="avc1.42E01E, mp4a.40.2"','audio/mpeg'],'Kplayer'),oggNativePlayer=new mw.MediaPlayer('oggNative',['video/ogg','video/ogg; codecs="theora"','video/ogg; codecs="theora, vorbis"','audio/ogg','audio/ogg; codecs="vorbis"','application/ogg'],'Native'),opusNativePlayer=new mw.MediaPlayer('opusNative',['audio/ogg; codecs="opus"'],'Native'),h264NativePlayer=new mw.MediaPlayer('h264Native',['video/h264','video/mp4; codecs="avc1.42E01E, mp4a.40.2"'],'Native'),appleVdnPlayer=new mw.MediaPlayer('appleVdn',['application/vnd.apple.mpegurl','application/vnd.apple.mpegurl; codecs="avc1.42E01E"'],'Native'),mp3NativePlayer=new mw.MediaPlayer('mp3Native',['audio/mpeg','audio/mp3'],'Native'),aacNativePlayer=new mw.MediaPlayer('aacNative',[
'audio/mp4','audio/mp4; codecs="mp4a.40.5"'],'Native'),webmNativePlayer=new mw.MediaPlayer('webmNative',['video/webm','video/webm; codecs="vp8"','video/webm; codecs="vp8, vorbis"','audio/webm','audio/webm; codecs="vorbis"'],'Native'),vp9NativePlayer=new mw.MediaPlayer('vp9Native',['video/webm; codecs="vp9"','video/webm; codecs="vp9, opus"','video/webm; codecs="vp9, vorbis"','audio/webm; codecs="opus"'],'Native'),imageOverlayPlayer=new mw.MediaPlayer('imageOverlay',['image/jpeg','image/png'],'ImageOverlay'),vlcAppPlayer=new mw.MediaPlayer('vlcAppPlayer',['video/ogg','video/ogg; codecs="theora"','video/ogg; codecs="theora, vorbis"','audio/ogg','audio/ogg; codecs="vorbis"','audio/ogg; codecs="opus"','application/ogg','video/webm','video/webm; codecs="vp8"','video/webm; codecs="vp8, vorbis"'],'VLCApp'),IEWebMPrompt=new mw.MediaPlayer('IEWebMPrompt',['video/webm','video/webm; codecs="vp8"','video/webm; codecs="vp8, vorbis"'],'IEWebMPrompt'),ogvJsPlayer=new mw.MediaPlayer('ogvJsPlayer',[
'video/webm','video/webm; codecs="vp8"','video/webm; codecs="vp8, vorbis"','video/webm; codecs="vp8, opus"','video/webm; codecs="vp9"','video/webm; codecs="vp9, vorbis"','video/webm; codecs="vp9, opus"','audio/webm','audio/webm; codecs="vorbis"','audio/webm; codecs="opus"','video/ogg','video/ogg; codecs="theora"','video/ogg; codecs="theora, vorbis"','video/ogg; codecs="theora, opus"','audio/ogg','audio/ogg; codecs="vorbis"','audio/ogg; codecs="opus"','application/ogg'],'OgvJs');mw.EmbedTypes={mediaPlayers:null,detect_done:!1,init:function(){this.detect();this.detect_done=!0;},getMediaPlayers:function(){if(this.mediaPlayers){return this.mediaPlayers;}this.mediaPlayers=new mw.MediaPlayers();this.detectPlayers();return this.mediaPlayers;},addFlashPlayer:function(){if(!config['EmbedPlayer.DisableHTML5FlashFallback']){this.mediaPlayers.addPlayer(kplayer);}},detectPlayers:function(){var dummyvid,i,type,semicolonPos,pluginName,uniqueMimesOnly=$.client.test({opera:null,safari:null});mw.
log('EmbedTypes::detectPlayers running detect');this.mediaPlayers.addPlayer(imageOverlayPlayer);if(mw.supportsFlash()){this.addFlashPlayer();}if($.client.profile().name==='msie'){}if(!config['EmbedPlayer.DisableVideoTagSupport']&&(typeof HTMLVideoElement==='object'||typeof HTMLVideoElement==='function')){try{dummyvid=document.createElement('video');if(dummyvid.canPlayType){if(dummyvid.canPlayType('video/webm; codecs="vp8, vorbis"')){this.mediaPlayers.addPlayer(webmNativePlayer);}if(dummyvid.canPlayType('video/webm; codecs="vp9, opus"')){this.mediaPlayers.addPlayer(vp9NativePlayer);}if(dummyvid.canPlayType('audio/mpeg')){this.mediaPlayers.addPlayer(mp3NativePlayer);}if(dummyvid.canPlayType('audio/mp4; codecs="mp4a.40.5"')){this.mediaPlayers.addPlayer(aacNativePlayer);}if(dummyvid.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')){this.mediaPlayers.addPlayer(h264NativePlayer);if(mw.isIOS()||dummyvid.canPlayType('application/vnd.apple.mpegurl; codecs="avc1.42E01E"')){if(navigator.
userAgent.indexOf('Android 3.')===-1){this.mediaPlayers.addPlayer(appleVdnPlayer);}}}if(dummyvid.canPlayType('video/ogg; codecs="theora, vorbis"')||dummyvid.canPlayType('audio/ogg; codecs="vorbis"')){this.mediaPlayers.addPlayer(oggNativePlayer);}if(dummyvid.canPlayType('audio/ogg; codecs="opus"').replace(/maybe/,'')){this.mediaPlayers.addPlayer(opusNativePlayer);}}}catch(e){mw.log('could not run canPlayType '+e);}}if(navigator.mimeTypes&&navigator.mimeTypes.length>0){for(i=0;i<navigator.mimeTypes.length;i++){type=navigator.mimeTypes[i].type;semicolonPos=type.indexOf(';');if(semicolonPos>-1){type=type.substr(0,semicolonPos);}pluginName=navigator.mimeTypes[i].enabledPlugin?navigator.mimeTypes[i].enabledPlugin.name:'';if(!pluginName){pluginName='';}if((type==='video/mpeg'||type==='video/x-msvideo')){}if(type==='application/ogg'){continue;}else if(uniqueMimesOnly){if(type==='application/x-vlc-player'){continue;}else if(type==='video/quicktime'){continue;}}}}if(mw.isIOS()){this.mediaPlayers
.addPlayer(vlcAppPlayer);}if(navigator.userAgent.indexOf('Trident')!==-1){if(this.mediaPlayers.isSupportedPlayer('webmNative')){}else if(navigator.userAgent.indexOf('ARM')!==-1){}else{this.mediaPlayers.addPlayer(IEWebMPrompt);}}if(OGVCompat.supported('OGVPlayer')){this.mediaPlayers.addPlayer(ogvJsPlayer);}mw.log('EmbedPlayer::trigger:embedPlayerUpdateMediaPlayersEvent');$(mw).trigger('embedPlayerUpdateMediaPlayersEvent',this.mediaPlayers);},testActiveX:function(name){var hasObj=!0;mw.log('EmbedPlayer::detect: test testActiveX: '+name);try{new ActiveXObject(String(name));}catch(e){hasObj=!1;}return hasObj;}};}());});mw.loader.implement("mw.MediaElement@0rhkr8e",function($,jQuery,require,module){(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler');mw.MediaElement=function(element){this.init(element);};mw.MediaElement.prototype={sources:null,addedROEData:!1,selectedSource:null,init:function(videoElement){var self=this;mw.log('EmbedPlayer::mediaElement:init:'+videoElement.id);this.parentEmbedId=videoElement.id;this.sources=[];if(videoElement){if($(videoElement).attr('src')){self.tryAddSource(videoElement);}$(videoElement).find('source,track').each(function(){self.tryAddSource(this);});}},updateSourceTimes:function(startNpt,endNpt){this.sources.forEach(function(mediaSource){mediaSource.updateSrcTime(startNpt,endNpt);});},getTextTracks:function(){var textTracks=[];this.sources.forEach(function(source){if(source.nodeName==='track'||(source.mimeType&&source.mimeType.indexOf('text/')!==-1)){textTracks.push(source);}});return textTracks;},getSources:function(mimeFilter){var i,
sourceSet=[];if(!mimeFilter){return this.sources;}for(i=0;i<this.sources.length;i++){if(this.sources[i].mimeType&&this.sources[i].mimeType.indexOf(mimeFilter)!==-1){sourceSet.push(this.sources[i]);}}return sourceSet;},getSourceById:function(sourceId){var i;for(i=0;i<this.sources.length;i++){if(this.sources[i].id===sourceId){return this.sources[i];}}return null;},setSourceByIndex:function(index){var i,oldSrc=this.selectedSource.getSrc(),playableSources=this.getPlayableSources();mw.log('EmbedPlayer::mediaElement:selectSource: '+index);for(i=0;i<playableSources.length;i++){if(i===index){this.selectedSource=playableSources[i];break;}}if(oldSrc!==this.selectedSource.getSrc()){$('#'+this.parentEmbedId).trigger('SourceChange');}},setSource:function(source){var oldSrc=this.selectedSource.getSrc();this.selectedSource=source;if(oldSrc!==this.selectedSource.getSrc()){$('#'+this.parentEmbedId).trigger('SourceChange');}},autoSelectSource:function(){var vndSources,desktopVdn,mobileVdn,bandwidthDelta
,bandwidthTarget,player,namedSourceSet,useBogoSlow,codecPref,i,codec,minSizeDelta,isBogoSlow,displayWidth,sizeDelta,nativePlayableSources,self=this,playableSources=this.getPlayableSources();mw.log('EmbedPlayer::mediaElement::autoSelectSource');if(playableSources.length===0){return false;}function setSelectedSource(source){self.selectedSource=source;return self.selectedSource;}$(this).trigger('onSelectSource',playableSources);if(self.selectedSource){mw.log('MediaElement::autoSelectSource: Set via trigger::'+self.selectedSource.getTitle());return self.selectedSource;}playableSources.forEach(function(source){if(source.markedDefault){mw.log('MediaElement::autoSelectSource: Set via marked default: '+source.markedDefault);setSelectedSource(source);}});vndSources=this.getPlayableSources('application/vnd.apple.mpegurl');if(vndSources.length&&mw.EmbedTypes.getMediaPlayers().getMIMETypePlayers('application/vnd.apple.mpegurl').length){vndSources.forEach(function(source){if(source.getFlavorId()&&
source.getFlavorId().toLowerCase()==='iphonenew'){mobileVdn=source;}else{desktopVdn=source;}});if(mw.isIphone()&&mobileVdn){setSelectedSource(mobileVdn);}else if(desktopVdn){setSelectedSource(desktopVdn);}}if(this.selectedSource){mw.log('MediaElement::autoSelectSource: Set via Adaptive HLS: source flavor id:'+self.selectedSource.getFlavorId()+' src: '+self.selectedSource.getSrc());return this.selectedSource;}if($.cookie('EmbedPlayer.UserBandwidth')){bandwidthDelta=999999999;bandwidthTarget=$.cookie('EmbedPlayer.UserBandwidth');playableSources.forEach(function(source){if(source.bandwidth){player=mw.EmbedTypes.getMediaPlayers().defaultPlayer(source.mimeType);if(!player||player.library!=='Native'){return;}if(Math.abs(source.bandwidth-bandwidthTarget)<bandwidthDelta){bandwidthDelta=Math.abs(source.bandwidth-bandwidthTarget);setSelectedSource(source);}}});}if(this.selectedSource){mw.log('MediaElement::autoSelectSource: Set via bandwidth prefrence: source '+this.selectedSource.bandwidth+
' user: '+$.cookie('EmbedPlayer.UserBandwidth'));return this.selectedSource;}nativePlayableSources=playableSources.filter(function(source){var mimeType=source.mimeType,player=mw.EmbedTypes.getMediaPlayers().defaultPlayer(mimeType);return player&&player.library==='Native';});namedSourceSet={};useBogoSlow=!1;playableSources.forEach(function(source){var shortName,mimeType=source.mimeType,player=mw.EmbedTypes.getMediaPlayers().defaultPlayer(mimeType);if(player&&(player.library==='Native'||player.library==='OgvJs')){switch(player.id){case'mp3Native':shortName='mp3';break;case'aacNative':shortName='aac';break;case'oggNative':shortName='ogg';break;case'ogvJsPlayer':useBogoSlow=!0;shortName='ogvjs';break;case'webmNative':shortName='webm';break;case'vp9Native':shortName='vp9';break;case'h264Native':shortName='h264';break;case'appleVdn':shortName='appleVdn';break;}if(!namedSourceSet[shortName]){namedSourceSet[shortName]=[];}namedSourceSet[shortName].push(source);}});codecPref=config[
'EmbedPlayer.CodecPreference'];if(codecPref){for(i=0;i<codecPref.length;i++){codec=codecPref[i];if(!namedSourceSet[codec]){continue;}minSizeDelta=null;isBogoSlow=useBogoSlow&&OGVCompat.isSlow();if(this.parentEmbedId){displayWidth=$('#'+this.parentEmbedId).width();namedSourceSet[codec].forEach(function(source){if((isBogoSlow&&source.height>240)||(useBogoSlow&&source.height>360)){return;}if(source.width&&displayWidth){if(source.width>displayWidth){return;}sizeDelta=Math.abs(source.width-displayWidth);mw.log('MediaElement::autoSelectSource: size delta : '+sizeDelta+' for s:'+source.width);if(minSizeDelta===null||sizeDelta<minSizeDelta){minSizeDelta=sizeDelta;setSelectedSource(source);}}});}if(this.selectedSource){mw.log('MediaElement::autoSelectSource: from  '+this.selectedSource.mimeType+' because of resolution:'+this.selectedSource.width+' close to: '+displayWidth);return this.selectedSource;}}}playableSources.forEach(function(source){var mimeType=source.mimeType,player=mw.EmbedTypes.
getMediaPlayers().defaultPlayer(mimeType);if(mimeType==='video/h264'&&player&&(player.library==='Native'||player.library==='Kplayer')){if(source){mw.log('MediaElement::autoSelectSource: Set h264 via native or flash fallback:'+source.getTitle());setSelectedSource(source);}}});if(!this.selectedSource&&playableSources[0]){mw.log('MediaElement::autoSelectSource: Set via first source: '+playableSources[0].getTitle()+' mime: '+playableSources[0].getMIMEType());return setSelectedSource(playableSources[0]);}return false;},isOgg:function(mimeType){return mimeType==='video/ogg'||mimeType==='ogg/video'||mimeType==='video/annodex'||mimeType==='application/ogg';},getPosterSrc:function(){return this.poster;},hasStreamOfMIMEType:function(mimeType){var i;for(i=0;i<this.sources.length;i++){if(this.sources[i].getMIMEType()===mimeType){return true;}}return false;},isPlayableType:function(mimeType){if(mw.EmbedTypes.getMediaPlayers().defaultPlayer(mimeType)){mw.log('isPlayableType:: '+mimeType);return true
;}else{return false;}},tryAddSource:function(element){var i,source,newSrc=$(element).attr('src');if(newSrc){for(i=0;i<this.sources.length;i++){if(this.sources[i].src===newSrc){this.sources[i].updateSource(element);return this.sources[i];}}}source=new mw.MediaSource(element);this.sources.push(source);return source;},getPlayableSources:function(mimeFilter){var i,playableSources=[];for(i=0;i<this.sources.length;i++){if(this.isPlayableType(this.sources[i].mimeType)&&(!mimeFilter||this.sources[i].mimeType.indexOf(mimeFilter)!==-1)){playableSources.push(this.sources[i]);}}mw.log('MediaElement::GetPlayableSources mimeFilter:'+mimeFilter+' '+playableSources.length+' sources playable out of '+this.sources.length);return playableSources;}};}());});mw.loader.implement("mw.MediaPlayer@06ijj0p",function($,jQuery,require,module){(function(){'use strict';mw.MediaPlayer=function(id,supportedTypes,library){this.id=id;this.supportedTypes=supportedTypes;this.library=library;this.loaded=!1;return this;};mw.MediaPlayer.prototype={id:null,supportedTypes:null,library:null,loaded:!1,supportsMIMEType:function(type){return this.supportedTypes.indexOf(type)!==-1;},getName:function(){return mw.msg('mwe-embedplayer-ogg-player-'+this.id);},load:function(callback){mw.loader.using(['mw.EmbedPlayer'+this.library.substr(0,1).toUpperCase()+this.library.substr(1)],function(){if(callback){callback();}});}};}());});mw.loader.implement("mw.MediaPlayers@1ooz39i",function($,jQuery,require,module){(function(){'use strict';mw.MediaPlayers=function(){this.init();};mw.MediaPlayers.prototype={players:null,preference:{},defaultPlayers:{},init:function(){this.players=[];this.loadPreferences();this.defaultPlayers['video/x-flv']=['Kplayer','Vlc'];this.defaultPlayers['video/h264']=['Native','Kplayer','Vlc'];this.defaultPlayers['application/vnd.apple.mpegurl']=['Native'];this.defaultPlayers['video/ogg']=['Native','Vlc','OgvJs','Generic','VLCApp'];this.defaultPlayers['audio/webm']=['Native','Vlc','OgvJs','VLCApp','IEWebMPrompt'];this.defaultPlayers['video/webm']=['Native','Vlc','OgvJs','VLCApp','IEWebMPrompt'];this.defaultPlayers['application/ogg']=['Native','Vlc','OgvJs','Generic','VLCApp'];this.defaultPlayers['audio/ogg']=['Native','Vlc','OgvJs','VLCApp'];this.defaultPlayers['audio/mpeg']=['Native','Kplayer'];this.defaultPlayers['audio/mp3']=['Native','Kplayer'];this.defaultPlayers['audio/mp4']=['Native'];
this.defaultPlayers['video/mp4']=['Native','Vlc'];this.defaultPlayers['video/mpeg']=['Vlc'];this.defaultPlayers['video/x-msvideo']=['Vlc'];this.defaultPlayers['image/jpeg']=['ImageOverlay'];this.defaultPlayers['image/png']=['ImageOverlay'];},addPlayer:function(player){var i;for(i=0;i<this.players.length;i++){if(this.players[i].id===player.id){return;}}this.players.push(player);},isSupportedPlayer:function(playerId){var i;for(i=0;i<this.players.length;i++){if(this.players[i].id===playerId){return true;}}return false;},getMIMETypePlayers:function(mimeType){var i,mimePlayers=[],self=this,baseMimeType=mimeType.split(';')[0];if(this.defaultPlayers[baseMimeType]){this.defaultPlayers[baseMimeType].forEach(function(library){for(i=0;i<self.players.length;i++){if(self.players[i].library===library&&self.players[i].supportsMIMEType(mimeType)){mimePlayers.push(self.players[i]);}}});}return mimePlayers;},defaultPlayer:function(mimeType){var i,mimePlayers=this.getMIMETypePlayers(mimeType);if(
mimePlayers.length>0){for(i=0;i<mimePlayers.length;i++){if(mimePlayers[i].librayr==='Native'){return mimePlayers[i];}if(mimePlayers[i].id===this.preference[mimeType]){return mimePlayers[i];}}return mimePlayers[0];}return null;},setFormatPreference:function(mimeFormat){this.preference.formatPreference=mimeFormat;$.cookie('EmbedPlayer.Preference',JSON.stringify(this.preference));},loadPreferences:function(){this.preference={};if($.cookie('EmbedPlayer.Preference')){this.preference=JSON.parse($.cookie('EmbedPlayer.Preference'));}},setPlayerPreference:function(playerId,mimeType){var i,selectedPlayer=null;for(i=0;i<this.players.length;i++){if(this.players[i].id===playerId){selectedPlayer=this.players[i];mw.log('EmbedPlayer::setPlayerPreference: choosing '+playerId+' for '+mimeType);this.preference[mimeType]=playerId;$.cookie('EmbedPlayer.Preference',JSON.stringify(this.preference));break;}}if(selectedPlayer){$('.mwEmbedPlayer').each(function(inx,playerTarget){var embedPlayer=$(playerTarget).
get(0);if(embedPlayer.mediaElement.selectedSource&&(embedPlayer.mediaElement.selectedSource.mimeType===mimeType)){embedPlayer.selectPlayer(selectedPlayer);}});}}};}());});mw.loader.implement("mw.MediaSource@1xz1rfp",function($,jQuery,require,module){(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler');mw.mergeTMHConfig('EmbedPlayer.SourceAttributes',['id','src','title','URLTimeEncoding','nodeName','data-startoffset','data-durationhint','data-shorttitle','data-width','data-height','data-bandwidth','data-sizebytes','data-framerate','data-flavorid','data-aspect','data-title','data-mwtitle','data-mwprovider','data-disablecontrols','data-dir','start','end','default']);mw.MediaSource=function(element){this.init(element);};mw.MediaSource.prototype={mimeType:null,uri:null,title:null,markedDefault:!1,URLTimeEncoding:!1,startOffset:0,duration:0,id:null,startNpt:null,endNpt:null,srclang:null,init:function(element){var pUrl,sourceAttr,attrName,self=this;this.src=$(element).attr('src');pUrl=new mw.Uri(this.src);if(typeof pUrl.query.t!=='undefined'){this.URLTimeEncoding=!0;}sourceAttr=config['EmbedPlayer.SourceAttributes'];sourceAttr.
forEach(function(attr){if($(element).attr(attr)){attrName=(attr.indexOf('data-')===0)?attr.substr(5):attr;self[attrName]=$(element).attr(attr);}});if(this.label){this.title=this.label;}if($(element).attr('type')){this.mimeType=$(element).attr('type');}else if($(element).attr('content-type')){this.mimeType=$(element).attr('content-type');}else if($(element)[0].tagName.toLowerCase()==='audio'){this.mimeType='audio/ogg';}else{this.mimeType=this.detectType(this.src);}if(this.mimeType==='video/theora'){this.mimeType='video/ogg';}if(this.mimeType==='audio/vorbis'){this.mimeType='audio/ogg';}if($(element).parent().attr('category')){this.category=$(element).parent().attr('category');}if($(element).attr('default')){this.markedDefault=!0;}this.getURLDuration();},updateSource:function(element){if($(element).attr('title')){this.title=$(element).attr('title');}},updateSrcTime:function(startNpt,endNpt){if(this.URLTimeEncoding){if(!mw.npt2seconds(startNpt)){startNpt=this.startNpt;}if(!mw.
npt2seconds(endNpt)){endNpt=this.endNpt;}this.src=mw.replaceUrlParams(this.src,{t:startNpt+'/'+endNpt});this.getURLDuration();}},setDuration:function(duration){this.duration=duration;if(!this.endNpt){this.endNpt=mw.seconds2npt(this.startOffset+duration);}},getMIMEType:function(){if(this.mimeType){return this.mimeType;}this.mimeType=this.detectType(this.src);return this.mimeType;},setSrc:function(src){this.src=src;},getSrc:function(serverSeekTime){var endvar='';if(!serverSeekTime||!this.URLTimeEncoding){return this.src;}if(this.endNpt){endvar='/'+this.endNpt;}return mw.replaceUrlParams(this.src,{t:mw.seconds2npt(serverSeekTime)+endvar});},getTitle:function(){var mimeType,fileName;if(this.title){return this.title;}if(this.label){return this.label;}mimeType=this.getMIMEType().split(';')[0];switch(mimeType){case'video/h264':case'video/mp4':return mw.msg('mwe-embedplayer-video-h264');case'video/x-flv':return mw.msg('mwe-embedplayer-video-flv');case'video/webm':return mw.msg(
'mwe-embedplayer-video-webm');case'video/ogg':return mw.msg('mwe-embedplayer-video-ogg');case'audio/ogg':return mw.msg('mwe-embedplayer-video-audio');case'audio/mpeg':return mw.msg('mwe-embedplayer-audio-mpeg');case'video/3gp':return mw.msg('mwe-embedplayer-video-3gp');case'video/mpeg':return mw.msg('mwe-embedplayer-video-mpeg');case'video/x-msvideo':return mw.msg('mwe-embedplayer-video-msvideo');}try{fileName=new mw.Uri(mw.absoluteUrl(this.getSrc())).path.split('/').pop();if(fileName){return fileName;}}catch(e){}return this.mimeType;},getShortTitle:function(){var longTitle;if(this.shorttitle){return this.shorttitle;}longTitle=this.getTitle();if(longTitle.length>20){longTitle=longTitle.substring(0,17)+'...';}return longTitle;},getURLDuration:function(){var annoURL,times;if(this.URLTimeEncoding){annoURL=new mw.Uri(this.src);if(annoURL.query.t){times=annoURL.query.t.split('/');this.startNpt=times[0];this.endNpt=times[1];this.startOffset=mw.npt2seconds(this.startNpt);this.duration=mw.
npt2seconds(this.endNpt)-this.startOffset;}else{if(this.startOffset){this.startNpt=mw.seconds2npt(this.startOffset);}if(this.duration){this.endNpt=mw.seconds2npt(parseInt(this.duration)+parseInt(this.startOffset));}}}},getExt:function(uri){var urlParts=new mw.Uri(uri),ext=(urlParts.file)?/[^.]+$/.exec(urlParts.file):/[^.]+$/.exec(uri);ext=/[^#]*/g.exec(ext.toString());ext=ext||'';return ext.toString().toLowerCase();},getFlavorId:function(){if(this.flavorid){return this.flavorid;}return;},detectType:function(uri){switch(this.getExt(uri)){case'smil':case'sml':return'application/smil';case'm4v':case'mp4':return'video/h264';case'm3u8':return'application/vnd.apple.mpegurl';case'webm':return'video/webm';case'3gp':return'video/3gp';case'srt':return'text/x-srt';case'flv':return'video/x-flv';case'ogg':case'ogv':return'video/ogg';case'oga':return'audio/ogg';case'mp3':return'audio/mpeg';case'm4a':return'audio/mp4';case'anx':return'video/ogg';case'xml':return'text/xml';case'avi':return'video/x-msvideo'
;case'mpg':return'video/mpeg';case'mpeg':return'video/mpeg';}mw.log('Error: could not detect type of media src: '+uri);},getBitrate:function(){if(this.bandwidth){return this.bandwidth/1024;}return 0;},getSize:function(){if(this.sizebytes){return this.sizebytes;}return 0;}};}());});mw.loader.implement("mw.MediaWikiPlayerSupport@1sx84p7",function($,jQuery,require,module){(function(){var config=mw.config.get('wgTimedMediaHandler');mw.mergeTMHConfig('EmbedPlayer.Attributes',{'data-mwtitle':null,'data-mwprovider':null});$(mw).on('EmbedPlayerNewPlayer',function(event,embedPlayer){mw.addMediaWikiPlayerSupport(embedPlayer);});mw.addMediaWikiPlayerSupport=function(embedPlayer){var apiTitleKey,apiProvider,$creditsCache=!1;if(!embedPlayer['data-mwtitle']){return;}else{apiTitleKey=embedPlayer['data-mwtitle'];embedPlayer.apiTitleKey=apiTitleKey;}apiProvider=embedPlayer['data-mwprovider'];if(!apiProvider){apiProvider=config['EmbedPlayer.ApiProvider'];}function loadPlayerSources(callback){var request={prop:'imageinfo',titles:'File:'+decodeURIComponent(apiTitleKey).replace(/^(File:|Image:)/,''),iiprop:'url|size|dimensions|metadata',iiurlwidth:embedPlayer.getWidth(),redirects:!0};mw.getJSON(mw.getApiProviderURL(apiProvider),request,function(data){var i,page,imageinfo;if(
data.query.pages){for(i in data.query.pages){if(i==='-1'){callback(false);return;}page=data.query.pages[i];}}else{callback(false);return;}if(!page.imageinfo||!page.imageinfo[0]){callback(false);return;}imageinfo=page.imageinfo[0];embedPlayer.poster=imageinfo.thumburl;embedPlayer.mediaElement.tryAddSource($('<source>').attr('src',imageinfo.url).get(0));if(imageinfo.metadata[2].name==='length'){embedPlayer.duration=imageinfo.metadata[2].value;}if(imageinfo.height!==0&&imageinfo.width!==0){embedPlayer.height=Math.floor(embedPlayer.width*(imageinfo.height/imageinfo.width));}$(embedPlayer).css('height',embedPlayer.height);callback();});}function doCreditLine(resourceHTML,articleUrl){var authUrl,$page,$author,$authorText,$links,$date,$authorLink,imgSize={},titleStr=embedPlayer.apiTitleKey.replace(/_/g,' '),$creditLine=$('<div>');$creditLine.append($('<span>').html(mw.message('mwe-embedplayer-credit-title').escaped().replace(/\$1/g,$('<div>').append($('<a/>').attr({href:articleUrl,title:
titleStr}).text(titleStr))[0].innerHTML)));$page=$(resourceHTML);$author=$page.find('#fileinfotpl_aut');if($author.length){$authorText=$author.next();$authorText.find('br').remove();$links=$authorText.find('a');if($links.length){$links.each(function(i,authorLink){$authorLink=$(authorLink);authUrl=$authorLink.attr('href');authUrl=mw.absoluteUrl(authUrl,articleUrl);$authorLink.attr('href',authUrl);});}$creditLine.append($('<br>'),mw.msg('mwe-embedplayer-credit-author',$authorText.html()));}$date=$page.find('#fileinfotpl_date');if($date.length){$date=$date.next();$date.find('br').remove();$creditLine.append($('<br>'),mw.msg('mwe-embedplayer-credit-date',$date.html()));}if(embedPlayer.isAudio()){imgSize.height=imgSize.width=(embedPlayer.controlBuilder.getOverlayWidth()<250)?45:80;}else{imgSize.width=(embedPlayer.controlBuilder.getOverlayWidth()<250)?45:120;imgSize.height=Math.floor(imgSize.width*(embedPlayer.getHeight()/embedPlayer.getWidth()));}return $('<div/>').addClass('creditline').
append($('<a/>').attr({href:articleUrl,title:titleStr}).html($('<img/>').attr({border:0,src:embedPlayer.poster}).css(imgSize))).append($creditLine);}function showCredits($target,callback){var apiUrl,fileTitle,request;if($creditsCache){$target.html($creditsCache);callback(true);return;}apiUrl=mw.getApiProviderURL(apiProvider);fileTitle='File:'+decodeURIComponent(apiTitleKey).replace(/^File:|^Image:/,'');request={action:'parse',page:fileTitle,smaxage:3600,maxage:3600};mw.getJSON(apiUrl,request,function(data){var descUrl=apiUrl.replace('api.php','index.php');descUrl+='?title='+encodeURIComponent(fileTitle);if(data&&data.parse&&data.parse.text&&data.parse.text['*']){$creditsCache=doCreditLine(data.parse.text['*'],descUrl);}else{$creditsCache=doCreditLine(false,descUrl);}$target.html($creditsCache);callback(true);});}$(embedPlayer).bindQueueCallback('showCredits',function($target,callback){if($target.data('playerId')!==embedPlayer.id){return;}showCredits($target,callback);});$(embedPlayer).
on('onEndedDone',function(event,id){var cb;if(embedPlayer.id!==id){return;}if(embedPlayer.isAudio()){embedPlayer.setCurrentTime(0);return;}cb=embedPlayer.controlBuilder;cb.checkMenuOverlay();cb.showMenuOverlay();cb.showMenuItem('credits');});$(embedPlayer).on('showInlineDownloadLink',function(){if(embedPlayer.controlBuilder.checkNativeWarning()){embedPlayer.controlBuilder.addWarningBinding('EmbedPlayer.ShowNativeWarning',mw.msg('mwe-embedplayer-for_best_experience',$('<div>').append($('<a>').attr({href:'https://www.mediawiki.org/wiki/Extension:TimedMediaHandler/Client_download',target:'_new'}))[0].innerHTML),true);}});$(embedPlayer).on('TimedText_BuildCCMenu',function(event,$menu,id){var thisep,pageTitle,addTextPage,$li;if(id!==embedPlayer.id){thisep=$('#'+id)[0].timedText;embedPlayer=thisep.embedPlayer;}if(embedPlayer.apiTitleKey){if($menu.find('.add-timed-text').length){return;}pageTitle='TimedText:'+decodeURIComponent(embedPlayer.apiTitleKey).replace(/^File:|^Image:/,'');addTextPage
=mw.getApiProviderURL(apiProvider).replace('api.php','index.php')+'?title='+encodeURIComponent(pageTitle);$li=$.getLineItem(mw.msg('mwe-timedtext-upload-timed-text'),'script',function(){window.location=addTextPage;});$li.addClass('add-timed-text').find('a').attr({href:addTextPage,target:'_new'});$menu.append($li);}});$(embedPlayer).bindQueueCallback('checkPlayerSourcesEvent',function(callback){if(embedPlayer.mediaElement.sources.length===0){loadPlayerSources(callback);}else{callback();}});$(mw).bindQueueCallback('TimedText_LoadTextSource',function(source,callback){var apiUrl,request;if(!source.mwtitle||!source.mwprovider){callback();return;}apiUrl=mw.getApiProviderURL(source.mwprovider);request={action:'parse',page:source.mwtitle,smaxage:3600,maxage:3600};mw.getJSON(apiUrl,request,function(data){if(data&&data.parse&&data.parse.text&&data.parse.text['*']){source.loaded=!0;source.mimeType='text/mw-srt';source.captions=source.getCaptions(data.parse.text['*']);callback();}else{mw.log(
'Error: MediaWiki api error in getting timed text:',data);callback();}});});$(embedPlayer).on('getShareIframeSrc',function(event,callback,id){var iframeUrl=!1;if(id!==embedPlayer.id){embedPlayer=$('#'+id)[0];}if(embedPlayer['data-mwprovider']==='wikimediacommons'){iframeUrl='//commons.wikimedia.org/wiki/File:'+decodeURIComponent(embedPlayer.apiTitleKey).replace(/^(File:|Image:)/,'');}else{if(mw.config.get('wgServer')&&mw.config.get('wgArticlePath')){iframeUrl=mw.config.get('wgServer')+mw.config.get('wgArticlePath').replace(/\$1/,'File:'+decodeURIComponent(embedPlayer.apiTitleKey).replace(/^(File:|Image:)/,''));}}if(iframeUrl){iframeUrl+='?embedplayer=yes';}callback(iframeUrl);});};}());});mw.loader.implement("mw.TextSource@0ssgljl",function($,jQuery,require,module){(function(){'use strict';mw.TextSource=function(source){return this.init(source);};mw.TextSource.prototype={loaded:!1,captions:[],styleCss:{},prevIndex:0,init:function(source,textProvider){var i;for(i in source){this[i]=source[i];}if(!this.kind){this.kind='subtitle';}if(textProvider){this.textProvider=textProvider;}return this;},load:function(callback){var self=this;mw.log('TextSource:: load src '+self.getSrc());if(!callback){callback=function(){return;};}if(this.loaded){return callback();}if(!this.getSrc()){mw.log('Error: TextSource no source url for text track');return callback();}$(mw).triggerQueueCallback('TimedText_LoadTextSource',self,function(){if(self.loaded){callback();}else{new mw.ajaxProxy({url:self.getSrc(),success:function(resultXML){self.captions=self.getCaptions(resultXML);self.loaded=!0;mw.log('mw.TextSource :: loaded from '+self.getSrc()+' Found: '+self.captions.length+' captions');
callback();},error:function(){mw.log('Error: TextSource Error with http response');self.loaded=!0;callback();}});}});},getCaptionForTime:function(time){var i,caption,startIndex,firstCapIndex,prevCaption=this.captions[this.prevIndex],captionSet={};if(prevCaption&&time>=prevCaption.start){startIndex=this.prevIndex;}else{startIndex=0;}firstCapIndex=0;for(i=startIndex;i<this.captions.length;i++){caption=this.captions[i];if(caption.end===0||caption.end===-1){continue;}if(time>=caption.start&&time<=caption.end){if(!firstCapIndex){firstCapIndex=caption.start;}captionSet[i]=caption;}if(caption.start>time){break;}}this.prevIndex=firstCapIndex;return captionSet;},isOverlay:function(){return this.mimeType==='text/xml';},getCaptions:function(data){switch(this.mimeType){case'text/mw-srt':return this.getCaptionsFromMediaWikiSrt(data);case'text/x-srt':return this.getCaptionsFromSrt(data);case'text/xml':return this.getCaptionsFromTMML(data);}return[];},getStyleCssById:function(styleId){if(this.
styleCss[styleId]){return this.styleCss[styleId];}return{};},getCaptionsFromTMML:function(data){var bodyStyleId,self=this,captions=[],xml=($(data).find('tt').length)?data:$.parseXML(data);mw.log('TextSource::getCaptionsFromTMML',data);try{if(!xml||$(xml).find('parsererror').length){mw.log('Error: close caption parse error: '+$(xml).find('parsererror').text());return captions;}}catch(e){mw.log('Error: close caption parse error: '+e.toString());return captions;}bodyStyleId=$(xml).find('body').attr('style');$(xml).find('style').each(function(inx,style){var cssObject={};$(style.attributes).each(function(inx,attr){var cssName,c,attrName=attr.name;if(attrName.substr(0,4)!=='tts:'){return true;}cssName='';for(c=4;c<attrName.length;c++){if(attrName[c].toLowerCase()!==attrName[c]){cssName+='-'+attrName[c].toLowerCase();}else{cssName+=attrName[c];}}cssObject[cssName]=attr.nodeValue;});self.styleCss[$(style).attr('id')]=cssObject;});$(xml).find('p').each(function(inx,p){var end,captionObj,$meta,
content='';Array.prototype.forEach.call(p.childNodes,function(node){content+=self.convertTTML2HTML(node);});end=null;if($(p).attr('end')){end=mw.npt2seconds($(p).attr('end'));}if(!end&&$(p).attr('dur')){end=mw.npt2seconds($(p).attr('begin'))+mw.npt2seconds($(p).attr('dur'));}captionObj={start:mw.npt2seconds($(p).attr('begin')),end:end,content:content};$meta=$(p).find('metadata');if($meta.length){captionObj.css={position:'absolute'};if($meta.attr('cccol')){captionObj.css.left=($meta.attr('cccol')/35)*100+'%';}if($meta.attr('ccrow')){captionObj.css.top=($meta.attr('ccrow')/15)*100+'%';}}if($(p).attr('tts:textAlign')){if(!captionObj.css){captionObj.css={};}captionObj.css['text-align']=$(p).attr('tts:textAlign');if(captionObj.css['text-align']==='right'&&captionObj.css.left){captionObj.css.left=null;}}if($(p).attr('style')){captionObj.styleId=$(p).attr('style');}else{captionObj.styleId=bodyStyleId;}captions.push(captionObj);});return captions;},convertTTML2HTML:function(node){var
ttsStyleMap,nodeString,styleVal,attr,self=this;if(node.nodeType===Node.TEXT_NODE){return node.textContent;}if(node.nodeName==='metadata'){return'';}if(node.nodeName==='br'){return'<br />';}ttsStyleMap={'tts:color':'color','tts:fontWeight':'font-weight','tts:fontStyle':'font-style'};if(node.childNodes.length){nodeString='';styleVal='';for(attr in ttsStyleMap){if(node.getAttribute(attr)){styleVal+=ttsStyleMap[attr]+':'+node.getAttribute(attr)+';';}}nodeString+='<'+node.nodeName+' style="'+styleVal+'" >';Array.prototype.forEach.call(node.childNodes,function(childNode){nodeString+=self.convertTTML2HTML(childNode);});nodeString+='</'+node.nodeName+'>';return nodeString;}},getCaptionsFromSrt:function(data){var xml,srt,captions,caplist,i,captionText,caption,s,m,self=this;mw.log('TextSource::getCaptionsFromSrt');try{xml=$.parseXML(data);if(xml&&$(xml).find('parsererror').length===0){return this.getCaptionsFromTMML(data);}}catch(e){}srt=data.replace(/\r+/g,'');srt=srt.replace(/^\s+|\s+$/g,'');
srt=srt.replace(/<[a-zA-Z/][^>]*>/g,'');captions=[];caplist=srt.split('\n\n');for(i=0;i<caplist.length;i++){caption=!1;captionText=caplist[i];s=captionText.split(/\n/);if(s.length<2){continue;}if(s[0].match(/^\d+$/)&&s[1].match(/\d+:\d+:\d+/)){m=s[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);if(m){caption=self.match2caption(m);}else{continue;}if(caption){caption.content=s.slice(2).join('<br>');}}else{continue;}captions.push(caption);}return captions;},getCaptionsFromMediaWikiSrt:function(data){var self=this,captions=[],currentCap={content:''};mw.log('TimedText::getCaptionsFromMediaWikiSrt:');$('<div>'+data+'</div>').find('p').each(function(){var m,currentPtext=$(this).html();m=currentPtext.replace('--&gt;','-->').match(/\d+\s([\d-]+):([\d-]+):([\d-]+)(?:,([\d-]+))?\s*--?>\s*([\d-]+):([\d-]+):([\d-]+)(?:,([\d-]+))?\n?(.*)/);if(m){captions.push(self.match2caption(m));return true;}if(parseInt(currentPtext)===currentPtext){if(currentCap.content!==''){
captions.push(currentCap);}currentCap={content:''};return true;}m=currentPtext.replace('--&gt;','-->').match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);if(m){currentCap=self.match2caption(m);return true;}if(currentPtext!=='<br>'){currentCap.content+=currentPtext;}});if(currentCap.length!==0){captions.push(currentCap);}mw.log('TimedText::getCaptionsFromMediaWikiSrt found '+captions.length+' captions');return captions;},match2caption:function(m){var caption={},startMs=(m[4])?parseInt(m[4],10):0,endMs=(m[8])?parseInt(m[8],10):0;caption.start=this.timeParts2seconds(m[1],m[2],m[3],startMs);caption.end=this.timeParts2seconds(m[5],m[6],m[7],endMs);if(m[9]){caption.content=m[9].trim();}return caption;},timeParts2seconds:function(hours,min,sec,ms){return mw.measurements2seconds({hours:hours,minutes:min,seconds:sec,milliseconds:ms});}};}());});mw.loader.implement("mw.TimedText@1fibj11",function($,jQuery,require,module){(function(){'use strict';var config=mw.config.get('wgTimedMediaHandler');mw.mergeTMHConfig('EmbedPlayer.SourceAttributes',['srclang','kind','label']);mw.TimedText=function(embedPlayer){return this.init(embedPlayer);};mw.TimedText.prototype={config:{layout:'ontop',userLanguage:mw.config.get('wgUserLanguage')||'en',userKind:'subtitles'},defaultDisplayMode:'ontop',lastLayout:'ontop',bindPostFix:'.timedText',options:{},enabledSources:[],firstLoad:!0,currentLangKey:null,currentLangDir:null,prevText:[],textSources:[],validCategoriesKeys:['CC','SUB','TAD','KTV','TIK','AR','NB','META','TRX','LRC','LIN','CUE'],init:function(embedPlayer){var preferenceConfig,self=this;mw.log('TimedText: init() ');this.embedPlayer=embedPlayer;if(embedPlayer.useNativePlayerControls()){return this;}preferenceConfig=$.cookie('TimedText.Preferences');if(preferenceConfig!=='false'&&preferenceConfig!==null){this.config=JSON.parse(
preferenceConfig);}$(this.embedPlayer).on('onChangeMedia'+this.bindPostFix,function(){self.destroy();});self.destroy();self.addPlayerBindings();return this;},destroy:function(){$(this.embedPlayer).off(this.bindPostFix);this.enabledSources=[];this.textSources=[];},addPlayerBindings:function(){var self=this,embedPlayer=this.embedPlayer;self.addInterface();$(embedPlayer).on('timeupdate'+this.bindPostFix,function(event,jEvent,id){self=$('#'+id)[0].timedText;self.monitor();});$(embedPlayer).on('firstPlay'+this.bindPostFix,function(event,id){self=$('#'+id)[0].timedText;self.setupTextSources();$('#textMenuContainer_'+self.embedPlayer.id).hide();});$(embedPlayer).on('onChangeMedia'+this.bindPostFix,function(){self.destroy();self.updateLayout();self.setupTextSources();$('#textMenuContainer_'+embedPlayer.id).hide();});$(embedPlayer).on('onCloseFullScreen'+this.bindPostFix+' onOpenFullScreen'+this.bindPostFix,function(){var textOffset=self.embedPlayer.controlBuilder.inFullScreen?config[
'TimedText.BottomPadding']*2:config['TimedText.BottomPadding'],textCss=self.getInterfaceSizeTextCss({width:embedPlayer.getInterface().width(),height:embedPlayer.getInterface().height()});mw.log('TimedText::set text size for: : '+embedPlayer.getInterface().width()+' = '+textCss['font-size']);if(embedPlayer.controlBuilder.isOverlayControls()&&!embedPlayer.getInterface().find('.control-bar').is(':hidden')){textOffset+=self.embedPlayer.controlBuilder.getHeight();}embedPlayer.getInterface().find('.track').css(textCss).css({bottom:textOffset+'px'});});$(embedPlayer).on('updateLayout'+this.bindPostFix,function(){var textCss=self.getInterfaceSizeTextCss({width:embedPlayer.getPlayerWidth(),height:embedPlayer.getPlayerHeight()});mw.log('TimedText::updateLayout: '+textCss['font-size']);embedPlayer.getInterface().find('.track').css(textCss);});$(embedPlayer).on('onShowControlBar'+this.bindPostFix,function(event,layout,id){var embedPlayer=$('#'+id)[0];if(embedPlayer.controlBuilder.isOverlayControls
()){embedPlayer.getInterface().find('.track').stop().animate(layout,'fast');}});$(embedPlayer).on('onHideControlBar'+this.bindPostFix,function(event,layout,id){var embedPlayer=$('#'+id)[0];if(embedPlayer.controlBuilder.isOverlayControls()){embedPlayer.getInterface().find('.track').stop().animate(layout,'fast');}});$(embedPlayer).on('AdSupport_StartAdPlayback'+this.bindPostFix,function(){var $textButton;if($('#textMenuContainer_'+embedPlayer.id).length){$('#textMenuContainer_'+embedPlayer.id).hide();}$textButton=embedPlayer.getInterface().find('.timed-text');if($textButton.length){$textButton.off('click');}self.lastLayout=self.getLayoutMode();self.setLayoutMode('off');});$(embedPlayer).on('AdSupport_EndAdPlayback'+this.bindPostFix,function(){var $textButton=embedPlayer.getInterface().find('.timed-text');if($textButton.length){self.bindTextButton($textButton);}self.setLayoutMode(self.lastLayout);});},addInterface:function(){var self=this;$(self.embedPlayer).on('addControlBarComponent'+
this.bindPostFix,function(event,controlBar){if(controlBar.supportedComponents.timedText!==false&&self.includeCaptionButton()){controlBar.supportedComponents.timedText=!0;controlBar.components.timedText=self.getTimedTextButton();}});},includeCaptionButton:function(){return config['TimedText.ShowInterface']==='always'||this.embedPlayer.getTextTracks().length;},getCurrentLangKey:function(){return this.currentLangKey;},getCurrentLangDir:function(){if(!this.currentLangDir){this.currentLangDir=this.getSourceByLanguage(this.getCurrentLangKey()).dir;}return this.currentLangDir;},getTimedTextButton:function(){var self=this;return{w:30,position:6.9,o:function(){var $textButton=$('<div>').attr('title',mw.msg('mwe-embedplayer-timed_text')).addClass('ui-state-default ui-corner-all ui-icon_link rButton timed-text').append($('<span>').addClass('ui-icon ui-icon-comment')).buttonHover();self.bindTextButton($textButton);return $textButton;}};},bindTextButton:function($textButton){var self=this;
$textButton.off('click.textMenu').on('click.textMenu',function(){self.showTextMenu();return true;});},getInterfaceSizeTextCss:function(size){return{'font-size':this.getInterfaceSizePercent(size)+'%'};},showTextMenu:function(){var $menuButton,embedPlayer=this.embedPlayer,loc=embedPlayer.getInterface().find('.rButton.timed-text').offset();mw.log('TimedText::showTextMenu:: '+embedPlayer.id+' location: ',loc);$menuButton=this.embedPlayer.getInterface().find('.timed-text');if($menuButton[0].m){$menuButton.embedMenu('show');}else{this.buildMenu(true);}},getTextMenuContainer:function(){var textMenuId='textMenuContainer_'+this.embedPlayer.id;if(!$('#'+textMenuId).length){this.embedPlayer.getInterface().append($('<div>').addClass('ui-widget ui-widget-content ui-corner-all').attr('id',textMenuId).css({position:'absolute',height:'180px',width:'180px','font-size':'12px',display:'none',overflow:'auto'}));}return $('#'+textMenuId);},getInterfaceSizePercent:function(size){var textSize,sizeFactor=4;if
(size.height/size.width<0.7){sizeFactor=6;}textSize=size.width/sizeFactor;if(textSize<95){textSize=95;}if(textSize>150){textSize=150;}return textSize;},setupTextSources:function(callback){var self=this;mw.log('TimedText::setupTextSources');self.loadTextSources(function(){self.autoSelectSource();self.loadEnabledSources();if(callback){callback();}});},buildMenu:function(autoShow){var self=this;self.setupTextSources(function(){var ctrlObj,$menuButton=self.embedPlayer.getInterface().find('.timed-text'),positionOpts={};if(self.embedPlayer.supports.overlays){positionOpts={directionV:'up',offsetY:self.embedPlayer.controlBuilder.getHeight(),directionH:'left',offsetX:-28};}if(!self.embedPlayer.getInterface()){mw.log('TimedText:: interface called before interface ready, just wait for interface');return;}$menuButton=self.embedPlayer.getInterface().find('.timed-text');ctrlObj=self.embedPlayer.controlBuilder;$menuButton.embedMenu({content:self.getMainMenu(),zindex:config[
'EmbedPlayer.FullScreenZIndex']+2,crumbDefaultText:' ',autoShow:autoShow,keepPosition:!0,showSpeed:0,height:100,width:300,targetMenuContainer:self.getTextMenuContainer(),positionOpts:positionOpts,backLinkText:mw.msg('mwe-timedtext-back-btn'),createMenuCallback:function(){var $interface=self.embedPlayer.getInterface(),$textContainer=self.getTextMenuContainer(),textHeight=130,top=$interface.height()-textHeight-ctrlObj.getHeight()-6;if(top<0){top=0;}if(self.embedPlayer.isAudio()){top=self.embedPlayer.controlBuilder.getHeight()+4;}$textContainer.css({top:top,height:textHeight,position:'absolute',left:$menuButton[0].offsetLeft-165,bottom:ctrlObj.getHeight()});ctrlObj.showControlBar(true);},closeMenuCallback:function(){ctrlObj.restoreControlsHover();}});});},monitor:function(){var embedPlayer=this.embedPlayer,currentTime=embedPlayer.currentTime,source=this.enabledSources[0];if(source){this.updateSourceDisplay(source,currentTime);}},loadTextSources:function(callback){var self=this;if(this.
textSources.length){callback(this.textSources);return;}this.textSources=this.embedPlayer.getTextTracks().map(function(textSource){return new mw.TextSource(textSource);});callback(self.textSources);},getLayoutMode:function(){if(this.config.layout==='ontop'&&!this.embedPlayer.supports.overlays){this.config.layout='below';}return this.config.layout;},autoSelectSource:function(){var setDefault,setLocalPref,setEnglish,i,source,setFirst,self=this;if(this.enabledSources.length){return false;}this.enabledSources=[];setDefault=this.textSources.some(function(inx,source){if(source.default){self.enableSource(source);return true;}});if(setDefault){return true;}setLocalPref=this.textSources.some(function(source){if(self.config.userLanguage===source.srclang.toLowerCase()&&self.config.userKind===source.kind){self.enableSource(source);return true;}});if(setLocalPref){return true;}setEnglish=!1;if(this.enabledSources.length===0){for(i=0;i<this.textSources.length;i++){source=this.textSources[i];if(
source.srclang.toLowerCase()==='en'){self.enableSource(source);setEnglish=!0;return false;}}}if(setEnglish){return true;}setFirst=!1;if(this.enabledSources.length===0){for(i=0;i<this.textSources.length;i++){source=this.textSources[i];self.enableSource(source);setFirst=!0;return false;}}if(setFirst){return true;}return false;},enableSource:function(source){var sourceEnabled,self=this;if(!self.enabledSources.length){self.enabledSources.push(source);self.currentLangKey=source.srclang;self.currentLangDir=null;return;}sourceEnabled=this.enabledSources.some(function(enabledSource){return source.id===enabledSource.id;});if(!sourceEnabled){self.enabledSources.push(source);self.currentLangKey=source.srclang;self.currentLangDir=null;}},loadCurrentSubSource:function(callback){var i,source;mw.log('loadCurrentSubSource:: enabled source:'+this.enabledSources.length);for(i=0;i<this.enabledSources.length;i++){source=this.enabledSources[i];if(source.kind==='SUB'){source.load(function(){callback(
source);return;});}}return false;},getSubCaptions:function(langKey,callback){var i,source;for(i=0;i<this.textSources.length;i++){source=this.textSources[i];if(source.srclang.toLowerCase()===langKey){source=this.textSources[i];source.load(function(){callback(source.captions);});}}},loadEnabledSources:function(){var self=this;mw.log('TimedText:: loadEnabledSources '+this.enabledSources.length);this.enabledSources.forEach(function(enabledSource){if(enabledSource.isOverlay()&&self.config.layout==='ontop'){self.setLayoutMode('ontop');}enabledSource.load(function(){$(self.embedPlayer).trigger('loadedTextSource',enabledSource);});});},isSourceEnabled:function(source){if(this.getLayoutMode()==='off'){return false;}return this.enabledSources.some(function(enabledSource){return(source.id&&source.id===enabledSource.id)||(source.src&&source.src===enabledSource.src);});},markActive:function(source){var $captionRows,iconClass,$menu=$('#textMenuContainer_'+this.embedPlayer.id);if($menu.length){
$captionRows=$menu.find('.captionRow');if($captionRows.length){$captionRows.each(function(){$(this).removeClass('ui-icon-bullet ui-icon-radio-on');iconClass=($(this).data('caption-id')===source.id)?'ui-icon-bullet':'ui-icon-radio-on';$(this).addClass(iconClass);});}}},markLayoutActive:function(layoutMode){var $layoutRows,iconClass,$menu=$('#textMenuContainer_'+this.embedPlayer.id);if($menu.length){$layoutRows=$menu.find('.layoutRow');if($layoutRows.length){$layoutRows.each(function(){$(this).removeClass('ui-icon-bullet ui-icon-radio-on');iconClass=($(this).data('layoutMode')===layoutMode)?'ui-icon-bullet':'ui-icon-radio-on';$(this).addClass(iconClass);});}}},getSourceByLanguage:function(langKey){var i,source;for(i=0;i<this.textSources.length;i++){source=this.textSources[i];if(source.srclang===langKey){return source;}}return false;},getMainMenu:function(){var self=this,$menu=self.getLanguageMenu();if(self.textSources.length===0){$menu.append($.getLineItem(mw.msg('mwe-timedtext-no-subs')
,'close'));}else{$menu.append($.getLineItem(mw.msg('mwe-timedtext-layout-off'),(self.getLayoutMode()==='off')?'bullet':'radio-on',function(){self.setLayoutMode('off');},'layoutRow',{layoutMode:'off'}));}$(self.embedPlayer).trigger('TimedText_BuildCCMenu',[$menu,self.embedPlayer.id]);if($menu.children('li').length===1){$menu.find('li > ul > li').detach().appendTo($menu);$menu.find('li').eq(0).remove();}return $menu;},getLiSource:function(source){var langKey,self=this,sourceIcon=(this.isSourceEnabled(source))?'bullet':'radio-on';if(source.title){return $.getLineItem(source.title,sourceIcon,function(){self.selectTextSource(source);},'captionRow',{'caption-id':source.id});}if(source.srclang){langKey=source.srclang.toLowerCase();return $.getLineItem(mw.msg('mwe-timedtext-key-language',langKey,self.getLanguageName(langKey)),sourceIcon,function(){self.selectTextSource(source);},'captionRow',{'caption-id':source.id});}},getLanguageName:function(langKey){return mw.language.getData(mw.config.get
('wgUserLanguage'),'languageData')[langKey]||!1;},setLayoutMode:function(layoutMode){var self=this;mw.log('TimedText:: setLayoutMode: '+layoutMode+' ( old mode: '+self.config.layout+' )');if((layoutMode!==self.config.layout)||self.firstLoad){self.config.layout=layoutMode;self.updateLayout();self.firstLoad=!1;}self.markLayoutActive(layoutMode);},toggleCaptions:function(){mw.log('TimedText:: toggleCaptions was:'+this.config.layout);if(this.config.layout==='off'){this.setLayoutMode(this.defaultDisplayMode);}else{this.setLayoutMode('off');}},updateLayout:function(){var $playerTarget=this.embedPlayer.getInterface();mw.log('TimedText:: updateLayout ');if($playerTarget){$playerTarget.find('.captionContainer,.captionsOverlay').remove();}this.refreshDisplay();},selectTextSource:function(source){var $playerTarget,self=this;mw.log('TimedText:: selectTextSource: select lang: '+source.srclang);self.setLayoutMode(self.lastLayout);this.bindTextButton(this.embedPlayer.getInterface().find(
'timed-text'));this.currentLangKey=source.srclang;this.currentLangDir=null;if(source.srclang){this.config.userLanguage=source.srclang;}if(source.kind){this.config.userKind=source.kind;}this.enabledSources=[];this.enabledSources.push(source);if(!source.loaded){$playerTarget=this.embedPlayer.getInterface();$playerTarget.find('.track').text(mw.msg('mwe-timedtext-loading-text'));source.load(function(){self.refreshDisplay();});}else{self.refreshDisplay();}self.markActive(source);$(this.embedPlayer).trigger('TimedText_ChangeSource');},refreshDisplay:function(){$.cookie('TimedText.Preferences',JSON.stringify(this.config));this.prevText=[];mw.log('TimedText:: bind menu refresh display');this.buildMenu();this.resizeInterface();this.displayTextTarget($('<span>').text(''));this.monitor();},getLanguageMenu:function(){var i,source,categoryKey,$langMenu,$catChildren,self=this,categorySourceList={},sourcesWithCategoryCount=0,sourcesWithoutCategory=[];for(i=0;i<this.textSources.length;i++){source=this
.textSources[i];if(source.kind){categoryKey=source.kind;if(!categorySourceList[categoryKey]){categorySourceList[categoryKey]=[];sourcesWithCategoryCount++;}categorySourceList[categoryKey].push(self.getLiSource(source));}else{sourcesWithoutCategory.push(self.getLiSource(source));}}$langMenu=$('<ul>');if(sourcesWithCategoryCount>1){for(categoryKey in categorySourceList){$catChildren=$('<ul>');for(i=0;i<categorySourceList[categoryKey].length;i++){$catChildren.append(categorySourceList[categoryKey][i]);}$langMenu.append($.getLineItem(mw.msg('mwe-timedtext-textcat-'+categoryKey.toLowerCase())).append($catChildren));}}else{for(categoryKey in categorySourceList){for(i=0;i<categorySourceList[categoryKey].length;i++){$langMenu.append(categorySourceList[categoryKey][i]);}}}for(i=0;i<sourcesWithoutCategory.length;i++){$langMenu.append(sourcesWithoutCategory[i]);}return $langMenu;},updateSourceDisplay:function(source,time){var activeCaptions,addedCaption,self=this;if(this.timeOffset){time=time+
parseInt(this.timeOffset);}activeCaptions=source.getCaptionForTime(time);addedCaption=!1;$.each(activeCaptions,function(capId,caption){var $cap=self.embedPlayer.getInterface().find('.track[data-capId="'+capId+'"]');if(caption.content!==$cap.html()){$cap.remove();self.addCaption(source,capId,caption);addedCaption=!0;}});self.embedPlayer.getInterface().find('.track').each(function(inx,caption){if(!activeCaptions[$(caption).attr('data-capId')]){if(addedCaption){$(caption).remove();}else{$(caption).fadeOut(config['EmbedPlayer.MonitorRate'],function(){$(this).remove();});}}});},addCaption:function(source,capId,caption){var $textTarget;if(this.getLayoutMode()==='off'){return;}$textTarget=$('<div>').addClass('track').attr('data-capId',capId).hide();$textTarget.append($('<span>').addClass('ttmlStyled').css('pointer-events','auto').css(this.getCaptionCss()).append($('<span>').css('position','relative').html(caption.content)));$textTarget.attr('lang',source.srclang.toLowerCase());
$textTarget.find('a').attr('target','_blank');if(this.getLayoutMode()==='ontop'){if(caption.css){$textTarget.css(caption.css);}else{$textTarget.css(this.getDefaultStyle());}}this.displayTextTarget($textTarget);$textTarget.css(this.getInterfaceSizeTextCss({width:this.embedPlayer.getInterface().width(),height:this.embedPlayer.getInterface().height()}));if(caption.styleId){$textTarget.find('span.ttmlStyled').css(source.getStyleCssById(caption.styleId));}$textTarget.fadeIn('fast');},displayTextTarget:function($textTarget){var embedPlayer=this.embedPlayer,$interface=embedPlayer.getInterface(),controlBarHeight=embedPlayer.controlBuilder.getHeight();if(this.getLayoutMode()==='off'){if(embedPlayer.isAudio()){$interface.find('.overlay-win').css('top',controlBarHeight);$interface.css('height',controlBarHeight);}return;}if(this.getLayoutMode()==='ontop'){this.addTextOverlay($textTarget);}else if(this.getLayoutMode()==='below'){this.addTextBelowVideo($textTarget);}else{mw.log(
'Possible Error, layout mode not recognized: '+this.getLayoutMode());}if(embedPlayer.isAudio()&&embedPlayer.getInterface().height()<80){$interface.find('.overlay-win').css('top',80);$interface.css('height',80);$interface.find('.captionsOverlay').css('bottom',embedPlayer.controlBuilder.getHeight());}},getDefaultStyle:function(){var baseCss,defaultBottom=15;if(this.embedPlayer.controlBuilder.isOverlayControls()&&!this.embedPlayer.getInterface().find('.control-bar').is(':hidden')){defaultBottom+=this.embedPlayer.controlBuilder.getHeight();}baseCss={position:'absolute',bottom:defaultBottom,width:'100%',display:'block',opacity:0.8,'text-align':'center'};baseCss=$.extend(baseCss,this.getInterfaceSizeTextCss({width:this.embedPlayer.getInterface().width(),height:this.embedPlayer.getInterface().height()}));return baseCss;},addTextOverlay:function($textTarget){var $captionsOverlayTarget=this.embedPlayer.getInterface().find('.captionsOverlay'),layoutCss={left:0,top:0,bottom:0,right:0,position:
'absolute',direction:this.getCurrentLangDir(),'z-index':config['EmbedPlayer.FullScreenZIndex']};if($captionsOverlayTarget.length===0){$captionsOverlayTarget=$('<div>').addClass('captionsOverlay').css(layoutCss).css('pointer-events','none');this.embedPlayer.getVideoHolder().append($captionsOverlayTarget);}$captionsOverlayTarget.append($textTarget);},addTextBelowVideo:function($textTarget){var $playerTarget=this.embedPlayer.getInterface();this.embedPlayer.controlBuilder.keepControlBarOnScreen=!0;if(!$playerTarget.find('.captionContainer').length||this.embedPlayer.useNativePlayerControls()){this.addBelowVideoCaptionContainer();}$playerTarget.find('.captionContainer').html($textTarget.css({color:'white'}));},addBelowVideoCaptionContainer:function(){var self=this,$playerTarget=this.embedPlayer.getInterface();mw.log('TimedText:: addBelowVideoCaptionContainer');if($playerTarget.find('.captionContainer').length){return;}this.embedPlayer.getVideoHolder().after($('<div>').addClass(
'captionContainer block').css({width:'100%',height:config['TimedText.BelowVideoBlackBoxHeight']+'px','background-color':'#000','text-align':'center','padding-top':'5px'}));self.embedPlayer.triggerHelper('updateLayout');},resizeInterface:function(){var self=this;if(!self.embedPlayer.controlBuilder){return;}if(!self.embedPlayer.controlBuilder.inFullScreen&&self.originalPlayerHeight){self.embedPlayer.triggerHelper('resizeIframeContainer',[{height:self.originalPlayerHeight}]);}else{self.embedPlayer.triggerHelper('updateLayout');}},getCaptionCss:function(){return{};}};}());},{"css":[".ttmlStyled{color:white;letter-spacing:0.04em;text-align:center;padding:0.2em; background-color:#333}.ttmlStyled a{text-decoration:none;color :#BBF}.ttmlStyled a:visited{color :#BBF}"]},{"mwe-timedtext-back-btn":"رجوع","mwe-timedtext-key-language":"$1, $2","mwe-timedtext-language-no-subtitles-for-clip":"لم يتم العثور على ترجمة $1 لمقطع: $2","mwe-timedtext-language-subtitles-for-clip"
:"$1 ترجمات للمقطع: $2","mwe-timedtext-layout-off":"إخفاء الترجمات","mwe-timedtext-loading-text":"جاري تحميل النص...","mwe-timedtext-no-subs":"لا توجد مسارات نصية متاحة","mwe-timedtext-textcat-ar":"المناطق النشطة","mwe-timedtext-textcat-cc":"نصوص توضيحية","mwe-timedtext-textcat-cue":"نقاط تلميح","mwe-timedtext-textcat-ktv":"كاراوكي","mwe-timedtext-textcat-lin":"الترميز اللغوي","mwe-timedtext-textcat-lrc":"الكلمات","mwe-timedtext-textcat-meta":"البيانات الوصفية الموقوتة","mwe-timedtext-textcat-nb":"هامش","mwe-timedtext-textcat-sub":"عناوين فرعية","mwe-timedtext-textcat-tad":"وصف الصوت","mwe-timedtext-textcat-tik":"شريط النص","mwe-timedtext-textcat-trx":"نسخة طبق الأصل","mwe-timedtext-upload-timed-text":"إضافة الترجمات"});mw.loader.implement("mw.ajaxProxy@016ra95",function($,jQuery,require,module){(function(){var config=mw.config.get('wgTimedMediaHandler'),ajaxProxy=function(options){var defaults;if(typeof options.success!=='function'){mw.log('mw.ajaxProxy :: Error: missing success callback.');return;}if(!options.url){mw.log('mw.ajaxProxy :: Error: missing url to proxy.');}defaults={error:function(){},proxyUrl:config['Mw.XmlProxyUrl'],proxyType:'jsonp',startWithProxy:!1};this.options=$.extend({},defaults,options);this.ajax();};ajaxProxy.prototype={ajax:function(useProxy){var ajaxOptions,self=this;if(self.options.startWithProxy){self.proxy();return;}ajaxOptions={success:function(result){self.handleResult(result);}};if(useProxy){ajaxOptions.url=self.options.proxyUrl+encodeURIComponent(self.options.url);ajaxOptions.error=function(){mw.log('mw.ajaxProxy :: Error: request failed with proxy.');self.options.error();};}else{ajaxOptions.url=self.options.url;ajaxOptions.error=function(){mw.log(
'mw.ajaxProxy :: Error: cross domain request failed, trying with proxy');self.proxy();};}try{$.ajax(ajaxOptions);}catch(e){}},proxy:function(){var self=this;if(self.options.proxyUrl){if(self.options.proxyType==='jsonp'){$.ajax({url:self.options.proxyUrl+'?url='+encodeURIComponent(self.options.url)+'&callback=?',dataType:'json',success:function(result){self.handleResult(result,true);},error:function(error){mw.log('mw.ajaxProxy :: Error: could not load:',error);self.options.error();}});}else{self.ajax(true);}}else{mw.log('mw.ajaxProxy :: Error: please setup proxy configuration');this.options.error();}},handleResult:function(result,isJsonP){var resultXML,self=this;if(isJsonP){if(result.http_code==='ERROR'||result.http_code===0){mw.log('mw.ajaxProxy :: Error: load error with http response');self.options.error();return;}try{resultXML=$.parseXML(result.contents);}catch(e){mw.log('mw.ajaxProxy :: Error: could not parse:',resultXML);self.options.error();return;}self.options.success(resultXML);
}else{self.options.success(result);}}};mw.ajaxProxy=ajaxProxy;}());});